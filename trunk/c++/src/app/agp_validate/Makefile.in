# $Id$

APP_PROJ = agp_validate agp_renumber

srcdir = @srcdir@
include @builddir@/Makefile.meta

TESTS=bad_test test2 acc_test fa_test obj_len_test order_test overlap_test new_test
.PHONY : noalt test $(TESTS) alt_test

noalt: $(TESTS)
	echo All tests except -alt succeeded.

test: $(TESTS) alt_test
	echo All tests succeeded.

bad_test : agp_validate
	sh -c "./agp_validate $(srcdir)/test/bad_test.agp >bad_test.out 2>&1"
	diff ${DOPT} -u $(srcdir)/test/bad_test.out bad_test.out

alt_test : agp_validate
	sh -c "./agp_validate -alt $(srcdir)/test/alt_bad_test.agp >alt_bad_test.out 2>&1"
	diff ${DOPT} -I 'CId2ReaderBase: bad reply serial number' -u $(srcdir)/test/alt_bad_test.out alt_bad_test.out

test2 : agp_validate
	sh -c 'curdir=`pwd` && cd $(srcdir) && $$curdir/agp_validate test/bad_test.agp test/alt_bad_test.agp >$$curdir/test2.out 2>&1'
	diff ${DOPT} -u $(srcdir)/test/test2.out test2.out

acc_test : agp_validate
	sh -c "./agp_validate $(srcdir)/test/bad_accessions.agp >bad_accessions.out 2>&1"
	diff ${DOPT} -u $(srcdir)/test/bad_accessions.out bad_accessions.out

fa_test : agp_validate
	sh -c "./agp_validate $(srcdir)/test/fa_test.fa $(srcdir)/test/fa_test.agp >fa_test.out 2>&1"
	diff ${DOPT} -u $(srcdir)/test/fa_test.out fa_test.out

obj_len_test : agp_validate
	sh -c "./agp_validate -obj $(srcdir)/test/obj_len_test.fa $(srcdir)/test/obj_len_test.agp >obj_len_test.out 2>&1"
	diff ${DOPT} -u $(srcdir)/test/obj_len_test.out obj_len_test.out

order_test: agp_validate
	sh -c "./agp_validate $(srcdir)/test/obj_id_OrderNotNumerical.agp >obj_id_OrderNotNumerical.out 2>&1"
	diff ${DOPT} -u $(srcdir)/test/obj_id_OrderNotNumerical.out obj_id_OrderNotNumerical.out

overlap_test: agp_validate
	sh -c "./agp_validate $(srcdir)/test/overlap_test.agp >overlap_test.out 2>&1"
	diff ${DOPT} -u $(srcdir)/test/overlap_test.out overlap_test.out

new_test: agp_validate
	sh -c "./agp_validate $(srcdir)/test/new_test.agp >new_test.out 2>&1"
	diff ${DOPT} -u $(srcdir)/test/new_test.out new_test.out

