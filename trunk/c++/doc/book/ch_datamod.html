<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Biological Sequence Data Model - The NCBI C++ Toolkit Book [Internet] - NCBI</title><meta name="description" content="A comprehensive manual on the NCBI C++ toolkit, including its design and development framework, a C++ library reference, software examples and demos, FAQs and release notes." /><meta name="robots" content="index,nofollow,noarchive" /><meta name="page_id" content="ch_datamod" /><meta name="page_type" content="chapter" /><meta name="ncbipopper" content="triggerPosition:'bottom left',destPosition:'top left',openEvent:'click',closeEvent:'click'" /><script type="text/javascript" src="js/jig/1.7/js/jig.min.js"></script><script type="text/javascript" src="js/toolkitSymbolSearch.js"></script><link type="text/css" rel="stylesheet" href="css/ptbooks.css" /><link type="text/css" rel="stylesheet" href="css/toolkit.css" /></head><body><div class="grid no_max_width"><div class="col twelve_col nomargin shadow"><div class="content"><div class="col eight_col"><div class="nvgtn"><a href="#__nav_cntnt" class="jig-ncbipopper">Contents â–¾</a><div style="display:none;width:700px;height:500px;overflow:auto;" id="__nav_cntnt"><a class="right" href="toc.html">Table of Contents Page</a><ul class="simple-list"><li class="half_rhythm"><a href="toolkit.fm.html">Book Information</a></li><li class="half_rhythm"><a href="part1.html">Part 1. Overview</a><ul class="simple-list"><li class="half_rhythm"><a href="ch_intro.html">1. Introduction to the C++ Toolkit</a></li><li class="half_rhythm"><a href="ch_start.html">2. Getting Started</a></li></ul></li><li class="half_rhythm"><a href="part2.html">Part 2. Development Framework</a><ul class="simple-list"><li class="half_rhythm"><a href="ch_getcode_svn.html">3. Retrieve the Source Code (FTP and Subversion)</a></li><li class="half_rhythm"><a href="ch_config.html">4. Configure, Build, and Use the Toolkit</a></li><li class="half_rhythm"><a href="ch_build.html">5. Working with Makefiles</a></li><li class="half_rhythm"><a href="ch_proj.html">6. Project Creation and Management</a></li><li class="half_rhythm"><a href="ch_style.html">7. Programming Policies and Guidelines</a></li></ul></li><li class="half_rhythm"><a href="part3.html">Part 3. C++ Toolkit Library Reference</a><ul class="simple-list"><li class="half_rhythm"><a href="ch_core.html">8. Portability, Core Functionality and Application Framework</a></li><li class="half_rhythm"><a href="ch_conn.html">9. Networking and IPC</a></li><li class="half_rhythm"><a href="ch_dbapi.html">10. Database Access - SQL, Berkley DB</a></li><li class="half_rhythm"><a href="ch_cgi.html">11. CGI and Fast-CGI </a></li><li class="half_rhythm"><a href="ch_html.html">12. HTML</a></li><li class="half_rhythm"><a href="ch_ser.html">13. Data Serialization (ASN.1, XML)</a></li><li class="half_rhythm"><a href="ch_datamod.html">14. Biological Sequence Data Model</a></li><li class="half_rhythm"><a href="ch_objmgr.html">15. Biological Object Manager</a></li><li class="half_rhythm"><a href="ch_blast.html">16. BLAST API</a></li><li class="half_rhythm"><a href="ch_dataaccess.html">17. Access to NCBI data</a></li><li class="half_rhythm"><a href="ch_algoalign.html">18. Biological Sequence Alignment</a></li><li class="half_rhythm"><a href="ch_gui.html">19. GUI and Graphics</a></li><li class="half_rhythm"><a href="ch_boost.html">20. Using the Boost Unit Test Framework</a></li></ul></li><li class="half_rhythm"><a href="part4.html">Part 4. Wrappers for 3rd-Party Packages</a><ul class="simple-list"><li class="half_rhythm"><a href="ch_xmlwrapp.html">21. XmlWrapp (XML parsing and handling, XSLT, XPath)</a></li></ul></li><li class="half_rhythm"><a href="part5.html">Part 5. Software</a><ul class="simple-list"><li class="half_rhythm"><a href="ch_debug.html">22. Debugging, Exceptions, and Error Handling</a></li><li class="half_rhythm"><a href="ch_grid.html">23. Distributed Computing</a></li><li class="half_rhythm"><a href="ch_app.html">24. Applications</a></li><li class="half_rhythm"><a href="ch_demo.html">25. Examples and Demos</a></li><li class="half_rhythm"><a href="ch_res.html">26. C Toolkit Resources for C++ Toolkit Users</a></li></ul></li><li class="half_rhythm"><a href="part6.html">Part 6. Help and Support</a><ul class="simple-list"><li class="half_rhythm"><a href="ch_browse.html">27. NCBI C++ Toolkit Source Browser</a></li><li class="half_rhythm"><a href="ch_devtools.html">28. Software Development Tools</a></li><li class="half_rhythm"><a href="ch_xmlauthor.html">29. XML Authoring using Word</a></li><li class="half_rhythm"><a href="ch_faq.html">30. FAQs, Useful Documentation Links, and Mailing Lists</a></li></ul></li><li class="half_rhythm"><a href="part7.html">Part 7. Library and Applications Configuration</a><ul class="simple-list"><li class="half_rhythm"><a href="ch_libconfig.html">31. Library Configuration</a></li></ul></li><li class="half_rhythm"><a href="part8.html">Release Notes</a><ul class="simple-list"><li class="half_rhythm"><a href="release_notes.html">Release Notes (Version 9, May 2012)</a></li><li class="half_rhythm"><a href="release_notes_7-05_2011.html">Release Notes (Version 7, May 2011)</a></li><li class="half_rhythm"><a href="release_notes_06_29_2010.html">Release Notes (June, 2010)</a></li><li class="half_rhythm"><a href="release_notes_05_15_2009.html">Release Notes (May, 2009)</a></li><li class="half_rhythm"><a href="release_notes_12_24_2008.html">Release Notes (December, 2008)</a></li><li class="half_rhythm"><a href="release_notes_12_31_2008.html">Release Notes (March, 2008)</a></li><li class="half_rhythm"><a href="release_notes_08_27_2007.html">Release Notes (August, 2007)</a></li><li class="half_rhythm"><a href="release_notes_03_12_2007.html">Release Notes (March, 2007)</a></li><li class="half_rhythm"><a href="release_notes_08_14_2006.html">Release Notes (August, 2006)</a></li><li class="half_rhythm"><a href="release_notes_04_30_2006.html">Release Notes (April 30, 2006)</a></li><li class="half_rhythm"><a href="release_notes_12_31_2005.html">Release Notes (December 31, 2005)</a></li><li class="half_rhythm"><a href="release_notes_10_03_2005.html">Release Notes (August, 2005)</a></li><li class="half_rhythm"><a href="release_notes_05_05_2005.html">Release Notes (April, 2005)</a></li><li class="half_rhythm"><a href="release_notes_03_09_2005.html">Release Notes (February, 2005)</a></li><li class="half_rhythm"><a href="release_notes_11_22_2004.html">Release Notes (November 22, 2004)</a></li><li class="half_rhythm"><a href="release_notes_10_2_2004.html">Release Notes (October 2, 2004)</a></li><li class="half_rhythm"><a href="release_notes_7_8_2004.html">Release Notes (July 8, 2004)</a></li><li class="half_rhythm"><a href="release_notes_april_16_2004.html">Release Notes (April 16, 2004)</a></li><li class="half_rhythm"><a href="release_notes_12_08_2003.html">Release Notes (December 8, 2003)</a></li><li class="half_rhythm"><a href="release_notes_08_01_2003.html">Release Notes (August 1, 2003)</a></li></ul></li><li class="half_rhythm"><a href="app1.appendix1.html">Appendix - Books and Styles</a></li></ul></div><div class="pagination"><a class="pagelink active prev" title="Previous page" href="ch_ser.html">&lt; Prev</a><a class="pagelink active next" title="Next page" href="ch_objmgr.html">Next &gt;</a></div></div><div class="meta_content"><h1><span class="label">14</span><span class="title">Biological Sequence Data Model</span></h1><p class="small">Last Update: February 15, 2011.</p></div><div class="body_content"><div class="sec"><h2><span class="title">Overview</span></h2><p>The overview for this chapter consists of the following topics:</p><ul><li><p>Introduction</p></li><li><p>Chapter Outline</p></li></ul><div class="sec"><h3><span class="title">Introduction</span></h3><p>This chapter describes the NCBI Biological Sequence Data Model, with emphasis on the ASN.1 files and C++ API. ASN.1 type names and the corresponding C++ class or data member names are used almost interchangeably throughout the chapter. Another good source of information about the NCBI data model is:</p><blockquote id="idp39982544"><p>Bioinformatics<br />A Practical Guide to the Analysis of Genes and Proteins<br />Second Edition (2001)<br />Edited by Andreas D. Baxevanis, B. F. Francis Ouellette<br />ISBN 0-471-38391-0<br /><br />Chapter 2 - The NCBI Data Model</p></blockquote></div><div class="sec"><h3><span class="title">Chapter Outline</span></h3><p>The following is an outline of the topics presented in this chapter:</p><ul><li><p><a href="ch_datamod.html#ch_datamod.datamodel.data_model">Data Model</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.datamodel.general">General Use Objects</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.datamodel.biblio">Bibliographic References</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.datamodel.medline">MEDLINE Data</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._Biological_Sequences_1">Biological Sequences</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.datamodel.seqset">Collections of Sequences</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.datamodel.seqloc">Sequence Locations and Identifiers</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.datamodel.seqfeat">Sequence Features</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._Sequence_Alignments_1">Sequence Alignments</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.datamodel.seqres">Sequence Graphs</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Common_ASN1_Specifications">Common ASN.1 Specifications</a></p></li></ul></div></div><div class="sec" id="ch_datamod.datamodel.data_model"><h2><span class="title">Data Model</span></h2><p>The Data Model section outlines the NCBI model for biotechnology information, which is centered on the concept of a biological sequence as a simple, linear coordinate system.</p><ul><li><p><a href="ch_datamod.html#ch_datamod._Introduction">Introduction</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._Biological_Sequences">Biological Sequences</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Classes_of_Biologica">Classes of Biological Sequences</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Locations_on_Biologi">Locations on Biological Sequences</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Associating_Annotati">Associating Annotations With Locations On Biological Sequences</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Collections_of_Relat">Collections of Related Biological Sequences</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Consequences_of_the_">Consequences of the Data Model</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Programming_Consider">Programming Considerations</a></p></li></ul><div class="sec" id="ch_datamod._Introduction"><h3><span class="title">Introduction</span></h3><p>The NCBI sequence databases and software tools are designed around a particular model of biological sequence data. It is designed to provide a few unifying concepts which cross a wide range of domains, providing a path between the domains. Specialized objects are defined which are appropriate within a domain. In the following sections we will present the unifying ideas, then examine each area of the model in more detail.</p><p>Since we expect that computer technologies will continue to develop at a rapid rate, NCBI has made considerable investment of time and energy to ensure that our data and software tools are not too tightly bound to any particular computer platform or database technology. However, we also wish to embrace the intellectual rigor imposed by describing our data within a formal system and in a machine readable and checkable way. For this reason we have chosen to describe our data in Abstract Syntax Notation 1 (ASN.1; ISO 8824, 8825). Enough explanation will be given here to allow the reader to examine the data definitions. A much fuller description of ASN.1 and the NCBI software tools which use it appears in later chapters.</p><p>The data specification sections are arranged by ASN.1 module with detailed discussions of data objects defined in each and the software functions available to operate on those objects. Each ASN.1 defined object has a matching C++ language class. Each C++ class has at a minimum, functions to: create it, write it to an ASN.1 stream, read it from an ASN.1 stream, and destroy it. Many objects have additional functions. Some of these are described in the section on the module and some with more extensive interfaces are described in additional sections. Each module section begins with a description of the elements, followed by the full ASN.1 definition of the module. The C++ API is referenced with links.</p><p>This section provides an overview of all modules. Selected ASN.1 definitions are inserted into the body of the text as necessary. They are also described in the section on the appropriate module.</p><p>There are two major areas for which data objects have been defined. One is bibliographic data. It is clear that this class of information is central to all scientific fields within and outside of molecular biology so we expect these definitions to be widely useful. We have followed the American National Standard for Bibliographic References (ANSI Z39.29-1977) and consulted with the US Patent Office and professional librarians to ensure complete and accurate representation of citation information. Unlike biological data, this data is relatively well understood, so we hope that the bibliographic specification can be quite complete and stable. Despite its importance, the bibliographic specification will not be discussed further here, since it does not present ideas which may be novel to the reader.</p><p>The other major area of the specification is biological sequence data and its associated information. Here the data model attempts to achieve a number of goals. Biomedical information is a vast interconnected web of data which crosses many domains of discourse with very different ways of viewing the world. Biological science is very much like the parable of the blind men and elephant. To some of the blind men the elephant feels like a column, to some like a snake, to others like a wall. The excitement of modern biological research is that we all agree that, at least at some level, we are all exploring aspects of the same thing. But it is early enough in the development of the science that we cannot agree on what that thing is.</p><p>The power of molecular biology is that DNA and protein sequence data cut across most fields of biology from evolution to development, from enzymology to agriculture, from statistical mechanics to medicine. Sequence data can be viewed as a simple, relatively well defined armature on which data from various disciplines can be hung. By associating diverse data with the sequence, connections can be made between fields of research with no other common ground, and often with little or no idea of what the other field is doing.</p><p>This data model establishes a biological sequence as a simple integer coordinate system with which diverse data can be associated. It is reasonable to hope that such a simple core can be very stable and compatible with a very wide range of data. Additional information closely linked to the coordinate system, such as the sequence of amino acids or bases, or genes on a genetic map are layered onto it. With stable identifiers for specific coordinate systems, a greater diversity of information about the coordinate system can be specifically attached to it in a very flexible yet rigorous way. The essential differences between different biological forms are preserved, yet they can viewed as aspects of the same thing around the core, and thus move us toward our goal of understanding the totality.</p></div><div class="sec" id="ch_datamod._Biological_Sequences"><h3><span class="title">Biological Sequences</span></h3><p>A Bioseq is a single continuous biological sequence. It can be nucleic acid or protein. It can be fully instantiated (i.e. we have data for every residue) or only partially instantiated (e.g. we know a fragment is 10 kilobases long, but we only have sequence data over 1 kilobase). A Bioseq is defined in ASN.1 as follows:</p><pre>Bioseq ::= SEQUENCE {<br />    id SET OF Seq-id ,         -- equivalent identifiers<br />    descr Seq-descr OPTIONAL , -- descriptors<br />    inst Seq-inst ,            -- the sequence data<br />    annot SET OF Seq-annot OPTIONAL }</pre><p>In ASN.1 a named datatype begins with a capital letter (e.g. Bioseq). The symbol "::=" means "is defined as". A primitive type is all capitals (e.g. SEQUENCE). A field within a named datatype begins with a lower case letter (e.g. descr). A structured datatype is bounded by curly brackets ({}). We can now read the definition above: a Bioseq is defined as a SEQUENCE (i.e. a structure where the elements must come in order; the mathematical notion of a sequence, not the biological one). The first element of Bioseq is called "id" and is a SET OF (i.e. an unordered collection of elements of the same type) a named datatype called "Seq-id". Seq-id would have its own definition elsewhere. The second element is called "descr" and is a named type called "Seq-descr", which is optional. In this text, when we wish to refer to the id element of the named type Bioseq, we will use the notation "Bioseq.id".</p><p>A Bioseq has two optional elements, which both have descriptive information about the sequence. Seq-descr is a collection of types of information about the context of the sequence. It may set biological context (e.g. define the organism sequenced), or bibliographic context (e.g. the paper it was published in), among other things. Seq-annot is information that is explicitly tied to locations on the sequence. This could be feature tables, alignments, or graphs, at the present time. A Bioseq can have more than one feature table, perhaps coming from different sources, or a feature table and a graph, etc.</p><p>A Bioseq is only required to have two elements, id and inst. Bioseq.id is a set of one or more identifiers for this Bioseq. An identifier is a key which allows us to retrieve this object from a database or identify it uniquely. It is not a name, which is a human compatible description, but not necessarily a unique identifier. The name "Jane Doe" does not uniquely identify a person in the United States, while the identifier, social security number, does. Each Seq-id is a CHOICE of one of a number of identifier types from different databases, which may have different structures. All Bioseqs <i>must</i> have at least one identifier.</p></div><div class="sec" id="ch_datamod.Classes_of_Biologica"><h3><span class="title">Classes of Biological Sequences</span></h3><p>The other required element of a Bioseq is a Seq-inst. This element instantiates the sequence itself. It represents things like: Is it DNA, RNA, or protein? Is it circular or linear? Is it double-stranded or single-stranded? How long is it?</p><pre>Seq-inst ::= SEQUENCE {            -- the sequence data itself<br />    repr ENUMERATED {              -- representation class<br />        not-set (0) ,              -- empty<br />        virtual (1) ,              -- no seq data<br />        raw (2) ,                  -- continuous sequence<br />        seg (3) ,                  -- segmented sequence<br />        const (4) ,                -- constructed sequence<br />        ref (5) ,                  -- reference to another sequence<br />        consen (6) ,               -- consensus sequence or pattern<br />        map (7) ,                  -- ordered map of any kind<br />        delta (8) ,              -- sequence made by changes (delta) to others<br />        other (255) } ,<br />    mol ENUMERATED {               -- molecule class in living organism<br />        not-set (0) ,              --   &gt; cdna = rna<br />        dna (1) ,<br />        rna (2) ,<br />        aa (3) ,<br />        na (4) ,                   -- just a nucleic acid<br />        other (255) } ,<br />    length INTEGER OPTIONAL ,      -- length of sequence in residues<br />    fuzz Int-fuzz OPTIONAL ,       -- length uncertainty<br />    topology ENUMERATED {          -- topology of molecule<br />        not-set (0) ,<br />        linear (1) ,<br />        circular (2) ,<br />        tandem (3) ,               -- some part of tandem repeat<br />        other (255) } DEFAULT linear ,<br />    strand ENUMERATED {            -- strandedness in living organism<br />        not-set (0) ,<br />        ss (1) ,                   -- single strand<br />        ds (2) ,                   -- double strand<br />        mixed (3) ,<br />        other (255) } OPTIONAL ,   -- default ds for DNA, ss for RNA, pept<br />    seq-data Seq-data OPTIONAL ,   -- the sequence<br />    ext Seq-ext OPTIONAL ,         -- extensions for special types<br />    hist Seq-hist OPTIONAL }       -- sequence history</pre><p>Seq-inst is the parent class of a sequence representation class hierarchy. There are two major branches to the hierarchy. The molecule type branch is indicted by Seq-inst.mol. This could be a nucleic acid, or further sub classified as RNA or DNA. The nucleic acid may be circular, linear, or one repeat of a tandem repeat structure. It can be double, single, or of a mixed strandedness. It could also be a protein, in which case topology and strandedness are not relevant.</p><p>There is also a representation branch, which is independent of the molecule type branch. This class hierarchy involves the particular data structure used to represent the knowledge we have about the molecule, no matter which part of the molecule type branch it may be in. The repr element indicates the type of representation used. The aim of such a set of representation classes is to support the information to express different views of sequence based objects, from chromosomes to restriction fragments, from genetic maps to proteins, within a single overall model. The ability to do this confers profound advantages for software tools, data storage and retrieval, and traversal of related sequence and map data from different scientific domains.</p><p><span><img src="img/ch_datamod_G1.jpg" alt="Image ch_datamod_G1.jpg" /></span></p><p>A <b>virtual</b> representation is used to describe a sequence about which we may know things like it is DNA, it is double stranded, we may even know its length, but we do not have the actual sequence itself yet. Most fields of the Seq-inst are filled in, but Seq-inst.seq-data is empty. An example would be a band on a restriction map.</p><p>A <b>raw</b> representation is used for what we traditionally consider a sequence. We know it is DNA, it is double stranded, we know its length exactly, and we have the sequence data itself. In this case, Seq-inst.seq-data contains the sequence data.</p><p>A <b>segmented</b> representation is very analogous to a virtual representation. We posit that a continuous double stranded DNA sequence of a certain length exists, and pieces of it exist in other Bioseqs, but there is no data in Seq-inst.seq-data. Such a case would be when we have cloned and mapped a DNA fragment containing a large protein coding region, but have only actually sequenced the regions immediately around the exons. The sequence of each exon is an individual raw Bioseq in its own right. The regions between exons are virtual Bioseqs. The segmented Bioseq uses Seq-inst.ext to hold a SEQUENCE OF Seq-loc. That is, the extension is an ordered series of locations on <i>other</i> Bioseqs, in this case the raw and virtual Bioseqs representing the exons and introns. The segmented Bioseq contains data only by reference to other Bioseqs. In order to retrieve the base at the first position in the segmented Bioseq, one would go to the first Seq-loc in the extension, and return the appropriate base from the Bioseq it points to.</p><p>A <b>constructed</b> Bioseq is used to describe an assembly or merge of other Bioseqs. It is analogous to the raw representation. In fact, most raw Bioseqs were actually constructed from an assembly of gel readings. However, the constructed representation class is really meant for tracking higher level merging, such as when an expert in a particular organism or gene region may construct a "typical" sequence from that region by merging available sequence data, often published by different groups, using domain knowledge to resolve discrepancies between reports or to select a typical allele. Seq-inst contains an optional Seq-hist object. Seq-hist contains a field called "assembly" which is a SET OF Seq-align, or sequence alignments. The alignments are used to record the history of how the various component Bioseqs used for the merge are related to the final product. A constructed sequence DOES contain sequence data in Seq-inst.seq-data, unlike a segmented sequence, because the component sequences may overlap, or expert knowledge may have been used to determine the "correct" residue at any position that is not captured in the original components. So Seq-hist.assembly is used to simply record the relationship of the merge to the old Bioseqs, but does NOT describe how to generate it from them.</p><p>A <b>map</b> is akin to a virtual Bioseq. For example, for a genetic map of E.coli, we might posit that the E.coli chromosome is about 5 million base pairs long, DNA, double stranded, circular, but we do not have the sequence data for it. However, we do know the positions of some genes on this putative sequence. In this case, the Seq-inst.ext is a SEQUENCE OF Seq-feat, that is, a feature table. For a genetic map, the feature table contains Gene-ref features. An ordered restriction map would have a feature table containing Rsite-ref features. The feature table is part of Seq-inst because, for a map, it is an essential part of instantiating the map Bioseq, not merely annotation on a known sequence. In a sense, for a map, the annotation IS part of the sequence. As an aside, note that we have given gene positions on the E.coli genetic map in base pairs, while the standard E.coli map is numbered from 0.0 to 100.0 map units. Numbering systems can be applied to a Bioseq as a descriptor or a feature. For E.coli, we would simply apply the 0.0 - 100.0 floating point numbering system to the map Bioseq. Gene positions can then be shown to the scientists in familiar map units, while the underlying software still treats positions as large integers, just the same as with any other Bioseq.</p><p>Coordinates on ANY class of Bioseq are ALWAYS integer offsets. So the first residue in any Bioseq is at position 0. The last residue of any Bioseq is in position (length - 1).</p><p>The consequence of this design is that one uses EXACTLY the same data object to describe the location of a gene on an unsequenced restriction fragment, a fully sequenced piece of DNA, a partially sequenced piece of DNA, a putative overview of a large genetic region, or a genetic or physical map. Software to display, manipulate, or compare gene locations can work without change on the full range of possible representations. Sequence and physical map data can be easily integrated into a single, dynamically assembled view by creating a segmented sequence which points alternatively to raw or constructed Bioseqs and parts of a map Bioseq. The relationship between a genetic and physical map is simply an alignment between two Bioseqs of representation class map, no different than the alignment between two sequences of class raw generated by a database search program like BLAST or FASTA.</p></div><div class="sec" id="ch_datamod.Locations_on_Biologi"><h3><span class="title">Locations on Biological Sequences</span></h3><p>A Seq-loc is an object which defines a location on a Bioseq. The smooth class hierarchy for Seq-inst makes it possible to use the same Seq-loc to describe an interval on a genetic map as that used to describe an interval on a sequenced molecule.</p><p>Seq-loc is itself a class hierarchy. A valid Seq-loc can be an interval, a point, a whole sequence, a series of intervals, and so on.</p><pre>Seq-loc ::= CHOICE {<br />    null NULL ,           -- not placed<br />    empty Seq-id ,        -- to NULL one Seq-id in a collection<br />    whole Seq-id ,        -- whole sequence<br />    int Seq-interval ,    -- from to<br />    packed-int Packed-seqint ,<br />    pnt Seq-point ,<br />    packed-pnt Packed-seqpnt ,<br />    mix Seq-loc-mix ,<br />    equiv Seq-loc-equiv ,  -- equivalent sets of locations<br />    bond Seq-bond ,<br />    feat Feat-id }         -- indirect, through a Seq-feat</pre><p>Seq-loc.null indicates a region of unknown length for which no data exists. Such a location may be used in a segmented sequence for the region between two sequenced fragments about which nothing, not even length, is known.</p><p>All other Seq-loc types, except Seq-loc.feat, contain a Seq-id. This means they are independent of context. This means that data objects describing information ABOUT Bioseqs can be created and exchanged independently from the Bioseq itself. This encourages the development and exchange of structured knowledge about sequence data from many directions and is an essential goal of the data model.</p></div><div class="sec" id="ch_datamod.Associating_Annotati"><h3><span class="title">Associating Annotations With Locations On Biological Sequences</span></h3><p>Seq-annot, or sequence annotation, is a collection of information ABOUT a sequence, tied to specific regions of Bioseqs through the use of Seq-loc's. A Bioseq can have many Seq-annot's associated with it. This allows knowledge from a variety of sources to be collected in a single place but still be attributed to the original sources. Currently there are three kinds of Seq-annot, feature tables, alignments, and graphs.</p><div class="sec" id="ch_datamod.Feature_Tables"><h4><span class="title">Feature Tables</span></h4><p>A feature table is a collection of Seq-feat, or <a href="ch_datamod.html#ch_datamod.datamodel.seqfeat">sequence features</a>. A Seq-feat is designed to tie a Seq-loc together with a datablock, a block of specific data. Datablocks are defined objects themselves, many of which are objects used in their own right in some other context, such as publications (<a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCPub__Base.html">CPub_Base</a>) or references to organisms (Org-ref) or genes (Gene-ref). Some datablocks, such as coding regions (CdRegion) make sense only in the context of a Seq-loc. However, since by design there is no intention that one datablock need to have anything in common with any other datablock, each can be tailored exactly to do a particular job. If a change or addition is required to one datablock, no others are affected. In those cases where a pre-existing object from another context is used as a datablock, any software that can use that object can now operate on the feature as well. For example, a piece of code to display a publication can operate on a publication from a bibliographic database or one used as a sequence feature with no change.</p><p>Since the Seq-feat data structure itself and the Seq-loc used to attach it to the sequence are common to all features, it is also possible to support a class of operations over all features without regard to the different types of datablocks attached to them. So a function to determine all features in a particular region of a Bioseq need not care what type of features they are.</p><p><span><img src="img/ch_datamod_G2.jpg" alt="Image ch_datamod_G2.jpg" /></span></p><p>A Seq-feat is bipolar in that it contains up to two Seq-loc's. Seq-feat.location indicates the "source" and is the location similar to the single location in common feature table implementations. Seq-feat.product is the "sink". A CdRegion feature would have its Seq-feat.location on the DNA and its Seq-feat.product on the protein sequence produced. Used this way it defines the process of translating a DNA sequence to a protein sequence. This establishes in an explicit way the important relationship between nucleic acid and protein sequence databases.</p><p>The presence of two Seq-loc's also allows a more complete representation of data conflicts or exceptional biological circumstances. If an author presents a DNA sequence and its protein product in a figure in a paper, it is possible to enter the DNA and protein sequences independently, then confirm through the CdRegion feature that the DNA in fact translates to that protein sequence. In an unfortunate number of published papers, the DNA presented does not translate to the protein presented. This may be a signal that the database has made an error of some sort, which can be caught early and corrected. Or the original paper may be in error. In this case, the "conflict" flag can be set in CdRegion, but the protein sequence is not lost, and retroactive work can be done to determine the source of the problem. It may also be the case that a genomic sequence cannot be translated to a protein for a known biological reason, such as RNA editing or suppressor tRNAs. In this case the "exception" flag can be set in Seq-feat to indicate that the data are correct, but will not behave in the expected way.</p></div><div class="sec" id="ch_datamod._Sequence_Alignments"><h4><span class="title">Sequence Alignments</span></h4><p>A sequence alignment is essentially a correlation between Seq-locs, often associated with some score. An alignment is most commonly between two sequences, but it may be among many at once. In an alignment between two raw Bioseqs, a certain amount of optimization can be done in the data structure based on the knowledge that there is a one to one mapping between the residues of the sequences. So instead of recording the start and stop in Bioseq A and the start and stop in Bioseq B, it is enough to record the start in A and the start in B and the length of the aligned region. However if one is aligning a genetic map Bioseq with a physical map Bioseq, then one will wish to allow the aligned regions to distort relative one another to account for the differences from the different mapping techniques. To accommodate this most general case, there is a Seq-align type which is purely correlations between Seq-locs of any type, with no constraint that they cover exactly the same number of residues.</p><p>A Seq-align is considered to be a SEQUENCE OF segments. Each segment is an unbroken interval on a defined Bioseq, or a gap in that Bioseq. For example, let us look at the following three dimensional alignment with 6 segments:</p><pre>    Seq-ids<br />    id=100        AAGGCCTTTTAGAGATGATGATGATGATGA<br />    id=200        AAGGCCTaTTAG.......GATGATGATGA<br />    id=300        ....CCTTTTAGAGATGATGAT....ATGA<br />                  | 1 |   2   |   3  | 4| 5 | 6 |  Segments</pre><p><span><img src="img/ch_datamod_G3.jpg" alt="Image ch_datamod_G3.jpg" /></span></p><p>The example above is a global alignment that is each segment sequentially maps a region of each Bioseq to a region of the others. An alignment can also be of type "diags", which is just a collection of segments with no implication about the logic of joining one segment to the next. This is equivalent to the diagonal lines that are shown on a dot-matrix plot.</p><p>The example above illustrates the most general form of a Seq-align, Std-seg, where each segment is purely a correlated set of Seq-loc. Two other forms of Seq-align allow denser packing of data for when only raw Bioseqs are aligned. These are Dense-seg, for global alignments, and Dense-diag for "diag" collections. The basic underlying model for these denser types is very similar to that shown above, but the data structure itself is somewhat different.</p></div><div class="sec" id="ch_datamod.Sequence_Graph"><h4><span class="title">Sequence Graph</span></h4><p>The third annotation type is a graph on a sequence, Seq-graph. It is basically a Seq-loc, over which to apply the graph, and a series of numbers representing values of the graph along the sequence. A software tool which calculates base composition or hydrophobic tendency might generate a Seq-graph. Additional fields in Seq-graph allow specification of axis labels, setting of ranges covered, compression of the data relative to the sequence, and so on.</p></div></div><div class="sec" id="ch_datamod.Collections_of_Relat"><h3><span class="title">Collections of Related Biological Sequences</span></h3><p>It is often useful, even "natural", to package a group of sequences together. Some examples are a segmented Bioseq and the Bioseqs that make up its parts, a DNA sequence and its translated proteins, the separate chains of a multi-chain molecule, and so on. A Bioseq-set is such a collection of Bioseqs.</p><pre>Bioseq-set ::= SEQUENCE {      -- just a collection<br />    id Object-id OPTIONAL ,<br />    coll Dbtag OPTIONAL ,          -- to identify a collection<br />    level INTEGER OPTIONAL ,       -- nesting level<br />    class ENUMERATED {<br />        not-set (0) ,<br />        nuc-prot (1) ,              -- nuc acid and coded proteins<br />        segset (2) ,                -- segmented sequence + parts<br />        conset (3) ,                -- constructed sequence + parts<br />        parts (4) ,                 -- parts for 2 or 3<br />        gibb (5) ,                  -- geninfo backbone<br />        gi (6) ,                    -- geninfo<br />        genbank (7) ,               -- converted genbank<br />        pir (8) ,                   -- converted pir<br />        pub-set (9) ,               -- all the seqs from a single publication<br />        equiv (10) ,                -- a set of equivalent maps or seqs<br />        swissprot (11) ,            -- converted SWISSPROT<br />        pdb-entry (12) ,            -- a complete PDB entry<br />        mut-set (13) ,              -- set of mutations<br />        pop-set (14) ,              -- population study<br />        phy-set (15) ,              -- phylogenetic study<br />        eco-set (16) ,              -- ecological sample study<br />        gen-prod-set (17) ,         -- genomic products, chrom+mRNA+protein<br />        wgs-set (18) ,              -- whole genome shotgun project<br />        named-annot (19) ,          -- named annotation set<br />        named-annot-prod (20) ,     -- with instantiated mRNA+protein<br />        read-set (21) ,             -- set from a single read<br />        paired-end-reads (22) ,     -- paired sequences within a read-set<br />        other (255) } DEFAULT not-set ,<br />    release VisibleString OPTIONAL ,<br />    date Date OPTIONAL ,<br />    descr Seq-descr OPTIONAL ,<br />    seq-set SEQUENCE OF Seq-entry ,<br />    annot SET OF Seq-annot OPTIONAL }</pre><p>The basic structure of a Bioseq-set is very similar to that of a Bioseq. Instead of Bioseq.id, there is a series of identifier and descriptive fields for the set. A Bioseq-set is only a convenient way of packaging sequences so controlled, stable identifiers are less important for them than they are for Bioseqs. After the first few fields the structure is exactly parallel to a Bioseq.</p><p>There are descriptors which describe aspects of the collection and the Bioseqs within the collection. The general rule for descriptors in a Bioseq-set is that they apply to "all of everything below". That is, a Bioseq-set of human sequences need have only one Org-ref descriptor for "human" at the top level of the set, and it is applied to all Bioseqs within the set.</p><p>Then follows the equivalent of Seq-inst, that is the instantiation of the data. In this case, the data is the chain of contained Bioseqs or Bioseq-sets. A Seq-entry is either a Bioseq or Bioseq-set. Seq-entry's are very often used as arguments to display and analysis functions, since one can move around either a single Bioseq or a collection of related Bioseqs in context just as easily. This also makes a Bioseq-set recursive. That is, it may consist of collections of collections.</p><pre>Seq-entry ::= CHOICE {<br />        seq Bioseq ,<br />        set Bioseq-set }</pre><p>Finally, a Bioseq-set may contain Seq-annot's. Generally one would put the Seq-annot's which apply to more than one Bioseq in the Bioseq-set at this level. Examples would be CdRegion features that point to DNA and protein Bioseqs, or Seq-align which align more than one Bioseq with each other. However, since Seq-annot's always explicitly cite a Seq-id, it does not matter, in terms of meaning, at what level they are put. This is in contrast to descriptors, where context does matter.</p></div><div class="sec" id="ch_datamod.Consequences_of_the_"><h3><span class="title">Consequences of the Data Model</span></h3><p>This data model has profound consequences for building sequence databases and for researchers and software tools interacting with them. Assuming that Seq-ids point to stable coordinate systems, it is easily possible to consider the whole set of data conforming to the model as a distributed, active heterogeneous database. For example, let us suppose that two raw Bioseqs with Seq-ids "A" and "B" are published in the scientific literature and appear in the large public sequence databases. They are both genomic nucleic acid sequences from human, each coding for a single protein.</p><p>One researcher is a specialist in transcription initiation. He finds additional experimental information involving detailed work on initiation for the flanking region of Bioseq "A". He can then submit a feature table with a TxInit feature in it to the database with his summarized data. He need not contact the original author of "A", nor edit the original sequence entry for "A" to do this. The database staff, who are not experts in transcription initiation, need not attempt to annotate every transcription initiation paper in sufficient detail and accuracy to be of interest to a specialist in the area. The researcher submitting the feature need not use any particular software system or computer to participate, he need only submit a ASN.1 message which conforms to the specification for a feature.</p><p>Another researcher is a medical geneticist who is interested in the medical consequences of mutations in the gene on Bioseq "B". This individual can add annotation to "B" which is totally different in content to that added by the transcription specialist (in fact, it is unlikely that either follows the literature read by the other) and submit the data to the database in precisely the same way.</p><p>A third group may be doing bulk sequencing in the region of the human chromosome where "A" and "B" lie. They produce a third sequence, "C", which they discover by sequence similarity and mapping data, overlaps "A" at one end and "B" at the other. This group can submit not just the sequence of "C" but its relationship to "A" and "B" to the database and as part of their publication.</p><p>The database now has the information from five different research groups, experts in different fields, using different computer and software systems, and unaware, in many cases, of each other's work, to unambiguously pull together all this related information into an integrated high level view through the use of the shared data model and the controlled Seq-ids on common cited coordinate systems. This integration across disciplines and generation of high level views of the data is continuously and automatically available to all users and can be updated immediately on the arrival of new data without human intervention or interpretation by the database staff. This moves scientific databases from the role of curators of scientific data to the role of facilitators of discourse among researchers. It makes identification of potentially fruitful connections across disciplines an automatic result of data entry, rather than of painstaking analysis by a central group. It takes advantage of the growing rush of molecular biology data, making its volume and diversity advantages rather than liabilities.</p><p><span><img src="img/ch_datamod_G4.jpg" alt="Image ch_datamod_G4.jpg" /></span></p></div><div class="sec" id="ch_datamod.Programming_Consider"><h3><span class="title">Programming Considerations</span></h3><p>To use the data model classes, add the following to your makefile:</p><pre>LIB = general xser xutil xncbi</pre><p>You will also need to include the relevant header files for the types you are using, and use the proper namespaces, for example:</p><pre>#include &lt;objects/general/Date_std.hpp&gt;<br />USING_SCOPE(ncbi);<br />USING_SCOPE(ncbi::objects);</pre><p>Types (such as Person-id) that contain other types can be constructed by assigning their contained types, beginning with the most nested level. For example, the following constructs a Person-id, which contains a Dbtag, which in turn contains an Object-id:</p><pre>CObject_id obj;<br />obj.SetId(123);<br /><br />CDbtag tag;<br />tag.SetDb("some db");<br />tag.SetTag(obj);<br /><br />CPerson_id person;<br />person.SetDbtag(tag);</pre></div></div><div class="sec" id="ch_datamod.datamodel.general"><h2><span class="title">General Use Objects</span></h2><p>This section describes the data objects defined in <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/general/general.asn">general.asn</a> and their C++ classes and APIs. They are a miscellaneous collection of generally useful types.</p><ul><li><p><a href="ch_datamod.html#ch_datamod.The_Date_Datestd_and">The Date: Date-std and Date</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._Identifying_Things_O">Identifying Things: Object-id</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._Identifying_Things_D_1">Identifying Things: Dbtag</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._Identifying_People_N">Identifying People: Name-std</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._Identifying_People_P_1">Identifying People: Person-id</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Expressing_Uncertain">Expressing Uncertainty with Fuzzy Integers: Int-fuzz</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Creating_Your_Own_Ob">Creating Your Own Objects: User-object and User-field</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_g">ASN.1 Specification: general.asn</a></p></li></ul><div class="sec" id="ch_datamod.The_Date_Datestd_and"><h3><span class="title">The Date: Date-std and Date</span></h3><p>ASN.1 has primitive types for recording dates, but they model a precise timestamp down to the minute, second, or even fraction of a second. For scientific and bibliographic data, it is common that only the date, or even just a portion of the date (e.g. month and year) is available - for example in a publication date. Rather than use artificial zero values for the unneeded fields of the ASN.1 types, we have created a specialized Date type. Date is a CHOICE of a simple, unparsed string or a structured Date-std. The string form is a fall-back for when the input data cannot be parsed into the standard date fields. It should only be used as a last resort to accommodate old data, as it is impossible to compute or index on.</p><p>When possible, the Date-std type should be used. In this case year is an integer (e.g. 1992), month is an integer from 1-12 (where January is 1), and day is an integer from 1-31. A string called "season" can be used, particularly for bibliographic citations (e.g. the "spring" issue). When a range of months is given for an issue (e.g. "JuneJuly") it cannot be represented directly. However, one would like to be able to index on integer months but still not lose the range. This is accomplished by putting 6 in the "month" slot and "July" in the "season" slot. Then the fields can be put back together for display and the issue can still be indexed by month. Year is the only required field in a Date-std.</p><p>The Date type can accommodate both the representation of the CHOICE itself (which kind of Date is this?) and the data for either CHOICE.</p><p>The Date and Date-std types are implemented with the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCDate.html">CDate</a> and <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCDate__std.html">CDate_std</a> classes.</p><p>The <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCDate.html">CDate</a> class should be used to create dates that can't be parsed into standard fields, for example:</p><pre>CDate adate;<br />adate.SetStr("The birth of modern genetics.");</pre><p>The <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCDate__std.html">CDate_std</a> class should be used for parseable dates, i.e. dates with a given year, and optionally a month and day:</p><pre>CDate_std adate;<br />adate.SetYear(2009);<br />adate.SetSeason("almost fall");</pre><p>To include a time in the date:</p><pre>CDate_std adate(CTime(CTime::eCurrent));<br />adate.SetSeason("late summer");</pre></div><div class="sec" id="ch_datamod._Identifying_Things_O"><h3><span class="title">Identifying Things: Object-id</span></h3><p>An Object-id is a simple structure used to identify a data object. It is just a CHOICE of an INTEGER or a VisibleString. It must always be used within some defining context (e.g. see Dbtag below) in order to have some global meaning. It allows flexibility in a host system's preference for identifying things by integers or strings.</p><p>The Object-id type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCObject__id.html">CObject_id</a> class. <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCObject__id.html">CObject_id</a> includes the <span class="nctnt ncbi-func">Match()</span>, <span class="nctnt ncbi-func">Compare()</span>, and <span class="nctnt ncbi-func">operator&lt;()</span> methods for determining whether two Object-id's are identical.</p><p>Types that include choices, such as Object-id, retain the last CHOICE assigned to them. For example, the following results in the Object-id being a string:</p><pre>CObject_id obj;<br />obj.SetId(123);<br />obj.SetStr("some object");</pre></div><div class="sec" id="ch_datamod._Identifying_Things_D_1"><h3><span class="title">Identifying Things: Dbtag</span></h3><p>A Dbtag is an Object-id within the context of a database. The database is just defined by a VisibleString. The strings identifying the database are not centrally controlled, so it is possible that a conflict could occur. If there is a proliferation of Dbtags, then a registry might be considered at NCBI. Dbtags provide a simple, general way for small database providers to supply their own internal identifiers in a way which will, usually, be globally unique as well, yet requires no official sanction. So, for example, identifiers for features on sequences are not widely available at the present time. However, the Eukaryotic Promotor Database (EPD) can be provided as a set of features on sequences. The internal key to each EPD entry can be propagated as the Feature-id by using a Dbtag where "EPD" is the "db" field and an integer is used in the Object-id, which is the same integer identifying the entry in the normal EPD release.</p><p>The Dbtag type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCDbtag.html">CDbtag</a> class.</p></div><div class="sec" id="ch_datamod._Identifying_People_N"><h3><span class="title">Identifying People: Name-std</span></h3><p>A Name-std is a structured type for representing names with readily understood meanings for the fields. The full field is free-form and can include any or all of the other fields. The suffix field can be used for things like "Jr", "Sr", "III", etc. The title field can be used for things like "Dr.", "Sister", etc.</p><p>The Name-std type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCName__std.html">CName_std</a> class.</p></div><div class="sec" id="ch_datamod._Identifying_People_P_1"><h3><span class="title">Identifying People: Person-id</span></h3><p>Person-id provides an extremely flexible way to identify people. There are five CHOICES from very explicit to completely unstructured. When one is building a database, one should select the most structured form possible. However, when one is processing data from other sources, one should pick the most structured form that adequately models the least structured input data expected.</p><p>The first Person-id CHOICE is a Dbtag. It would allow people to be identified by some formal registry. For example, in the USA, it might be possible to identify people by Social Security Number. Theoretically, one could then maintain a link to a person in database, even if they changed their name. Dbtag would allow other registries, such as professional societies, to be used as well. Frankly, this may be wishful thinking and possibly even socially inadvisable, though from a database standpoint, it would be very useful to have some stable identifier for people.</p><p>A Name-std CHOICE is the next most explicit form. It requires a last name and provides other optional name fields. This makes it possible to index by last name and disambiguate using one or more of the other fields (e.g. multiple people with the last name "Jones" might be distinguished by first name). This is the best choice when the data is available and its use should be encouraged by those building new databases wherever reasonable.</p><p>The next three choices contain just a single string. MEDLINE stores names in strings in a structured way (e.g. Jones JM). This means one can usually, but not always, parse out last names and can generally build indexes on the assumption that the last name is first. A consortium name can be used if the entity is a consortium rather than an individual, and finally a pure, unstructured string can be used.</p><p>The pure string form should be the CHOICE of last resort because no assumptions of any kind can be made about the structure of the name. It could be last name first, first name first, comma after last name, periods between initials, etc.</p><p>The Person-id type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCPerson__id.html">CPerson_id</a> class.</p></div><div class="sec" id="ch_datamod.Expressing_Uncertain"><h3><span class="title">Expressing Uncertainty with Fuzzy Integers: Int-fuzz</span></h3><p>Lengths of <a href="ch_datamod.html#ch_datamod._Biological_Sequences_1">Biological Sequences</a> and locations on them are expressed with integers. However, sometimes it is desirable to be able to indicate some uncertainty about that length or location. Unfortunately, most software cannot make good use of such uncertainties, though in most cases this is fine. In order to provide both a simple, single integer view, as well as a more complex fuzzy view when appropriate, we have adopted the following strategy. In the NCBI specifications, all lengths and locations are always given by simple integers. If information about fuzziness is appropriate, then an Int-fuzz is ADDED to the data. In this case, the simple integer can be considered a "best guess" of the length or location. Thus simple software can ignore fuzziness, while it is not lost to more sophisticated uses.</p><p>Fuzziness can take a variety of forms. It can be plus or minus some fixed value. It can be somewhere in a range of values. It can be plus or minus a percentage of the best guess value. It may also be certain boundary conditions (greater than the value, less than the value) or refer to the bond BETWEEN residues of the biological sequence (bond to the right of this residue, bond to the left of that residue).</p><p>The Int-fuzz type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCInt__fuzz.html">CInt_fuzz</a> class.</p></div><div class="sec" id="ch_datamod.Creating_Your_Own_Ob"><h3><span class="title">Creating Your Own Objects: User-object and User-field</span></h3><p>One of the strengths of ASN.1 is that it requires a formal specification of data down to very detailed levels. This enforces clear definitions of data which greatly facilitates exchange of information in useful ways between different databases, software tools, and scientific enterprises. The problem with this approach is that it makes it very difficult for end users to add their own objects to the specification or enhance objects already in the specification. Certainly custom modules can be added to accommodate specific groups needs, but the data from such custom modules cannot be exchanged or passed through tools which adhere only to the common specification.</p><p>We have defined an object called a User-object, which can represent any class of simple, structured, or tabular data in a completely structured way, but which can be defined in any way that meets a user's needs. The User-object itself has a "class" tag which is a string used like the "db" string in Dbtag, to set the context in which this User-object is meaningful. The "class" strings are not centrally controlled, so again it is possible to have a conflict, but unlikely unless activity in this area becomes very great. Within a "class" one can define an object "type" by either a string or an integer. Thus any particular endeavor can define a wide variety of different types for their own use. The combination of "class" and "type" identifies the object to databases and software that may understand and make use this particular User-object's structure and properties. Yet, the generic definition means software that does not understand the purpose or use of any User-object can still parse it, pass it though, or even print it out for a user to peruse.</p><p>The attributes of the User-object are contained in one or more User-fields. Each User-field has a field label, which is either a string or an integer. It may contain any kind of data: strings; real numbers; integers; arrays of anything; or even sub-fields or complete sub-objects. When arrays and repeating fields are supplied, the optional "num" attribute of the User-field is used to tell software how many elements to prepare to receive. Virtually any structured data type from the simplest to the most complex can be built up from these elements.</p><p>The User-object is provided in a number of places in the public ASN.1 specifications to allow users to add their own structured features to Feature-tables or their own custom extensions to existing features. This allows new ideas to be tried out publicly, and allows software tools to be written to accommodate them, without requiring consensus among scientists or constant revisions to specifications. Those new ideas which time and experience indicate have become important concepts in molecular biology can be "graduated" to real ASN.1 specifications in the public scheme. A large body of structured data would presumably already exist in User-objects of this type, and these could all be back fitted into the new specified type, allowing data to "catch up" to the present specification. Those User-objects which do not turn out to be generally useful or important remain as harmless historical artifacts. User-objects could also be used for custom software to attach data only required for use by a particular tool to an existing standard object without harming it for use by standard tools.</p><p>The User-object and User-field types are implemented with the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCUser__object.html">CUser_object</a> and <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCUser__field.html">CUser_field</a> classes.</p></div></div><div class="sec" id="ch_datamod.datamodel.biblio"><h2><span class="title">Bibliographic References</span></h2><p>The Bibliographic References section documents types for storing publications of any sort and collections of publications. The types are defined in <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/biblio/biblio.asn">biblio.asn</a> and <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/pub/pub.asn">pub.asn</a> modules.</p><div class="sec" id="ch_datamod.Content"><h3><span class="title">Content</span></h3><ul><li><p><a href="ch_datamod.html#ch_datamod._Introduction_2">Introduction</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._Citation_Components_">Citation Components: Affiliation</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._Citation_Components__1">Citation Components: Authors</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._Citation_Components__2">Citation Components: Imprint</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._Citation_Components__3">Citation Components: Title</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Citing_an_Article">Citing an Article</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Citing_a_Journal">Citing a Journal</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Citing_a_Book">Citing a Book</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Citing_a_Proceedings">Citing a Proceedings</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Citing_a_Letter__Man">Citing a Letter, Manuscript, or Thesis</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Citing_Directly_Subm">Citing Directly Submitted Data</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Citing_a_Patent">Citing a Patent</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Identifying_a_Patent">Identifying a Patent</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Citing_an_Article_or">Citing an Article or Book which is In Press</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Special_Cases_Unpubl">Special Cases: Unpublished, Unparsed, or Unusual</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Accommodating_Any_Pu">Accommodating Any Publication Type</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Grouping_Different_F">Grouping Different Forms of Citation for a Single Work</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Sets_of_Citations">Sets of Citations</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_b_1">ASN.1 Specification: biblio.asn</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_p_2">ASN.1 Specification: pub.asn</a></p></li></ul><div class="sec" id="ch_datamod._Introduction_2"><h4><span class="title">Introduction</span></h4><p>The published literature is an essential component of any scientific endeavor, not just in molecular biology. The bibliographic component of the specification and the tools which go with it may find wide use then, permitting reuse of software and databases in many contexts. In addition, the fact that bibliographic citations appear in data from many sources, makes this data extremely valuable in linking data items from different databases to each other (i.e. indirectly through a shared literature citation) to build integrated views of complex data. For this reason, it is also important that database builders ensure that their literature component contain sufficient information to permit this mapping. By conforming to the specification below one can be assured that this will be the case.</p><p>Much of the following bibliographic specification was derived from the components recommended in the American National Standard for Bibliographic References (ANSI Z39.29-1977), and in interviews with professional librarians at the National Library of Medicine. The recommendations were then relaxed somewhat (by making certain fields OPTIONAL) to accommodate the less complete citation information available in current biomedical databases. Thus, although a field may be OPTIONAL, a database builder should still attempt to fill it, if it can reasonably be done.</p><p>In this section we also present a specification for the Pub type, publications of any sort and collections of publications. The MEDLINE specification has enough unique components that it is discussed separately in another section.</p></div><div class="sec" id="ch_datamod._Citation_Components_"><h4><span class="title">Citation Components: Affiliation</span></h4><p>Affiliation is effectively the institutional affiliation of an author. Since it has the same fields needed to cite a publisher (of a book) it is reused in that context as well, although in that case it is not precisely an "affiliation". The Affil type is a CHOICE of two forms, a structured form which is preferred, or an unstructured string when that is all that is available.</p><p>The structured form has a number of fields taken from the ANSI guidelines. "affil" is institutional affiliation, such as "Harvard University". "div" is division within institution, such as "Department of Molecular Biology". "sub" is a subdivision of a country - in the United States this would be the state. "street" has been added to the specification (it is not included in ANSI) so that it is possible to produce a valid mailing address.</p><p>The Affil type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCAffil.html">CAffil</a> class.</p></div><div class="sec" id="ch_datamod._Citation_Components__1"><h4><span class="title">Citation Components: Authors</span></h4><p>The Auth-list type represents the list of authors for the citation. It is a SEQUENCE, not a SET, since the order of author names matters. The names can be unstructured strings (the least desirable), semi-structured strings following the MEDLINE rules (e.g. "Jones JM"), or fully structured Author type objects (most desirable). An Affil can be associated with the whole list (typical of a scientific article). A more detailed discussion on the use of different types of names can be found in the "<a href="ch_datamod.html#ch_datamod._Identifying_People_N">Identifying People</a>" section of the "<a href="ch_datamod.html#ch_datamod.datamodel.general">General Use Objects</a>" section.</p><p>If fully structured Authors are used, each Author can have an individual Affil. The Author uses Person-id as defined <a href="ch_datamod.html#ch_datamod._Identifying_People_P_1">above</a>. The structured form also allows specification of the role of individual authors in producing the citation. The primary author(s) does not mean the "first" author, but rather that this author had a role in the original writing or experimental work. A secondary author is a reviewer or editor of the article. It is rare in a scientific work that a secondary author is ever mentioned by name. Authors may play different roles in the work, compiling, editing, and translating. Again, in a scientific work, the authors mentioned did none of these things, but were involved in the actual writing of the paper, although it would not be unusual anymore for one author to be the patent assignee. For scientific work, then, the main advantages of using the Author form are the use of fielded names and of individual Affils. For a book, being able to indicate the editors vs. the authors is useful also.</p><p>The Auth-list type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCAuth__list.html">CAuth_list</a> class and the Author type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCAuthor.html">CAuthor</a> class.</p></div><div class="sec" id="ch_datamod._Citation_Components__2"><h4><span class="title">Citation Components: Imprint</span></h4><p>Imprint provides information about the physical form in which the citation appeared, such as what volume and issue of a journal it was in. For the "date" a structured Date is preferred. While "volume", "issue", and "pages" are commonly integers, there are many cases where they are not pure integers (e.g. pages xvi-xvii or issue 10A). Pages is given as a single string to simplify input from different sources. The convention is first page (hyphen) last page, or just page if it is on a single page. "section" may be relevant to a book or proceedings. "pub" is an Affil used to give the publisher of a book. The Affil.affil field is used to give the name of the publisher. "cprt" is the copyright date for a book. "part-sup" is for part or supplement and is not part of ANSI, but is used by MEDLINE. "language" is for the original language of the publication, which is also used by MEDLINE, but is not part of the ANSI standard. "prepub" is not part of the ANSI standard, but was added by NCBI to accommodate citations for as yet unpublished papers that can accompany data directly submitted by authors to the database.</p><p>The Imprint type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCImprint.html">CImprint</a> class.</p></div><div class="sec" id="ch_datamod._Citation_Components__3"><h4><span class="title">Citation Components: Title</span></h4><p>A published work may have a number of Titles, each playing a particular role in specifying the work. There is the title of a paper, the title of a book it appears in, or the title of the journal, in which case it may come from a controlled list of serials. There may also be an original title and a translated title. For these reasons, Title is a defined entity rather than just a string, to allow the roles to be specified explicitly. Certain types of Title are legal for an Article, but not for a Journal or a Book. Rather than make three overlapping definitions, one for Article Titles, one for Journal Titles, and one for Book Titles, we have made one Title type and just indicated in the comments of the specification whether a particular form of Title is legal for an Article, Journal, or Book. Title is a SET OF because a work may have more than one title (e.g. an original and a translated title, or an ISO journal title abbreviation and an ISSN).</p><p>Title can be of a number of types. "name" is the full title of an article, or the full name of a book or journal. "tsub" is a subordinate title (e.g. "Hemoglobin Binds Oxygen" might be a primary title, while "Heme Groups in Biology: Part II" might be a subordinate title). "trans" is the translated title. So for an English language database like MEDLINE which contains an article originally published in French, the French title is "name" and the English version of it is "trans".</p><p>"jta" is a journal title abbreviation. It is only valid for a journal name, obviously. "jta" does not specify what kind of abbreviation it is, so it is the least useful of the journal designations available and should only be used as a last resort. "iso-jta" is an International Standards Organization (ISO) journal title abbreviation. This is the preferred form. A list of valid iso-jta's is available from NCBI or the National Library of Medicine. "ml-jta" is a MEDLINE journal title abbreviation. MEDLINE pre-dates the ISO effort, so it does not use iso-jta's. "coden" is a six letter code for journals which is used by a number of groups, particularly in Europe. "issn" is a code used by publishers to identify journals. To facilitate the use of controlled vocabularies for journal titles, NCBI maintains a file of mappings between "name", "iso-jta", "ml-jta", "coden", and "issn" where it is possible, and this file is available upon request.</p><p>"abr" is strictly the abbreviated title of a book. "isbn" is similar to "issn" in that it is a publishers abbreviation for a book. "isbn" is very useful, but one must be careful since it is used by publishers to list books, and to a publisher a hard cover book is different from a paperback (they have different "isbn"s) even if they have the same title.</p><p>The Title type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCTitle.html">CTitle</a> class.</p></div><div class="sec" id="ch_datamod.Citing_an_Article"><h4><span class="title">Citing an Article</span></h4><p>An article always occurs within some other published medium. It can be an article in a journal or a chapter or section in a book or proceedings. Thus there are two components to an article citation; a citation for the work it was published in and a citation for the article within that work. Cit-art.title is the Title of the article and Cit-art.authors are the authors of the article. The "from" field is used to indicate the medium the article was published in, and reuses the standard definitions for citing a journal, book, or proceedings.</p><p>The Cit-art type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCCit__art.html">CCit_art</a> class.</p></div><div class="sec" id="ch_datamod.Citing_a_Journal"><h4><span class="title">Citing a Journal</span></h4><p>Cit-jour is used to cite an issue of a journal, not an article within a journal (see Cit-art, above). Cit-jour.title is the title of the journal, and Cit-jour.imp gives the date, volume, issue of the journal. Cit-jour.imp also gives the pages of an article within the issue when used as part of a Cit-art. This is not the purest possible split between article and journal, book, or proceedings, but does have the practical advantage of putting all such physical medium information together in a single common data structure. A controlled list of journal titles is maintained by NCBI, and database builders are encouraged to use this list to facilitate exchange and linking of data between databases.</p><p>The Cit-jour type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCCit__jour.html">CCit_jour</a> class.</p></div><div class="sec" id="ch_datamod.Citing_a_Book"><h4><span class="title">Citing a Book</span></h4><p>Cit-book is used to cite a whole book, not an article within a book (see Cit-art, <a href="ch_datamod.html#ch_datamod.Citing_an_Article">above</a>). Cit-book.title is the title of this particular book. Cit-book.coll is used if the book if part of a collection, or muti-volume set (e.g. "The Complete Works of Charles Darwin"). Cit-book.authors is for the authors or editors of the book itself (not necessarily of any particular chapter). Cit-book.imp contains the publication information about the book. As with a Cit-art, if the Cit-book is being used to cite a chapter in a book, the pages in given in Cit-book.imp.</p><p>The Cit-book type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCCit__book.html">CCit_book</a> class.</p></div><div class="sec" id="ch_datamod.Citing_a_Proceedings"><h4><span class="title">Citing a Proceedings</span></h4><p>A proceedings is a book published as a result or byproduct of a meeting. As such it contains all the same fields as a Cit-book and an additional block of information describing the meeting. These extra fields are the meeting number (as a string to accommodate things like "10A"), the date the meeting occurred, and an OPTIONAL Affil to record the place of the meeting. The name of the organization or meeting is normally the book title. Don't be confused by things like the Proceedings of the National Academy of Sciences, USA, which is really a journal.</p><p>The Cit-proc type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCCit__proc.html">CCit_proc</a> class.</p></div><div class="sec" id="ch_datamod.Citing_a_Letter__Man"><h4><span class="title">Citing a Letter, Manuscript, or Thesis</span></h4><p>A letter, manuscript, or a thesis share most components and so are grouped together under type Cit-let. They all require most of the attributes of a book, and thus Cit-let incorporates the Cit-book structure. Unlike a normal book, they will not have a copyright date. A letter or manuscript will not have a publisher, although a thesis may. In addition, a manuscript may have a manuscript identifier (e.g. "Technical Report X1134").</p><p>The Cit-let type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCCit__let.html">CCit_let</a> class.</p></div><div class="sec" id="ch_datamod.Citing_Directly_Subm"><h4><span class="title">Citing Directly Submitted Data</span></h4><p>The Cit-sub type is used to cite the submission of data directly to a database, independent of any publication(s) which may be associated with the data as well. Authors (of the submission) and Date (in an Imprint) are required. The Affiliation of the Authors should be filled in the Author-list. Optionally one may also record the medium in which the submission was made.</p><p>The Cit-sub type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCCit__sub.html">CCit_sub</a> class.</p></div><div class="sec" id="ch_datamod.Citing_a_Patent"><h4><span class="title">Citing a Patent</span></h4><p>A full patent citation, Cit-pat conveys not only enough information to identify a patent (see below) but to characterize it somewhat as well. A patent has a title and authors, the country in which the patent was issued, a document type and number, and the date the patent was issued. Patents are grouped into classes based on the patent subject, and this may be useful to know. In addition, when a patent is first filed it is issued an application number (different from the document number assigned to the issued patent). For tracking purposes, or issues of precedence, it is also helpful to know the application number and filing date.</p><p>The Cit-pat type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCCit__pat.html">CCit_pat</a> class.</p></div><div class="sec" id="ch_datamod.Identifying_a_Patent"><h4><span class="title">Identifying a Patent</span></h4><p>When citing a patent, it may be sufficient to merely unambiguously identify it, on the assumption that more extensive information will be available from some other source, given the identifier. The Id-pat type contains fields only for the country in which the patent was applied for, or issued in, then a CHOICE of the patent document number (if issued) or the application number (if pending).</p><p>The CId-pat type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCId__pat.html">CId_pat</a> class.</p></div><div class="sec" id="ch_datamod.Citing_an_Article_or"><h4><span class="title">Citing an Article or Book which is In Press</span></h4><p>A number of the fields in Cit-art and Cit-book are OPTIONAL, not only to allow incorporation of older, incomplete databases, but also to allow partial information for works submitted, or in press. One simply fills in as many of the fields in Cit-art or Cit-book as possible. One must also set the "pre-pub" flag in Imprint to the appropriate status. That's it. Once the work is published, the remaining information is filled in and the "pre-pub" flag is removed. NOTE: this does NOT apply to work which is "unpublished" or "personal communication", or even "in preparation" because one knows nothing about where or when (or if) it will ever be published. One must use a Cit-gen for this (below).</p></div><div class="sec" id="ch_datamod.Special_Cases_Unpubl"><h4><span class="title">Special Cases: Unpublished, Unparsed, or Unusual</span></h4><p>A generic citation, Cit-gen, is used to hold anything not fitting into the more usual bibliographic entities described above. Cit-gen.cit is a string which can hold a unparsable citation (if you can parse it into a structured type, you should). Sometimes it is possible to parse some things but not everything. In this case, a number of fields, such as authors, journal, etc., which are similar to those in the structured types, can be populated as much as possible, and the remainder of the unparsed string can go in "cit".</p><p>Less standard citation types, such as a MEDLINE unique identifier, or the serial numbers used in the GenBank flatfile can be accommodated by Cit-gen. An unpublished citation normally has authors and date filled into the structured fields. Often a title is available as well (e.g. for a talk or for a manuscript in preparation). The string "unpublished" can then appear in the "cit" field.</p><p>Software developed to display or print a Cit-gen must be opportunistic about using whatever information is available. Obviously it is not possible to assume that all Cit-gens can be displayed in a uniform manner, but in practice at NCBI we have found they can generally be made fairly regular.</p><p>The Cit-gen type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCCit__gen.html">CCit_gen</a> class.</p></div><div class="sec" id="ch_datamod.Accommodating_Any_Pu"><h4><span class="title">Accommodating Any Publication Type</span></h4><p>The Pub type is designed to accommodate a citation of any kind defined in the bibliographic specification, the MEDLINE specification, and more. It can also accommodate a collection of publications. It is very useful when one wishes to be able to associate a bibliographic reference in a very general way with a software tool or data item, yet still preserve the attributes specific for each class of citation. Pub is widely used for this purpose in the NCBI specifications.</p><p>The Pub type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCPub.html">CPub</a> class.</p></div><div class="sec" id="ch_datamod.Grouping_Different_F"><h4><span class="title">Grouping Different Forms of Citation for a Single Work</span></h4><p>In some cases a database builder may wish to present more than one form of citation for the same bibliographic work. For example, in a sequence entry from the NCBI Backbone database, it is useful to provide the MEDLINE uid (for use as a link by other software tools), the Cit-art (for display to the user), and a Cit-gen containing the internal NCBI Backbone identifier for this publication as the string "pub_id = 188824" (for use in checking the database by in-house staff) for the same article. The Pub-equiv type provides this capability. It is a SET OF Pub. Each element in the SET is an equivalent citation for the same bibliographic work. Software can examine the SET and select the form most appropriate to the job at hand.</p><p>The Pub-equiv type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCPub__equiv.html">CPub_equiv</a> class.</p></div><div class="sec" id="ch_datamod.Sets_of_Citations"><h4><span class="title">Sets of Citations</span></h4><p>One often needs to collect a set of citations together. Unlike the Pub-equiv type, the Pub-set type represents a set of citations for DIFFERENT bibliographic works. It is a CHOICE of types for a mixture of publication classes, or for a collection of the same publication class.</p><p>The Pub-set type is implemented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCPub__set.html">CPub_set</a> class.</p></div></div></div><div class="sec" id="ch_datamod.datamodel.medline"><h2><span class="title">MEDLINE Data</span></h2><p>This section is an introduction to MEDLINE and the structure of a MEDLINE record. It describes types defined in the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/medline/medline.asn">medline.asn</a> module.</p><div class="sec" id="ch_datamod.datamodel.types.medline"><h3><span class="title">Module Types</span></h3><ul><li><p><a href="ch_datamod.html#ch_datamod._Introduction_3">Introduction</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Structure_of_a_MEDLI">Structure of a MEDLINE Entry</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.MeSH_Index_Terms">MeSH Index Terms</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Substance_Records">Substance Records</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Database_Cross_Refer">Database Cross Reference Records</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Funding_Identifiers">Funding Identifiers</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Gene_Symbols">Gene Symbols</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_m_3">ASN.1 Specification: medline.asn</a></p></li></ul><div class="sec" id="ch_datamod._Introduction_3"><h4><span class="title">Introduction</span></h4><p>MEDLINE is the largest and oldest biomedical database in the world. It is built at the National Library of Medicine (NLM), a part of NIH. At this writing it contains over seven million citations from the scientific literature from over 3500 different journals. MEDLINE is a bibliographic database. It contains citation information (e.g. title, authors, journal, etc.). Many entries contain the abstract from the article. All articles are carefully indexed by professionals according to formal guidelines in a variety of ways. All entries can be uniquely identified by an integer key, the MEDLINE unique identifier (MEDLINE uid).</p><p>MEDLINE is a valuable resource in its own right. In addition, the MEDLINE uid can serve as a valuable link between entries in factual databases. When NCBI processes a new molecular biology factual database into the standardized format, we also normalize the bibliographic citations and attempt to map them to MEDLINE. For the biomedical databases we have tried thus far, we have succeeding in mapping most or all of the citations this way. From then on, linkage to other data objects can be made simply and easily through the shared MEDLINE uid. The MEDLINE uid also allows movement from the data item to the world of scientific literature in general and back.</p></div><div class="sec" id="ch_datamod.Structure_of_a_MEDLI"><h4><span class="title">Structure of a MEDLINE Entry</span></h4><p>Each Medline-entry represents a single article from the scientific literature. The MEDLINE uid is an INTEGER which uniquely identifies the entry. If corrections are made to the contents of the entry, the uid is not changed. The MEDLINE uid is the simplest and most reliable way to identify the entry.</p><p>The entry-month (em) is the month and year in which the entry became part of the public view of MEDLINE. It is not the same as the date the article was published. It is mostly useful for tracking what is new since a previous query of MEDLINE.</p><p>The article citation itself is contained in a standard Cit-art, imported from the bibliographic module, so will not be discussed further here. The entry often contains the abstract from the article. The rest of the entry consists of various index terms, which will be discussed below.</p></div><div class="sec" id="ch_datamod.MeSH_Index_Terms"><h4><span class="title">MeSH Index Terms</span></h4><p>Medical Subject Heading (MeSH) terms are a tree of controlled vocabulary maintained by the Library Operations division of NLM. The tree is arranged with parent terms above more specialized terms within the same concept. An entry in MEDLINE is indexed by the most specific MeSH term(s) available. Since the MeSH vocabulary is a tree, one may then query on specific terms directly, or on general terms by including all the child terms in the query as well.</p><p>A MeSH term may be qualified by one or more sub-headings. For example, the MeSH term "insulin" may carry quite a different meaning if qualified by "clinical trials" versus being qualified by "genetics".</p><p>A MeSH term or a sub-heading may be flagged as indicating the "main point" of the article. Again the most specific form is used. If the main point of the article was about insulin and they also discuss genetics, then the insulin MeSH term will be flagged but the genetics sub-heading will not be. However, if the main point of the article was the genetics of insulin, then the sub-heading genetics under the MeSH term insulin will be flagged but the MeSH term itself will not be.</p></div><div class="sec" id="ch_datamod.Substance_Records"><h4><span class="title">Substance Records</span></h4><p>If an article has substantial discussion of recognizable chemical compounds, they are indexed in the substance records. The record may contain only the name of the compound, or it may contain the name and a Chemical Abstracts Service (CAS) registry number or a Enzyme Commission (EC) number as appropriate.</p></div><div class="sec" id="ch_datamod.Database_Cross_Refer"><h4><span class="title">Database Cross Reference Records</span></h4><p>If an article cites an identifier recognized to be from a known list of biomedical databases, the cross reference is given in this field and the key for which database it was from. A typical example would be a GenBank accession number citing in an article.</p></div><div class="sec" id="ch_datamod.Funding_Identifiers"><h4><span class="title">Funding Identifiers</span></h4><p>If an id number from a grant or contract is cited in the article (usually acknowledging support) it will appear in this field.</p></div><div class="sec" id="ch_datamod.Gene_Symbols"><h4><span class="title">Gene Symbols</span></h4><p>As an experiment, Library Operations at the NLM is putting in mnemonic symbols from articles, if they appear by form and usage to be gene symbols. Obviously such symbols vary and are not always properly used, so this field must be approached with caution. Nonetheless it can provide a route to a rich source of potentially relevant citations.</p></div></div></div><div class="sec" id="ch_datamod._Biological_Sequences_1"><h2><span class="title">Biological Sequences</span></h2><p>This section describes types used to represent biological data. These types are defined in the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/seq/seq.asn">seq.asn</a>, <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/seqblock/seqblock.asn">seqblock.asn</a>, and <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/seqcode/seqcode.asn">seqcode.asn</a> modules.</p><div class="sec" id="ch_datamod.datamodel.cpp.seq"><h3><span class="title">C++ Implementation Notes</span></h3><ul><li><p><a href="ch_datamod.html#ch_datamod._Introduction_4">Introduction</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Bioseq_the_Biologica">Bioseq: the Biological Sequence</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._Seqid_Identifying_th">Seq-id: Identifying the Bioseq</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Seqannot_Annotating_">Seq-annot: Annotating the Bioseq</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Seqdescr_Describing_">Seq-descr: Describing the Bioseq and Placing It In Context</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Seqinst_Instantiatin">Seq-inst: Instantiating the Bioseq</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Seqhist_History_of_a">Seq-hist: History of a Seq-inst</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Seqdata_Encoding_the">Seq-data: Encoding the Sequence Data Itself</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Tables_of_Sequence_C">Tables of Sequence Codes</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Mapping_Between_Diff">Mapping Between Different Sequence Alphabets</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Pubdesc_Publication_">Pubdesc: Publication Describing a Bioseq</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Numbering_Applying_a">Numbering: Applying a Numbering System to a Bioseq</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_s_4">ASN.1 Specification: seq.asn</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_s_5">ASN.1 Specification: seqblock.asn</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_s_6">ASN.1 Specification: seqcode.asn</a></p></li></ul><div class="sec" id="ch_datamod._Introduction_4"><h4><span class="title">Introduction</span></h4><p>A biological sequence is a single, continuous molecule of nucleic acid or protein. It can be thought of as a multiple inheritance class hierarchy. One hierarchy is that of the underlying molecule type: DNA, RNA, or protein. The other hierarchy is the way the underlying biological sequence is represented by the data structure. It could be a physical or genetic map, an actual sequence of amino acids or nucleic acids, or some more complicated data structure building a composite view from other entries. An overview of this data model has been presented previously, in the <a href="ch_datamod.html#ch_datamod.datamodel.data_model">Data Model section</a>. The overview will not be repeated here so if you have not read that section, do so now. This section will concern itself with the details of the specification and representation of biological sequence data.</p></div><div class="sec" id="ch_datamod.Bioseq_the_Biologica"><h4><span class="title">Bioseq: the Biological Sequence</span></h4><p>A Bioseq represents a single, continuous molecule of nucleic acid or protein. It can be anything from a band on a gel to a complete chromosome. It can be a genetic or physical map. All Bioseqs have more common properties than differences. All Bioseqs must have at least one identifier, a Seq-id (i.e. Bioseqs must be citable). Seq-ids are discussed in detail in the <a href="ch_datamod.html#ch_datamod.datamodel.seqloc">Sequence Ids and Locations</a> section. All Bioseqs represent an integer coordinate system (even maps). All positions on Bioseqs are given by offsets from the first residue, and thus fall in the range from zero to (length - 1). All Bioseqs may have specific descriptive data elements (descriptors) and/or annotations such as feature tables, alignments, or graphs associated with them.</p><p>The differences in Bioseqs arise primarily from the way they are instantiated (represented). Different data elements are required to represent a map than are required to represent a sequence of residues.</p><p>The C++ class for a Bioseq (<a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCBioseq.html">CBioseq</a>) has a list of Seq-id's, a Seq-descr, and a list of Seq-annot's, mapping quite directly from the ASN.1. However, since a Seq-inst is always required for a Bioseq, those fields have been incorporated into the Bioseq itself. Serialization is handled by <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSerialObject.html">CSerialObject</a> from which <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCBioseq.html">CBioseq</a> derives.</p><p>Related classes, such as <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeqdesc.html">CSeqdesc</a>, provide enumerations for representing types of description, molecule types, and sequence encoding types used in the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCBioseq.html">CBioseq</a> class. Sequence encoding is discussed in more detail below.</p><p>The C++ Toolkit introduced some new methods for Bioseq's:</p><ul><li><p><span class="nctnt ncbi-func">CBioseq(CSeq_loc, string)</span> - constructs a new delta sequence from the Seq-loc. The string argument may be used to specify local Seq-id text for the new Bioseq.</p></li><li><p><span class="nctnt ncbi-func">GetParentEntry</span> - returns Seq-entry containing the Bioseq.</p></li><li><p><span class="nctnt ncbi-func">GetLabel</span> - returns the Bioseq label.</p></li><li><p><span class="nctnt ncbi-func">GetFirstId</span> - returns the first element from the Bioseq's Id list or null.</p></li><li><p><span class="nctnt ncbi-func">IsNa</span> - true if the Bioseq is a nucleotide.</p></li><li><p><span class="nctnt ncbi-func">IsAa</span> - true if the Bioseq is a protein.</p></li></ul><p>In addition, many utility functions for working with Bioseqs and sequence data are defined in the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeqportUtil.html">CSeqportUtil</a> class.</p></div><div class="sec" id="ch_datamod._Seqid_Identifying_th"><h4><span class="title">Seq-id: Identifying the Bioseq</span></h4><p>Every Bioseq MUST have at least one Seq-id, or sequence identifier. This means a Bioseq is always citable. You can refer to it by a label of some sort. This is a crucial property for different software tools or different scientists to be able to talk about the same thing. There is a wide range of Seq-ids and they are used in different ways. They are discussed in more detail in the <a href="ch_datamod.html#ch_datamod.datamodel.seqloc">Sequence Ids and Locations</a> section.</p></div><div class="sec" id="ch_datamod.Seqannot_Annotating_"><h4><span class="title">Seq-annot: Annotating the Bioseq</span></h4><p>A Seq-annot is a self-contained package of sequence annotations, or information that refers to specific locations on specific Bioseqs. Every Seq-annot can have an Object-id for local use by software, a Dbtag for globally identifying the source of the Seq-annot, and/or a name and description for display and use by a human. These describe the whole package of annotations and make it attributable to a source, independent of the source of the Bioseq.</p><p>A Seq-annot may contain a feature table, a set of sequence alignments, or a set of graphs of attributes along the sequence. These are described in detail in the <a href="ch_datamod.html#ch_datamod.Associating_Annotati">Sequence Annotation</a> section.</p><p>A Bioseq may have many Seq-annots. This means it is possible for one Bioseq to have feature tables from several different sources, or a feature table and set of alignments. A collection of sequences (see Sets Of Bioseqs) can have Seq-annots as well. Finally, a Seq-annot can stand alone, not directly attached to anything. This is because each element in the Seq-annot has specific references to locations on Bioseqs so the information is very explicitly associated with Bioseqs, not implicitly associated by attachment. This property makes possible the exchange of information about Bioseqs as naturally as the exchange of the Bioseqs themselves, be it among software tools or between scientists or as contributions to public databases.</p><p>Some of the important methods for the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeq__annot.html">CSeq_annot</a> class are:</p><ul><li><p><span class="nctnt ncbi-func">AddName()</span> - adds or replaces annotation descriptor of type <span class="nctnt ncbi-monospace">name</span>.</p></li><li><p><span class="nctnt ncbi-func">AddTitle()</span>, <span class="nctnt ncbi-func">SetTitle()</span> - adds or replaces annotation descriptor of type <span class="nctnt ncbi-monospace">title</span>.</p></li><li><p><span class="nctnt ncbi-func">AddComment()</span> - adds annotation descriptor of type <span class="nctnt ncbi-monospace">comment</span>.</p></li><li><p><span class="nctnt ncbi-func">SetCreateDate()</span>, <span class="nctnt ncbi-func">SetUpdateDate()</span> - add or set annotation create/update time.</p></li><li><p><span class="nctnt ncbi-func">AddUserObject()</span> - add a user-object descriptor.</p></li></ul></div><div class="sec" id="ch_datamod.Seqdescr_Describing_"><h4><span class="title">Seq-descr: Describing the Bioseq and Placing It In Context</span></h4><p>A Seq-descr is meant to describe a Bioseq (or a set of Bioseqs) and place it in a biological and/or bibliographic context. Seq-descrs apply to the whole Bioseq. Some Seq-descr classes appear also as features, when used to describe a specific part of a Bioseq. But anything appearing at the Seq-descr level applies to the whole thing.</p><p>The C++ implementation of <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeq__descr.html">CSeq_descr</a> uses a list of <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeqdesc.html">CSeqdesc</a> objects, where each object contains a choice indicating what kind of <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeqdesc.html">CSeqdesc</a> it is as well as the data representation of that choice. The <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeqdesc__Base.html">CSeqdesc_Base</a> header file lists the choice enumeration which are summarized in the following table. The Value column shows the numeric value of the choice.</p><p><b>Seqdesc Choice Variants</b></p><div class="table" id="ch_datamod.T3"><table><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1"><b>Value</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Name</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Explanation</b></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1">e_not_set</td><td align="left" valign="middle" rowspan="1" colspan="1">choice not set</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Mol_type</td><td align="left" valign="middle" rowspan="1" colspan="1">role of molecule in life</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Modif</td><td align="left" valign="middle" rowspan="1" colspan="1">modifying keywords of mol-type</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Method</td><td align="left" valign="middle" rowspan="1" colspan="1">protein sequencing method used</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">4</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Name</td><td align="left" valign="middle" rowspan="1" colspan="1">a commonly used name (e.g. "SV40") </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">5</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Title</td><td align="left" valign="middle" rowspan="1" colspan="1">a descriptive title or definition</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Org</td><td align="left" valign="middle" rowspan="1" colspan="1">(single) organism from which mol comes</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">7</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Comment</td><td align="left" valign="middle" rowspan="1" colspan="1">descriptive comment (may have many)</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">8</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Num</td><td align="left" valign="middle" rowspan="1" colspan="1">a numbering system for whole Bioseq</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">9</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Maploc</td><td align="left" valign="middle" rowspan="1" colspan="1">a map location from a mapping database</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">10</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Pir</td><td align="left" valign="middle" rowspan="1" colspan="1">PIR specific data</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">11</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Genbank</td><td align="left" valign="middle" rowspan="1" colspan="1">GenBank flatfile specific data</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Pub</td><td align="left" valign="middle" rowspan="1" colspan="1">Publication citation and descriptive info from pub </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">13</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Region</td><td align="left" valign="middle" rowspan="1" colspan="1">name of genome region (e.g. B-globin cluster) </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">14</td><td align="left" valign="middle" rowspan="1" colspan="1">e_User</td><td align="left" valign="middle" rowspan="1" colspan="1">user defined data object for any purpose</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">15</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Sp</td><td align="left" valign="middle" rowspan="1" colspan="1">SWISSPROT specific data</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">16</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Dbxref</td><td align="left" valign="middle" rowspan="1" colspan="1">cross reference to other databases</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">17</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Embl</td><td align="left" valign="middle" rowspan="1" colspan="1">EMBL specific data</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">18</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Create_date</td><td align="left" valign="middle" rowspan="1" colspan="1">date entry was created by source database</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">19</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Update_date</td><td align="left" valign="middle" rowspan="1" colspan="1">date entry last updated by source database </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">20</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Prf</td><td align="left" valign="middle" rowspan="1" colspan="1">PRF specific data</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">21</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Pdb</td><td align="left" valign="middle" rowspan="1" colspan="1">PDB specific data</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">22</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Het</td><td align="left" valign="middle" rowspan="1" colspan="1">heterogen: non-Bioseq atom/molecule</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">23</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Source</td><td align="left" valign="middle" rowspan="1" colspan="1">source of materials, includes Org-ref</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">24</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Molinfo</td><td align="left" valign="middle" rowspan="1" colspan="1">info on the molecule and techniques</td></tr></tbody></table></div><div class="sec" id="ch_datamod.moltype_The_Molecule"><h5><span class="title">mol-type: The Molecule Type</span></h5><p>A Seq-descr.mol-type is of type GIBB-mol. It is derived from the molecule information used in the GenInfo BackBone database. It indicates the biological role of the Bioseq in life. It can be genomic (including organelle genomes). It can be a transcription product such as pre-mRNA, mRNA, rRNA, tRNA, snRNA (small nuclear RNA), or scRNA (small cytoplasmic RNA). All amino acid sequences are peptides. No distinction is made at this level about the level of processing of the peptide (but see <a href="ch_datamod.html#ch_datamod.Protref_Reference_To">Prot-ref</a> in the <a href="ch_datamod.html#ch_datamod.datamodel.seqfeat">Sequence Features</a> section). The type other-genetic is provided for "other genetic material" such a B chromosomes or F factors that are not normal genomic material but are also not transcription products. The type genomic-mRNA is provided to describe sequences presented in figures in papers in which the author has combined genomic flanking sequence with cDNA sequence. Since such a figure often does not accurately reflect either the sequence of the mRNA or the sequence of genome, this practice should be discouraged.</p></div><div class="sec" id="ch_datamod.modif_Modifying_Our_"><h5><span class="title">modif: Modifying Our Assumptions About a Bioseq</span></h5><p>A GIBB-mod began as a GenInfo BackBone component and was found to be of general utility. A GIBB-mod is meant to modify the assumptions one might make about a Bioseq. If a GIBB-mod is not present, it does not mean it does not apply, only that it is part of a reasonable assumption already. For example, a Bioseq with GIBB-mol = genomic would be assumed to be DNA, to be chromosomal, and to be partial (complete genome sequences are still rare). If GIBB-mod = mitochondrial and GIBB-mod = complete are both present in Seqdesc, then we know this is a complete mitochondrial genome. A Seqdesc contains a list of GIBB-mods.</p><p>The modifier concept permits a lot of flexibility. So a peptide with GIBB-mod = mitochondrial is a mitochondrial protein. There is no implication that it is from a mitochondrial gene, only that it functions in the mitochondrion. The assumption is that peptide sequences are complete, so GIBB-mod = complete is not necessary for most proteins, but GIBB-mod = partial is important information for some. A list of brief explanations of GIBB-mod values follows:</p><p><b>GIBB-mod</b></p><div class="table" id="ch_datamod.T4"><table><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1"><b>Value</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Name</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Explanation</b></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_dna</td><td align="left" valign="middle" rowspan="1" colspan="1">molecule is DNA in life</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_rna</td><td align="left" valign="middle" rowspan="1" colspan="1">molecule is RNA in life</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_extrachrom</td><td align="left" valign="middle" rowspan="1" colspan="1">molecule is extrachromosomal</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_plasmid</td><td align="left" valign="middle" rowspan="1" colspan="1">molecule is or is from a plasmid</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">4</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_mitochondrial</td><td align="left" valign="middle" rowspan="1" colspan="1">molecule is from mitochondrion</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">5</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_chloroplast</td><td align="left" valign="middle" rowspan="1" colspan="1">molecule is from chloroplast</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_kinetoplast</td><td align="left" valign="middle" rowspan="1" colspan="1">molecule is from kinetoplast</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">7</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_cyanelle</td><td align="left" valign="middle" rowspan="1" colspan="1">molecule is from cyanelle</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">8</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_synthetic</td><td align="left" valign="middle" rowspan="1" colspan="1">molecule was synthesized artificially</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">9</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_recombinant</td><td align="left" valign="middle" rowspan="1" colspan="1">molecule was formed by recombination</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">10</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_partial</td><td align="left" valign="middle" rowspan="1" colspan="1">not a complete sequence for molecule</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">11</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_complete</td><td align="left" valign="middle" rowspan="1" colspan="1">sequence covers complete molecule</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_mutagen</td><td align="left" valign="middle" rowspan="1" colspan="1">molecule subjected to mutagenesis</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">13</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_natmut</td><td align="left" valign="middle" rowspan="1" colspan="1">molecule is a naturally occurring mutant</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">14</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_transposon</td><td align="left" valign="middle" rowspan="1" colspan="1">molecule is a transposon</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">15</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_insertion_seq</td><td align="left" valign="middle" rowspan="1" colspan="1">molecule is an insertion sequence</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">16</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_no_left</td><td align="left" valign="middle" rowspan="1" colspan="1">partial molecule is missing left end <br />5' end for nucleic acid, NH3 end for peptide</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">17</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_no_right</td><td align="left" valign="middle" rowspan="1" colspan="1">partial molecule is missing right end <br />3' end for nucleic acid, COOH end for peptide</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">18</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_macronuclear</td><td align="left" valign="middle" rowspan="1" colspan="1">molecule is from macronucleus</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">19</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_proviral</td><td align="left" valign="middle" rowspan="1" colspan="1">molecule is an integrated provirus</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">20</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_est</td><td align="left" valign="middle" rowspan="1" colspan="1">molecule is an expressed sequence tag</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">21</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_sts</td><td align="left" valign="middle" rowspan="1" colspan="1">sequence tagged site</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">22</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_survey</td><td align="left" valign="middle" rowspan="1" colspan="1">one pass survey sequence</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">23</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_chromoplast</td><td align="center" valign="middle" rowspan="1" colspan="1"></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">24</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_genemap</td><td align="left" valign="middle" rowspan="1" colspan="1">genetic map</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">25</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_restmap</td><td align="left" valign="middle" rowspan="1" colspan="1">ordered restriction map</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">26</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_physmap</td><td align="left" valign="middle" rowspan="1" colspan="1">physical map (not ordered restriction map)</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">255</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_mod_other</td><td align="center" valign="middle" rowspan="1" colspan="1"></td></tr></tbody></table></div></div><div class="sec" id="ch_datamod.method_Protein_Seque"><h5><span class="title">method: Protein Sequencing Method</span></h5><p>The method <span class="nctnt ncbi-func">GetMethod()</span> gives the method used to obtain a protein sequence. The values for a GIBB-method are stored in the object as enumerated values mapping directly from the ASN.1 ENUMERATED type. They are:</p><p><b>GIBB-method</b></p><div class="table" id="ch_datamod.T5"><table><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1"><b>Value</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Name</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Explanation</b></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_method_concept_trans</td><td align="left" valign="middle" rowspan="1" colspan="1">conceptual translation </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_method_seq_pept</td><td align="left" valign="middle" rowspan="1" colspan="1">peptide itself was sequenced </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_method_both</td><td align="left" valign="middle" rowspan="1" colspan="1">conceptual translation with partial peptide sequencing </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">4</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_method_seq_pept_overlap</td><td align="left" valign="middle" rowspan="1" colspan="1">peptides sequenced, fragments ordered by overlap </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">5</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_method_seq_pept_homol</td><td align="left" valign="middle" rowspan="1" colspan="1">peptides sequenced, fragments ordered by homology </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">eGIBB_method_concept_trans_a</td><td align="left" valign="middle" rowspan="1" colspan="1">conceptual translation, provided by author of sequence </td></tr></tbody></table></div></div><div class="sec" id="ch_datamod.name_A_Descriptive_N"><h5><span class="title">name: A Descriptive Name</span></h5><p>A sequence name is very different from a sequence identifier. A Seq-id uniquely identifies a specific Bioseq. A Seq-id may be no more than an integer and will not necessarily convey any biological or descriptive information in itself. A name is not guaranteed to uniquely identify a single Bioseq, but if used with caution, can be a very useful tool to identify the best current entry for a biological entity. For example, we may wish to associate the name "SV40" with a single Bioseq for the complete genome of SV40. Let us suppose this Bioseq has the Seq-id 10. Then it is discovered that there were errors in the original Bioseq designated 10, and it is replaced by a new Bioseq from a curator with Seq-id 15. The name "SV40" can be moved to Seq-id 15 now. If a biologist wishes to see the "best" or "most typical" sequence of the SV40 genome, she would retrieve on the name "SV40". At an earlier point in time she would get Bioseq 10. At a later point she would get Bioseq 15. Note that her query is always answered in the context of best current data. On the other hand, if she had done a sequence analysis on Bioseq 10 and wanted to compare results, she would cite Seq-id 10, not the name "SV40", since her results apply to the specific Bioseq, 10, not necessarily to the "best" or "most typical" entry for the virus at the moment.</p></div><div class="sec" id="ch_datamod.title_A_Descriptive_"><h5><span class="title">title: A Descriptive Title</span></h5><p>A title is a brief, generally one line, description of an entry. It is extremely useful when presenting lists of Bioseqs returned from a query or search. This is the same as the familiar GenBank flatfile DEFINITION line.</p><p>Because of the utility of such terse summaries, NCBI has been experimenting with algorithmically generated titles which try to pack as much information as possible into a single line in a regular and readable format. You will see titles of this form appearing on entries produced by the NCBI journal scanning component of GenBank.</p><pre>DEFINITION  atp6=F0-ATPase subunit 6 {RNA edited} [Brassica napus=rapeseed,<br />            mRNA Mitochondrial, 905 nt]<br />DEFINITION  mprA=metalloprotease, mprR=regulatory protein [Streptomyces<br />            coelicolor, Muller DSM3030, Genomic, 3 genes, 2040 nt]<br />DEFINITION  pelBC gene cluster: pelB=pectate lyase isozyme B, pelC=pectate<br />            lyase isozyme C [Erwinia chrysanthemi, 3937, Genomic, 2481 nt]<br />DEFINITION  glycoprotein J...glycoprotein I [simian herpes B virus SHBV,<br />            prototypic B virus, Genomic, 3 genes, 2652 nt]<br />DEFINITION  glycoprotein B, gB [human herpesvirus-6 HHV6, GS, Peptide, 830<br />               aa]<br />DEFINITION  {pseudogene} RESA-2=ring-infected erythrocyte surface antigen 2<br />            [Plasmodium falciparum, FCR3, Genomic, 3195 nt]<br />DEFINITION  microtubule-binding protein tau {exons 4A, 6, 8 and 13/14} [human,<br />            Genomic, 954 nt, segment 1 of 4]<br />DEFINITION  CAD protein carbamylphosphate synthetase domain {5' end} [Syrian<br />            hamsters, cell line 165-28, mRNA Partial, 553 nt]<br />DEFINITION  HLA-DPB1 (SSK1)=MHC class II antigen [human, Genomic, 288 nt]</pre><p>Gene and protein names come first. If both gene name and protein name are know they are linked with "=". If more than two genes are on a Bioseq then the first and last gene are given, separated by "...". A region name, if available, will precede the gene names. Extra comments will appear in {}. Organism, strain names, and molecule type and modifier appear in [] at the end. Note that the whole definition is constructed from structured information in the ASN.1 data structure by software. It is not composed by hand, but is instead a brief, machine generated summary of the entry based on data within the entry. We therefore discourage attempts to machine parse this line. It may change, but the underlying structured data will not. Software should always be designed to process the structured data.</p></div><div class="sec" id="ch_datamod.org_What_Organism_Di"><h5><span class="title">org: What Organism Did this Come From?</span></h5><p>If the whole Bioseq comes from a single organism (the usual case). See the Feature Table section for a detailed description of the Org-ref (organism reference) data structure.</p></div><div class="sec" id="ch_datamod.comment_Commentary_T"><h5><span class="title">comment: Commentary Text</span></h5><p>A comment that applies to the whole Bioseq may go here. A comment may contain many sentences or paragraphs. A Bioseq may have many comments.</p></div><div class="sec" id="ch_datamod.num_Applying_a_Numbe"><h5><span class="title">num: Applying a Numbering System to a Bioseq</span></h5><p>One may apply a custom numbering system over the full length of the Bioseq with this Seqdescr. See the section on Numbering later in this chapter for a detailed description of the possible forms this can take. To report the numbering system used in a particular publication, the Pubdesc Seq-descr has its own Numbering slot.</p></div><div class="sec" id="ch_datamod.maploc_Map_Location"><h5><span class="title">maploc: Map Location</span></h5><p>The map location given here is a Dbtag, to be able to cite a map location given by a map database to this Bioseq (e.g. "GDB", "4q21"). It is not necessarily the map location published by the author of the Bioseq. A map location published by the author would be part of a Pubdesc Seq-descr.</p></div><div class="sec" id="ch_datamod.pir_PIR_Specific_Dat"><h5><span class="title">pir: PIR Specific Data</span></h5></div><div class="sec" id="ch_datamod.sp_SWISSPROT_Data"><h5><span class="title">sp: SWISSPROT Data</span></h5></div><div class="sec" id="ch_datamod.embl_EMBL_Data"><h5><span class="title">embl: EMBL Data</span></h5></div><div class="sec" id="ch_datamod.prf_PRF_Data"><h5><span class="title">prf: PRF Data</span></h5></div><div class="sec" id="ch_datamod.pdb_PDB_Data"><h5><span class="title">pdb: PDB Data</span></h5><p>NCBI produces ASN.1 encoded entries from data provided by many different sources. Almost all of the data items from these widely differing sources are mapped into the common ASN.1 specifications described in this document. However, in all cases a small number of elements are unique to a particular data source, or cannot be unambiguously mapped into the common ASN.1 specification. Rather than lose such elements, they are carried in small data structures unique to each data source. These are specified in <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/seqblock/seqblock.asn">seqblock.asn</a> and implemented by the C++ classes <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCGB__block.html">CGB_block</a>, <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCEMBL__block.html">CEMBL_block</a>, <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSP__block.html">CSP_block</a>, <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCPIR__block.html">CPIR_block</a>, <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCPRF__block.html">CPRF_block</a>, and <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCPDB__block.html">CPDB_block</a>.</p></div><div class="sec" id="ch_datamod.genbank_GenBank_Flat"><h5><span class="title">genbank: GenBank Flatfile Specific Data</span></h5><p>A number of data items unique to the GenBank flatfile format do not map readily to the common ASN.1 specification. These fields are partially populated by NCBI for Bioseqs derived from other sources than GenBank to permit the production of valid GenBank flatfile entries from those Bioseqs. Other fields are populated to preserve information coming from older GenBank entries.</p></div><div class="sec" id="ch_datamod.pub_Description_of_a"><h5><span class="title">pub: Description of a Publication</span></h5><p>This Seq-descr is used both to cite a particular bibliographic source and to carry additional information about the Bioseq as it appeared in that publication, such as the numbering system to use, the figure it appeared in, a map location given by the author in that paper, and so. See the section on the Pubdesc later in this chapter for a more detailed description of this data type.</p></div><div class="sec" id="ch_datamod.region_Name_of_a_Gen"><h5><span class="title">region: Name of a Genomic Region</span></h5><p>A region of genome often has a name which is a commonly understood description for the Bioseq, such as "B-globin cluster".</p></div><div class="sec" id="ch_datamod.user_A_Userdefined_S"><h5><span class="title">user: A User-defined Structured Object</span></h5><p>This is a place holder for software or databases to add their own structured datatypes to Bioseqs without corrupting the common specification or disabling the automatic ASN.1 syntax checking. A User-object can also be used as a feature. See the chapter on General User Objects for a detailed explanation of User-objects.</p></div><div class="sec" id="ch_datamod.neighbors_Bioseqs_Re"><h5><span class="title">neighbors: Bioseqs Related by Sequence Similarity</span></h5><p>NCBI computes a list of "neighbors", or closely related Bioseqs based on sequence similarity for use in the Entrez service. This descriptor is so that such context setting information could be included in a Bioseq itself, if desired.</p></div><div class="sec" id="ch_datamod.createdate"><h5><span class="title">create-date</span></h5><p>This is the date a Bioseq was created for the first time. It is normally supplied by the source database. It may not be present when not normally distributed by the source database.</p></div><div class="sec" id="ch_datamod.updatedate"><h5><span class="title">update-date</span></h5><p>This is the date of the last update to a Bioseq by the source database. For several source databases this is the only date provided with an entry. The nature of the last update done is generally not available in computer readable (or any) form.</p></div><div class="sec" id="ch_datamod._het_Heterogen"><h5><span class="title">het: Heterogen</span></h5><p>A "heterogen" is a non-biopolymer atom or molecule associated with Bioseqs from PDB. When a heterogen appears at the Seq-descr level, it means it was resolved in the crystal structure but is not associated with specific residues of the Bioseq. Heterogens which are associated with specific residues of the Bioseq are attached as features.</p></div></div><div class="sec" id="ch_datamod.Seqinst_Instantiatin"><h4><span class="title">Seq-inst: Instantiating the Bioseq</span></h4><p>Seq-inst.mol gives the physical type of the Bioseq in the living organism. If it is not certain if the Bioseq is DNA (dna) or RNA (rna), then (na) can be used to indicate just "nucleic acid". A protein is always (aa) or "amino acid". The values "not-set" or "other" are provided for internal use by editing and authoring tools, but should not be found on a finished Bioseq being sent to an analytical tool or database.</p><p>The representation class to which the Bioseq belongs is encoded in Seq-inst.repr. The values "not-set" or "other" are provided for internal use by editing and authoring tools, but should not be found on a finished Bioseq being sent to an analytical tool or database. The Data Model chapter discusses the representation class hierarchy in general. Specific details follow below.</p><p>Some of the important methods for Seq-inst are:</p><ul><li><p><span class="nctnt ncbi-func">IsAa</span> - determines if the sequence type is amino acid</p></li><li><p><span class="nctnt ncbi-func">IsNa</span> - determines if the sequence type is nucleic acid</p></li></ul><div class="sec" id="ch_datamod.Seqinst_Virtual_Bios"><h5><span class="title">Seq-inst: Virtual Bioseq</span></h5><p>A "virtual" Bioseq is one in which we know the type of molecule, and possibly its length, topology, and/or strandedness, but for which we do not have sequence data. It is not unusual to have some uncertainty about the length of a virtual Bioseq, so Seq-inst.fuzz may be used. The fields Seq-inst.seq-data and Seq-inst.ext are not appropriate for a virtual Bioseq.</p></div><div class="sec" id="ch_datamod.Seqinst_Raw_Bioseq"><h5><span class="title">Seq-inst: Raw Bioseq</span></h5><p>A "raw" Bioseq does have sequence data, so Seq-inst.length must be set and there should be no Seq-inst.fuzz associated with it. Seq-inst.seq-data must be filled in with the sequence itself and a Seq-data encoding must be selected which is appropriate to Seq-inst.mol. The topology and strandedness may or may not be available. Seq-inst.ext is not appropriate.</p></div><div class="sec" id="ch_datamod.Seqinst_Segmented_Bi"><h5><span class="title">Seq-inst: Segmented Bioseq</span></h5><p>A segmented ("seg") Bioseq has all the properties of a virtual Bioseq, except that Seq-hist.ext of type Seq-ext.seg must be used to indicate the pieces of other Bioseqs to assemble to make the segmented Bioseq. A Seq-ext.seg is defined as a SEQUENCE OF Seq-loc, or a series of locations on other Bioseqs, taken in order.</p><p>For example, a segmented Bioseq (called "X") has a SEQUENCE OF Seq-loc which are an interval from position 11 to 20 on Bioseq "A" followed by an interval from position 6 to 15 on Bioseq "B". So "X" is a Bioseq with no internal gaps which is 20 residues long (no Seq-inst.fuzz). The first residue of "X" is the residue found at position 11 in "A". To obtain this residue, software must retrieve Bioseq "A" and examine the residue at "A" position 11. The segmented Bioseq contains no sequence data itself, only pointers to where to get the sequence data and what pieces to assemble in what order.</p><p>The type of segmented Bioseq described above might be used to represent the putative mRNA by simply pointing to the exons on two pieces of genomic sequence. Suppose however, that we had only sequenced around the exons on the genomic sequence, but wanted to represent the putative complete genomic sequence. Let us assume that Bioseq "A" is the genomic sequence of the first exon and some small amount of flanking DNA and that Bioseq "B" is the genomic sequence around the second exon. Further, we may know from mapping that the exons are separated by about two kilobases of DNA. We can represent the genomic region by creating a segmented sequence in which the first location is all of Bioseq "A". The second location will be all of a virtual Bioseq (call it "C") whose length is two thousand and which has a Seq-inst.fuzz representing whatever uncertainty we may have about the exact length of the intervening genomic sequence. The third location will be all of Bioseq "B". If "A" is 100 base pairs long and "B" is 200 base pairs, then the segmented entry is 2300 base pairs long ("A"+"C"+"B") and has the same Seq-inst.fuzz as "C" to express the uncertainty of the overall length.</p><p>A variation of the case above is when one has no idea at all what the length of the intervening genomic region is. A segmented Bioseq can also represent this case. The Seq-inst.ext location chain would be first all of "A", then a Seq-loc of type "null", then all of "B". The "null" indicates that there is no available information here. The length of the segmented Bioseq is just the sum of the length of "A" and the length of "B", and Seq-inst.fuzz is set to indicate the real length is greater-than the length given. The "null" location does not add to the overall length of the segmented Bioseq and is ignored in determining the integer value of a location on the segmented Bioseq itself. If "A" is 100 base pairs long and "B" is 50 base pairs long, then position 0 on the segmented Bioseq is equivalent to the first residue of "A" and position 100 on the segmented Bioseq is equivalent to the first residue of "B", despite the intervening "null" location indicating the gap of unknown length. Utility functions in the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeqportUtil.html">CSeqportUtil</a> class can be configured to signal when crossing such boundaries, or to ignore them.</p><p>The Bioseqs referenced by a segmented Bioseq should always be from the same Seq-inst.mol class as the segmented Bioseq, but may well come from a mixture of Seq-inst.repr classes (as for example the mixture of virtual and raw Bioseq references used to describe sequenced and unsequenced genomic regions above). Other reasonable mixtures might be raw and map (see below) Bioseqs to describe a region which is fully mapped and partially sequenced, or even a mixture of virtual, raw, and map Bioseqs for a partially mapped and partially sequenced region. The "character" of any region of a segmented Bioseq is always taken from the underlying Bioseq to which it points in that region. However, a segmented Bioseq can have its own annotations. Things like feature tables are not automatically propagated to the segmented Bioseq.</p></div><div class="sec" id="ch_datamod.Seqinst_Reference_Bi"><h5><span class="title">Seq-inst: Reference Bioseq</span></h5><p>A reference Bioseq is effectively a segmented Bioseq with only one pointer location. It behaves exactly like a segmented Bioseq in taking its data and "character" from the Bioseq to which it points. Its purpose is not to construct a new Bioseq from others like a segmented Bioseq, but to refer to an existing Bioseq. It could be used to provide a convenient handle to a frequently used region of a larger Bioseq. Or it could be used to develop a customized, personally annotated view of a Bioseq in a public database without losing the "live" link to the public sequence.</p><p>In the first example, software would want to be able to use the Seq-loc to gather up annotations and descriptors for the region and display them to user with corrections to align them appropriately to the sub region. In this form, a scientist my refer to the "lac region" by name, and analyze or annotate it as if it were a separate Bioseq, but each retrieve starts with a fresh copy of the underlying Bioseq and annotations, so corrections or additions made to the underlying Bioseq in the public database will be immediately visible to the scientist, without either having to always look at the whole Bioseq or losing any additional annotations the scientist may have made on the region themselves.</p><p>In the second example, software would not propagate annotations or descriptors from the underlying Bioseq by default (because presumably the scientist prefers his own view to the public one) but the connection to the underlying Bioseq is not lost. Thus the public annotations are available on demand and any new annotations added by the scientist share the public coordinate system and can be compared with those done by others.</p></div><div class="sec" id="ch_datamod.Seqinst_Constructed_"><h5><span class="title">Seq-inst: Constructed Bioseq</span></h5><p>A constructed (const) Bioseq inherits all the attributes of a raw Bioseq. It is used to represent a Bioseq which has been constructed by assembling other Bioseqs. In this case the component Bioseqs normally overlap each other and there may be considerable redundancy of component Bioseqs. A constructed Bioseq is often also called a "contig" or a "merge".</p><p>Most raw Bioseqs in the public databases were constructed by merging overlapping gel or sequencer readings of a few hundred base pairs each. While the const Bioseq data structure can easily accommodate this information, the const Bioseq data type was not really intended for this purpose. It was intended to represent higher level merges of public sequence data and private data, such as when a number of sequence entries from different authors are found to overlap or be contained in each other. In this case a view of the larger sequence region can be constructed by merging the components. The relationship of the merge to the component Bioseqs is preserved in the constructed Bioseq, but it is clear that the constructed Bioseq is a "better" or "more complete" view of the overall region, and could replace the component Bioseqs in some views of the sequence database. In this way an author can submit a data structure to the database which in this author's opinion supersedes his own or other scientist's database entries, without the database actually dropping the other author's entries (who may not necessarily agree with the author submitting the constructed Bioseq).</p><p>The constructed Bioseq is like a raw, rather than a segmented, Bioseq because Seq-inst.seq-data must be present. The sequence itself is part of the constructed Bioseq. This is because the component Bioseqs may overlap in a number of ways, and expert knowledge or voting rules may have been applied to determine the "correct" or "best" residue from the overlapping regions. The Seq-inst.seq-data contains the sequence which is the final result of such a process.</p><p>Seq-inst.ext is not used for the constructed Bioseq. The relationship of the merged sequence to its component Bioseqs is stored in Seq-inst.hist, the history of the Bioseq (described in more detail below). Seq-hist.assembly contains alignments of the constructed Bioseq with its component Bioseqs. Any Bioseq can have a Seq-hist.assembly. A raw Bioseq may use this to show its relationship to its gel readings. The constructed Bioseq is special in that its Seq-hist.assembly shows how a high level view was constructed from other pieces. The sequence in a constructed Bioseq is only posited to exist. However, since it is constructed from data by possibly many different laboratories, it may never have been sequenced in its entirety from a single biological source.</p></div><div class="sec" id="ch_datamod.Seqinst_Typical_or_C"><h5><span class="title">Seq-inst: Typical or Consensus Bioseq</span></h5><p>A consensus (consen) Bioseq is used to represent a pattern typical of a sequence region or family of sequences. There is no assertion that even one sequence exists that is exactly like this one, or even that the Bioseq is a best guess at what a real sequence region looks like. Instead it summarizes attributes of an aligned collection of real sequences. It could be a "typical" ferredoxin made by aligning ferredoxin sequences from many organisms and producing a protein sequence which is by some measure "central" to the group. By using the NCBIpaa encoding for the protein, which permits a probability to be assigned to each position that any of the standard amino acids occurs there, one can create a "weight matrix" or "profile" to define the sequence.</p><p>While a consensus Bioseq can represent a frequency profile (including the probability that any amino acid can occur at a position, a type of gap penalty), it cannot represent a regular expression per se. That is because all Bioseqs represent fixed integer coordinate systems. This property is essential for attaching feature tables or expressing alignments. There is no clear way to attach a fixed coordinate system to a regular expression, while one can approximate allowing weighted gaps in specific regions with a frequency profile. Since the consensus Bioseq is like any other, information can be attached to it through a feature table and alignments of the consensus pattern to other Bioseqs can be represented like any other alignment (although it may be computed a special way). Through the alignment, annotated features on the pattern can be related to matching regions of the aligned sequence in a straightforward way.</p><p>Seq-hist.assembly can be used in a consensus Bioseq to record the sequence regions used to construct the pattern and their relationships with it. While Seq-hist.assembly for a constructed Bioseq indicates the relationship with Bioseqs which are meant to be superseded by the constructed Bioseq, the consensus Bioseq does not in any way replace the Bioseqs in its Seq-hist.assembly. Rather it is a summary of common features among them, not a "better" or "more complete" version of them.</p></div><div class="sec" id="ch_datamod.Seqinst_Map_Bioseqs"><h5><span class="title">Seq-inst: Map Bioseqs</span></h5><p>A map Bioseq inherits all the properties of a virtual Bioseq. For a consensus genetic map of E.coli, we can posit that the chromosome is DNA, circular, double-stranded, and about 5 million base pairs long. Given this coordinate system, we estimate the positions of genes on it based on genetic evidence. That is, we build a feature table with Gene-ref features on it (explained in more detail in the Feature Table chapter). Thus, a map Bioseq is a virtual Bioseq with a Seq-inst.ext which is a feature table. In this case the feature table is an essential part of instantiating the Bioseq, not simply an annotation on the Bioseq. This is not to say a map Bioseq cannot have a feature table in the usual sense as well. It can. It can also be used in alignments, displays, or by any software that can process or store Bioseqs. This is the great strength of this approach. A genetic or physical map is just another Bioseq and can be stored or analyzed right along with other more typical Bioseqs.</p><p>It is understood that within a particular physical or genetic mapping research project more data will have to be present than the map Bioseq can represent. But the same is true for a big sequencing project. The Bioseq is an object for reporting the result of such projects to others in a way that preserves most or all the information of use to workers outside the particular research group. It also preserves enough information to be useful to software tools within the project, such as display tools or analysis tools which were written by others.</p><p>A number of attributes of Bioseqs can make such a generic representation more "natural" to a particular research community. For the E.coli map example, above, no E.coli geneticist thinks of the positions of genes in base pairs (yet). So a Num-ref annotation (see Seq-descr, below) can be attached to the Bioseq, which provides information to convert the internal integer coordinate system of the map Bioseq to "minutes", the floating point numbers from 0.0 to 100.0 that E.coli gene positions are traditionally given in. Seq-loc objects which the Gene-ref features use to indicate their position can represent uncertainty, and thus give some idea of the accuracy of the mapping in a simple way. This representation cannot store order information directly (e.g. B and C are after A and before D, but we don't know the absolute distance and we don't know the relative order of B and C), which would need to be stored in a genetic mapping research database. However, a reasonable enough presentation can be made of this situation using locations and uncertainties to be very useful for a wide variety of purposes. As more sequence and physical map information become available, such uncertainties in gene position, at least for the "typical" chromosome, will gradually be resolved and will then map very will to such a generic model.</p><p>A physical map Bioseq has similar strengths and weaknesses as the genetic map Bioseq. It can represent an ordered map (such as an ordered restriction map) very well and easily. For some contig building approaches, ordering information is essential to the process of building the physical map and would have to be stored and processed separately by the map building research group. However, the map Bioseq serves very well as a vehicle for periodic reports of the group's best view of the physical map for consumption by the scientific public. The map Bioseq data structure maps quite well to the figures such groups publish to summarize their work. The map Bioseq is an electronic summary that can be integrated with other data and software tools.</p></div></div><div class="sec" id="ch_datamod.Seqhist_History_of_a"><h4><span class="title">Seq-hist: History of a Seq-inst</span></h4><p>Seq-hist is literally the history of the Seq-inst part of a Bioseq. It does not track changes in annotation at all. However, since the coordinate system provided by the Seq-inst is the critical element for tying annotations and alignments done at various times by various people into a single consistent database, this is the most important element to track.</p><p>While Seq-hist can use any valid Seq-id, in practice NCBI will use the best available Seq-id in the Seq-hist. For this purpose, the Seq-id most tightly linked to the exact sequence itself is best. See the Seq-id discussion.</p><p>Seq-hist.assembly has been mentioned above. It is a SET OF Seq-align which show the relationship of this Bioseq to any older components that might be merged into it. The Bioseqs included in the assembly are those from which this Bioseq was made or is meant to supersede. The Bioseqs in the assembly need not all be from the author, but could come from anywhere. Assembly just sets the Bioseq in context.</p><p>Seq-hist.replaces makes an editorial statement using a Seq-hist-rec. As of a certain date, this Bioseq should replace the following Bioseqs. Databases at NCBI interpret this in a very specific way. Seq-ids in Seq-hist.replaces, which are owned by the owner of the Bioseq, are taken from the public view of the database. The author has told us to replace them with this one. If the author does not own some of them, it is taken as advice that the older entries may be obsolete, but they are not removed from the public view.</p><p>Seq-hist.replaced-by is a forward pointer. It means this Bioseq was replaced by the following Seq-id(s) on a certain date. In the case described above, that an author tells NCBI that a new Bioseq replaces some of his old ones, not only is the backward pointer (Seq-hist.replaces) provided by the author in the database, but NCBI will update the Seq-hist.replaced-by forward pointer when the old Bioseq is removed from public view. Since such old entries are still available for specific retrieval by the public, if a scientist does have annotation pointing to the old entry, the new entry can be explicitly located. Conversely, the older versions of a Bioseq can easily be located as well. Note that Seq-hist.replaced-by points only one generation forward and Seq-hist.replaces points only one generation back. This makes Bioseqs with a Seq-hist a doubly linked list over its revision history. This is very different from GenBank/EMBL/DDBJ secondary accession numbers, which only indicate "some relationship" between entries. When that relationship happens to be the replacement relationship, they still carry all accession numbers in the secondary accessions, not just the last ones, so reconstructing the entry history is impossible, even in a very general way.</p><p>Another fate which may await a Bioseq is that it is completely withdrawn. This is relatively rare but does happen. Seq-hist.deleted can either be set to just TRUE, or the date of the deletion event can be entered (preferred). If the deleted date is present, the ASN.1 will have the Date CHOICE for Seq-hist.deleted, else if the deleted boolean is TRUE the ASN.1 will have the BOOLEAN form.</p></div><div class="sec" id="ch_datamod.Seqdata_Encoding_the"><h4><span class="title">Seq-data: Encoding the Sequence Data Itself</span></h4><p>In the case of a raw or constructed Bioseq, the sequence data itself is stored in Seq-inst.seq-data, which is the data type Seq-data. Seq-data is a CHOICE of different ways of encoding the data, allowing selection of the optimal type for the case in hand. Both nucleic acid and amino acid encoding are given as CHOICEs of Seq-data rather than further subclassing first. But it is still not reasonable to encode a Bioseq of Seq-inst.mol of "aa" using a nucleic acid Seq-data type.</p><p>The Seq-data type is implemented in C++ with the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeq__data.html">CSeq_data</a> class. This class has an <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeq__data__Base.html#4ebe9e4dab723da143541cd84b40fbd3">E_Choice</a> enumeration to identify the data representation scheme and a union to hold the sequence data.</p><p>The ASN.1 module <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/seqcode/seqcode.asn">seqcode.asn</a> and C++ class <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeq__code__table.html">CSeq_code_table</a> define the allowed values for the various sequence encoding and the ways to display or map between codes. This permits useful information about the allowed encoding to be stored as ASN.1 data and read into a program at runtime. Some of the encodings are presented in tables in the following discussion of the different sequence encodings. The "value" is the internal numerical value of a residue in the C++ code. The "symbol" is a one letter or multi-letter symbol to be used in display to a human. The "name" is a descriptive name for the residue.</p><p>Some of the important methods for <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeq__data.html">CSeq_data</a> are:</p><ul><li><p><span class="nctnt ncbi-func">CSeq_data()</span> - constructors to create objects from string or vector of char</p></li></ul><div class="sec" id="ch_datamod.IUPACaa_The_IUPACIUB"><h5><span class="title">IUPACaa: The IUPAC-IUB Encoding of Amino Acids</span></h5><p>A set of one letter abbreviations for amino acids were suggested by the IUPAC-IUB Commission on Biochemical Nomenclature, published in J. Biol. Chem. (1968) 243: 3557-3559. It is very widely used in both printed and electronic forms of protein sequence, and many computer programs have been written to analyze data in this form internally (that is the actual ASCII value of the one letter code is used internally). To support such approaches, the IUPACaa encoding represents each amino acid internally as the ASCII value of its external one letter symbol. Note that this symbol is UPPER CASE. One may choose to display the value as lower case to a user for readability, but the data itself must be the UPPER CASE value.</p><p>In the NCBI C++ implementation, the values are stored one value per byte.</p><p><b>IUPACaa</b></p><div class="table" id="ch_datamod.T6"><table><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1"><b>Value</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Symbol</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Name</b></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">65</td><td align="left" valign="middle" rowspan="1" colspan="1">A</td><td align="left" valign="middle" rowspan="1" colspan="1">Alanine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">66</td><td align="left" valign="middle" rowspan="1" colspan="1">B</td><td align="left" valign="middle" rowspan="1" colspan="1">Asp or Asn </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">67</td><td align="left" valign="middle" rowspan="1" colspan="1">C</td><td align="left" valign="middle" rowspan="1" colspan="1">Cysteine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">68</td><td align="left" valign="middle" rowspan="1" colspan="1">D</td><td align="left" valign="middle" rowspan="1" colspan="1">Aspartic Acid </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">69</td><td align="left" valign="middle" rowspan="1" colspan="1">E</td><td align="left" valign="middle" rowspan="1" colspan="1">Glutamic Acid </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">70</td><td align="left" valign="middle" rowspan="1" colspan="1">F</td><td align="left" valign="middle" rowspan="1" colspan="1">Phenylalanine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">71</td><td align="left" valign="middle" rowspan="1" colspan="1">G</td><td align="left" valign="middle" rowspan="1" colspan="1">Glycine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">72</td><td align="left" valign="middle" rowspan="1" colspan="1">H</td><td align="left" valign="middle" rowspan="1" colspan="1">Histidine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">73</td><td align="left" valign="middle" rowspan="1" colspan="1">I</td><td align="left" valign="middle" rowspan="1" colspan="1">Isoleucine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">74</td><td align="left" valign="middle" rowspan="1" colspan="1">J</td><td align="left" valign="middle" rowspan="1" colspan="1">Leu or Ile </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">75</td><td align="left" valign="middle" rowspan="1" colspan="1">K</td><td align="left" valign="middle" rowspan="1" colspan="1">Lysine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">76</td><td align="left" valign="middle" rowspan="1" colspan="1">L</td><td align="left" valign="middle" rowspan="1" colspan="1">Leucine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">77</td><td align="left" valign="middle" rowspan="1" colspan="1">M</td><td align="left" valign="middle" rowspan="1" colspan="1">Methionine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">78</td><td align="left" valign="middle" rowspan="1" colspan="1">N</td><td align="left" valign="middle" rowspan="1" colspan="1">Asparagine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">79</td><td align="left" valign="middle" rowspan="1" colspan="1">O</td><td align="left" valign="middle" rowspan="1" colspan="1">Pyrrolysine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">80</td><td align="left" valign="middle" rowspan="1" colspan="1">P</td><td align="left" valign="middle" rowspan="1" colspan="1">Proline </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">81</td><td align="left" valign="middle" rowspan="1" colspan="1">Q</td><td align="left" valign="middle" rowspan="1" colspan="1">Glutamine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">82</td><td align="left" valign="middle" rowspan="1" colspan="1">R</td><td align="left" valign="middle" rowspan="1" colspan="1">Arginine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">83</td><td align="left" valign="middle" rowspan="1" colspan="1">S</td><td align="left" valign="middle" rowspan="1" colspan="1">Serine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">84</td><td align="left" valign="middle" rowspan="1" colspan="1">T</td><td align="left" valign="middle" rowspan="1" colspan="1">Threoine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">86</td><td align="left" valign="middle" rowspan="1" colspan="1">V</td><td align="left" valign="middle" rowspan="1" colspan="1">Valine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">87</td><td align="left" valign="middle" rowspan="1" colspan="1">W</td><td align="left" valign="middle" rowspan="1" colspan="1">Tryptophan </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">88</td><td align="left" valign="middle" rowspan="1" colspan="1">X</td><td align="left" valign="middle" rowspan="1" colspan="1">Undetermined or atypical </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">89</td><td align="left" valign="middle" rowspan="1" colspan="1">Y</td><td align="left" valign="middle" rowspan="1" colspan="1">Tyrosine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">90</td><td align="left" valign="middle" rowspan="1" colspan="1">Z</td><td align="left" valign="middle" rowspan="1" colspan="1">Glu or Gln </td></tr></tbody></table></div></div><div class="sec" id="ch_datamod.NCBIeaa_Extended_IUP"><h5><span class="title">NCBIeaa: Extended IUPAC Encoding of Amino Acids</span></h5><p>The official IUPAC amino acid code has some limitations. One is the lack of symbols for termination, gap, or selenocysteine. Such extensions to the IUPAC codes are also commonly used by sequence analysis software. NCBI has created such a code which is simply the IUPACaa code above extended with the additional symbols.</p><p>In the NCBI C++ implementation, the values are stored one value per byte.</p><p><b>NCBIeaa</b></p><div class="table" id="ch_datamod.T7"><table><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1"><b>Value</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Symbol</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Name</b></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">42</td><td align="left" valign="middle" rowspan="1" colspan="1">*</td><td align="left" valign="middle" rowspan="1" colspan="1">Termination </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">45</td><td align="left" valign="middle" rowspan="1" colspan="1">-</td><td align="left" valign="middle" rowspan="1" colspan="1">Gap</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">65</td><td align="left" valign="middle" rowspan="1" colspan="1">A</td><td align="left" valign="middle" rowspan="1" colspan="1">Alanine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">66</td><td align="left" valign="middle" rowspan="1" colspan="1">B</td><td align="left" valign="middle" rowspan="1" colspan="1">Asp or Asn </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">67</td><td align="left" valign="middle" rowspan="1" colspan="1">C</td><td align="left" valign="middle" rowspan="1" colspan="1">Cysteine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">68</td><td align="left" valign="middle" rowspan="1" colspan="1">D</td><td align="left" valign="middle" rowspan="1" colspan="1">Aspartic Acid </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">69</td><td align="left" valign="middle" rowspan="1" colspan="1">E</td><td align="left" valign="middle" rowspan="1" colspan="1">Glutamic Acid </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">70</td><td align="left" valign="middle" rowspan="1" colspan="1">F</td><td align="left" valign="middle" rowspan="1" colspan="1">Phenylalanine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">71</td><td align="left" valign="middle" rowspan="1" colspan="1">G</td><td align="left" valign="middle" rowspan="1" colspan="1">Glycine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">72</td><td align="left" valign="middle" rowspan="1" colspan="1">H</td><td align="left" valign="middle" rowspan="1" colspan="1">Histidine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">73</td><td align="left" valign="middle" rowspan="1" colspan="1">I</td><td align="left" valign="middle" rowspan="1" colspan="1">Isoleucine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">74</td><td align="left" valign="middle" rowspan="1" colspan="1">J</td><td align="left" valign="middle" rowspan="1" colspan="1">Leu or Ile </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">75</td><td align="left" valign="middle" rowspan="1" colspan="1">K</td><td align="left" valign="middle" rowspan="1" colspan="1">Lysine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">76</td><td align="left" valign="middle" rowspan="1" colspan="1">L</td><td align="left" valign="middle" rowspan="1" colspan="1">Leucine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">77</td><td align="left" valign="middle" rowspan="1" colspan="1">M</td><td align="left" valign="middle" rowspan="1" colspan="1">Methionine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">78</td><td align="left" valign="middle" rowspan="1" colspan="1">N</td><td align="left" valign="middle" rowspan="1" colspan="1">Asparagine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">79</td><td align="left" valign="middle" rowspan="1" colspan="1">O</td><td align="left" valign="middle" rowspan="1" colspan="1">Pyrrolysine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">80</td><td align="left" valign="middle" rowspan="1" colspan="1">P</td><td align="left" valign="middle" rowspan="1" colspan="1">Proline </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">81</td><td align="left" valign="middle" rowspan="1" colspan="1">Q</td><td align="left" valign="middle" rowspan="1" colspan="1">Glutamine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">82</td><td align="left" valign="middle" rowspan="1" colspan="1">R</td><td align="left" valign="middle" rowspan="1" colspan="1">Arginine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">83</td><td align="left" valign="middle" rowspan="1" colspan="1">S</td><td align="left" valign="middle" rowspan="1" colspan="1">Serine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">84</td><td align="left" valign="middle" rowspan="1" colspan="1">T</td><td align="left" valign="middle" rowspan="1" colspan="1">Threoine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">85</td><td align="left" valign="middle" rowspan="1" colspan="1">U</td><td align="left" valign="middle" rowspan="1" colspan="1">Selenocysteine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">86</td><td align="left" valign="middle" rowspan="1" colspan="1">V</td><td align="left" valign="middle" rowspan="1" colspan="1">Valine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">87</td><td align="left" valign="middle" rowspan="1" colspan="1">W</td><td align="left" valign="middle" rowspan="1" colspan="1">Tryptophan </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">88</td><td align="left" valign="middle" rowspan="1" colspan="1">X</td><td align="left" valign="middle" rowspan="1" colspan="1">Undetermined or atypical </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">89</td><td align="left" valign="middle" rowspan="1" colspan="1">Y</td><td align="left" valign="middle" rowspan="1" colspan="1">Tyrosine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">90</td><td align="left" valign="middle" rowspan="1" colspan="1">Z</td><td align="left" valign="middle" rowspan="1" colspan="1">Glu or Gln </td></tr></tbody></table></div></div><div class="sec" id="ch_datamod.NCBIstdaa_A_Simple_S"><h5><span class="title">NCBIstdaa: A Simple Sequential Code for Amino Acids</span></h5><p>It is often very useful to separate the external symbol for a residue from its internal representation as a data value. For amino acids NCBI has devised a simple continuous set of values that encompasses the set of "standard" amino acids also represented by the NCBIeaa code above. A continuous set of values means that compact arrays can be used in computer software to look up attributes for residues simply and easily by using the value as an index into the array. The only significance of any particular mapping of a value to an amino acid is that zero is used for gap and the official IUPAC amino acids come first in the list. In general, we recommend the use of this encoding for standard amino acid sequences.</p><p>In the NCBI C++ implementation, the values are stored one value per byte.</p><p><b>NCBIstdaa</b></p><div class="table" id="ch_datamod.T8"><table><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1"><b>Value</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Symbol</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Name</b></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1">-</td><td align="left" valign="middle" rowspan="1" colspan="1">Gap </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">A</td><td align="left" valign="middle" rowspan="1" colspan="1">Alanine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">B</td><td align="left" valign="middle" rowspan="1" colspan="1">Asp or Asn </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">C</td><td align="left" valign="middle" rowspan="1" colspan="1">Cysteine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">4</td><td align="left" valign="middle" rowspan="1" colspan="1">D</td><td align="left" valign="middle" rowspan="1" colspan="1">Aspartic Acid </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">5</td><td align="left" valign="middle" rowspan="1" colspan="1">E</td><td align="left" valign="middle" rowspan="1" colspan="1">Glutamic Acid </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">F</td><td align="left" valign="middle" rowspan="1" colspan="1">Phenylalanine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">7</td><td align="left" valign="middle" rowspan="1" colspan="1">G</td><td align="left" valign="middle" rowspan="1" colspan="1">Glycine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">8</td><td align="left" valign="middle" rowspan="1" colspan="1">H</td><td align="left" valign="middle" rowspan="1" colspan="1">Histidine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">9</td><td align="left" valign="middle" rowspan="1" colspan="1">I</td><td align="left" valign="middle" rowspan="1" colspan="1">Isoleucine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">10</td><td align="left" valign="middle" rowspan="1" colspan="1">K</td><td align="left" valign="middle" rowspan="1" colspan="1">Lysine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">11</td><td align="left" valign="middle" rowspan="1" colspan="1">L</td><td align="left" valign="middle" rowspan="1" colspan="1">Leucine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">M</td><td align="left" valign="middle" rowspan="1" colspan="1">Methionine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">13</td><td align="left" valign="middle" rowspan="1" colspan="1">N</td><td align="left" valign="middle" rowspan="1" colspan="1">Asparagine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">14</td><td align="left" valign="middle" rowspan="1" colspan="1">P</td><td align="left" valign="middle" rowspan="1" colspan="1">Proline </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">15</td><td align="left" valign="middle" rowspan="1" colspan="1">Q</td><td align="left" valign="middle" rowspan="1" colspan="1">Glutamine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">16</td><td align="left" valign="middle" rowspan="1" colspan="1">R</td><td align="left" valign="middle" rowspan="1" colspan="1">Arginine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">17</td><td align="left" valign="middle" rowspan="1" colspan="1">S</td><td align="left" valign="middle" rowspan="1" colspan="1">Serine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">18</td><td align="left" valign="middle" rowspan="1" colspan="1">T</td><td align="left" valign="middle" rowspan="1" colspan="1">Threoine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">19</td><td align="left" valign="middle" rowspan="1" colspan="1">V</td><td align="left" valign="middle" rowspan="1" colspan="1">Valine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">20</td><td align="left" valign="middle" rowspan="1" colspan="1">W</td><td align="left" valign="middle" rowspan="1" colspan="1">Tryptophan </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">21</td><td align="left" valign="middle" rowspan="1" colspan="1">X</td><td align="left" valign="middle" rowspan="1" colspan="1">Undetermined or atypical </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">22</td><td align="left" valign="middle" rowspan="1" colspan="1">Y</td><td align="left" valign="middle" rowspan="1" colspan="1">Tyrosine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">23</td><td align="left" valign="middle" rowspan="1" colspan="1">Z</td><td align="left" valign="middle" rowspan="1" colspan="1">Glu or Gln </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">24</td><td align="left" valign="middle" rowspan="1" colspan="1">U</td><td align="left" valign="middle" rowspan="1" colspan="1">Selenocysteine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">25</td><td align="left" valign="middle" rowspan="1" colspan="1">*</td><td align="left" valign="middle" rowspan="1" colspan="1">Termination </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">26</td><td align="left" valign="middle" rowspan="1" colspan="1">O</td><td align="left" valign="middle" rowspan="1" colspan="1">Pyrrolysine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">27</td><td align="left" valign="middle" rowspan="1" colspan="1">J</td><td align="left" valign="middle" rowspan="1" colspan="1">Leu or Ile </td></tr></tbody></table></div></div><div class="sec" id="ch_datamod.NCBI8aa_An_Encoding_"><h5><span class="title">NCBI8aa: An Encoding for Modified Amino Acids</span></h5><p>Post-translational modifications can introduce a number of non-standard or modified amino acids into biological molecules. The NCBI8aa code will be used to represent up to 250 possible amino acids by using the remaining coding space in the NCBIstdaa code. That is, for the first 26 values, NCBI8aa will be identical to NCBIstdaa. The remaining 224 values will be used for the most commonly encountered modified amino acids. Only the first 250 values will be used to signify amino acids, leaving values in the range of 250-255 to be used for software control codes. Obviously there are a very large number of possible modified amino acids, especially if one takes protein engineering into account. However, the intent here is to only represent commonly found biological forms. This encoding is not yet available since decisions about what amino acids to include not all have been made yet.</p></div><div class="sec" id="ch_datamod.NCBIpaa_A_Profile_St"><h5><span class="title">NCBIpaa: A Profile Style Encoding for Amino Acids</span></h5><p>The NCBIpaa encoding is designed to accommodate a frequency profile describing a protein motif or family in a form which is consistent with the sequences in a Bioseq. Each position in the sequence is defined by 30 values. Each of the 30 values represents the probability that a particular amino acid (or gap, termination, etc.) will occur at that position. One can consider each set of 30 values an array. The amino acid for each cell of the 30 value array corresponds to the NCBIstdaa index scheme. This means that currently only the first 26 array elements will ever have a meaningful value. The remaining 4 cells are available for possible future additions to NCBIstdaa. Each cell represents the probability that the amino acid defined by the NCBIstdaa index to that cell will appear at that position in the motif or protein. The probability is encoded as an 8-bit value from 0-255 corresponding to a probability from 0.0 to 1.0 by interpolation.</p><p>This type of encoding would presumably never appear except in a Bioseq of type "consensus". In the C++ implementation these amino acids are encoded at 30 bytes per amino acid in a simple linear order. That is, the first 30 bytes are the first amino acid, the second 30 the next amino acid, and so on.</p></div><div class="sec" id="ch_datamod.IUPACna_The_IUPACIUB"><h5><span class="title">IUPACna: The IUPAC-IUB Encoding for Nucleic Acids</span></h5><p>Like the IUPACaa codes the IUPACna codes are single letters for nucleic acids and the value is the same as the ASCII value of the recommended IUPAC letter. The IUPAC recommendations for nucleic acid codes also include letters to represent all possible ambiguities at a single position in the sequence except a gap. To make the values non-redundant, U is considered the same as T. Whether a sequence actually contains U or T is easily determined from Seq-inst.mol. Since some software tools are designed to work directly on the ASCII representation of the IUPAC letters, this representation is provided. Note that the ASCII values correspond to the UPPER CASE letters. Using values corresponding to lower case letters in Seq-data is an error. For display to a user, any readable case or font is appropriate.</p><p>The C++ implementation encodes one value for a nucleic acid residue per byte.</p><p><b>IUPACna</b></p><div class="table" id="ch_datamod.T10"><table><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1"><b>Value</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Symbol</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Name</b></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">65</td><td align="left" valign="middle" rowspan="1" colspan="1">A</td><td align="left" valign="middle" rowspan="1" colspan="1">Adenine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">66</td><td align="left" valign="middle" rowspan="1" colspan="1">B</td><td align="left" valign="middle" rowspan="1" colspan="1">G or T or C </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">67</td><td align="left" valign="middle" rowspan="1" colspan="1">C</td><td align="left" valign="middle" rowspan="1" colspan="1">Cytosine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">68</td><td align="left" valign="middle" rowspan="1" colspan="1">D</td><td align="left" valign="middle" rowspan="1" colspan="1">G or A or T </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">71</td><td align="left" valign="middle" rowspan="1" colspan="1">G</td><td align="left" valign="middle" rowspan="1" colspan="1">Guanine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">72</td><td align="left" valign="middle" rowspan="1" colspan="1">H</td><td align="left" valign="middle" rowspan="1" colspan="1">A or C or T </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">75</td><td align="left" valign="middle" rowspan="1" colspan="1">K</td><td align="left" valign="middle" rowspan="1" colspan="1">G or T </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">77</td><td align="left" valign="middle" rowspan="1" colspan="1">M</td><td align="left" valign="middle" rowspan="1" colspan="1">A or C </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">78</td><td align="left" valign="middle" rowspan="1" colspan="1">N</td><td align="left" valign="middle" rowspan="1" colspan="1">A or G or C or T </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">82</td><td align="left" valign="middle" rowspan="1" colspan="1">R</td><td align="left" valign="middle" rowspan="1" colspan="1">G or A </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">83</td><td align="left" valign="middle" rowspan="1" colspan="1">S</td><td align="left" valign="middle" rowspan="1" colspan="1">G or C </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">84</td><td align="left" valign="middle" rowspan="1" colspan="1">T</td><td align="left" valign="middle" rowspan="1" colspan="1">Thymine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">86</td><td align="left" valign="middle" rowspan="1" colspan="1">V</td><td align="left" valign="middle" rowspan="1" colspan="1">G or C or A </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">87</td><td align="left" valign="middle" rowspan="1" colspan="1">W</td><td align="left" valign="middle" rowspan="1" colspan="1">A or T </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">89</td><td align="left" valign="middle" rowspan="1" colspan="1">Y</td><td align="left" valign="middle" rowspan="1" colspan="1">T or C </td></tr></tbody></table></div></div><div class="sec" id="ch_datamod.NCBI4na_A_Four_Bit_E"><h5><span class="title">NCBI4na: A Four Bit Encoding of Nucleic Acids</span></h5><p>It is possible to represent the same set of nucleic acid and ambiguities with a four bit code, where one bit corresponds to each possible base and where more than one bit is set to represent ambiguity. The particular encoding used for NCBI4na is the same as that used on the GenBank Floppy Disk Format. A four bit encoding has several advantages over the direct mapping of the ASCII IUPAC codes. One can represent "no base" as 0000. One can match various ambiguous or unambiguous bases by a simple AND. For example, in NCBI4na 0001=A, 0010=C, 0100=G, 1000=T/U. Adenine (0001) then matches Purine (0101) by the AND method. Finally, it is possible to store the sequence in half the space by storing two bases per byte. This is done both in the ASN.1 encoding and in the NCBI C++ software implementation. Utility functions (see the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeqportUtil.html">CSeqportUtil</a> class) allow the developer to ignore the complexities of storage while taking advantage of the greater packing. Since nucleic acid sequences can be very long, this is a real savings.</p><p><b>NCBI4na</b></p><div class="table" id="ch_datamod.T11"><table><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1"><b>Value</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Symbol</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Name</b></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1">-</td><td align="left" valign="middle" rowspan="1" colspan="1">Gap</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">A</td><td align="left" valign="middle" rowspan="1" colspan="1">Adenine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">C</td><td align="left" valign="middle" rowspan="1" colspan="1">Cytosine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">M</td><td align="left" valign="middle" rowspan="1" colspan="1">A or C </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">4</td><td align="left" valign="middle" rowspan="1" colspan="1">G</td><td align="left" valign="middle" rowspan="1" colspan="1">Guanine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">5</td><td align="left" valign="middle" rowspan="1" colspan="1">R</td><td align="left" valign="middle" rowspan="1" colspan="1">G or A </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">S</td><td align="left" valign="middle" rowspan="1" colspan="1">G or C </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">7</td><td align="left" valign="middle" rowspan="1" colspan="1">V</td><td align="left" valign="middle" rowspan="1" colspan="1">G or C or A </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">8</td><td align="left" valign="middle" rowspan="1" colspan="1">T</td><td align="left" valign="middle" rowspan="1" colspan="1">Thymine/Uracil </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">9</td><td align="left" valign="middle" rowspan="1" colspan="1">W</td><td align="left" valign="middle" rowspan="1" colspan="1">A or T </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">10</td><td align="left" valign="middle" rowspan="1" colspan="1">Y</td><td align="left" valign="middle" rowspan="1" colspan="1">T or C </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">11</td><td align="left" valign="middle" rowspan="1" colspan="1">H</td><td align="left" valign="middle" rowspan="1" colspan="1">A or C or T </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">K</td><td align="left" valign="middle" rowspan="1" colspan="1">G or T </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">13</td><td align="left" valign="middle" rowspan="1" colspan="1">D</td><td align="left" valign="middle" rowspan="1" colspan="1">G or A or T </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">14</td><td align="left" valign="middle" rowspan="1" colspan="1">B</td><td align="left" valign="middle" rowspan="1" colspan="1">G or T or C </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">15</td><td align="left" valign="middle" rowspan="1" colspan="1">N</td><td align="left" valign="middle" rowspan="1" colspan="1">A or G or C or T </td></tr></tbody></table></div></div><div class="sec" id="ch_datamod.NCBI2na_A_Two_Bit_En"><h5><span class="title">NCBI2na: A Two Bit Encoding for Nucleic Acids</span></h5><p>If no ambiguous bases are present in a nucleic acid sequence it can be completely encoded using only two bits per base. This allows encoding into ASN.1 or storage in the NCBI C++ implementation with a four fold savings in space. As with the four bit packing, the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/ident?i=CSeqportUtil">CSeqportUtil</a> class allows the programmer to ignore the complexities introduced by the packing. The two bit encoding selected is the same as that proposed for the GenBank CDROM.</p><p><b>NCBI2na</b></p><div class="table" id="ch_datamod.T12"><table><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1"><b>Value</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Symbol</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Name</b></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1">A</td><td align="left" valign="middle" rowspan="1" colspan="1">Adenine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">C</td><td align="left" valign="middle" rowspan="1" colspan="1">Cytosine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">G</td><td align="left" valign="middle" rowspan="1" colspan="1">Guanine </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">T</td><td align="left" valign="middle" rowspan="1" colspan="1">Thymine/Uracil </td></tr></tbody></table></div></div><div class="sec" id="ch_datamod.NCBI8na_An_Eight_Bit"><h5><span class="title">NCBI8na: An Eight Bit Sequential Encoding for Modified Nucleic Acids</span></h5><p>The first 16 values of NCBI8na are identical with those of NCBI4na. The remaining possible 234 values will be used for common, biologically occurring modified bases such as those found in tRNAs. This full encoding is still being determined at the time of this writing. Only the first 250 values will be used, leaving values in the range of 250-255 to be used as control codes in software.</p></div><div class="sec" id="ch_datamod.NCBIpna_A_Frequency_"><h5><span class="title">NCBIpna: A Frequency Profile Encoding for Nucleic Acids</span></h5><p>Frequency profiles have been used to describe motifs and signals in nucleic acids. This can be encoded by using five bytes per sequence position. The first four bytes are used to express the probability that particular bases occur at that position, in the order A, C, G, T as in the NCBI2na encoding. The fifth position encodes the probability that a base occurs there at all. Each byte has a value from 0-255 corresponding to a probability from 0.0-1.0.</p><p>The sequence is encoded as a simple linear sequence of bytes where the first five bytes code for the first position, the next five for the second position, and so on. Typically the NCBIpna notation would only be found on a Bioseq of type consensus. However, one can imagine other uses for such an encoding, for example to represent knowledge about low resolution sequence data in an easily computable form.</p></div></div><div class="sec" id="ch_datamod.Tables_of_Sequence_C"><h4><span class="title">Tables of Sequence Codes</span></h4><p>Various sequence alphabets can be stored in tables of type Seq-code-table, defined in <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/seqcode/seqcode.asn">seqcode.asn</a>. An enumerated type, Seq-code-type is used as a key to each table. Each code can be thought of as a square table essentially like those presented above in describing each alphabet. Each "residue" of the code has a numerical one-byte value used to represent that residue both in ASN.1 data and in internal C++ structures. The information necessary to display the value is given by the "symbol". A symbol can be in a one-letter series (e.g. A,G,C,T) or more than one letter (e.g. Met, Leu, etc.). The symbol gives a human readable representation that corresponds to each numerical residue value. A name, or explanatory string, is also associated with each.</p><p>So, the NCBI2na code above would be coded into a Seq-code-table very simply as:</p><pre>{ -- NCBI2na<br />    code ncbi2na ,<br />    num 4 , -- continuous 0-3<br />    one-letter TRUE , -- all one letter codes<br />    table {<br />        { symbol "A", name "Adenine" },<br />        { symbol "C", name "Cytosine" },<br />        { symbol "G", name "Guanine" },<br />        { symbol "T", name "Thymine/Uracil"}<br />    } , -- end of table <br />    comps { -- complements<br />        3,<br />        2,<br />        1,<br />        0<br />    }<br />} ,</pre><p>The table has 4 rows (with values 0-3) with one letter symbols. If we wished to represent a code with values which do not start at 0 (such as the IUPAC codes) then we would set the OPTIONAL "start-at" element to the value for the first row in the table.</p><p>In the case of nucleic acid codes, the Seq-code-table also has rows for indexes to complement the values represented in the table. In the example above, the complement of 0 ("A") is 3 ("T").</p></div><div class="sec" id="ch_datamod.Mapping_Between_Diff"><h4><span class="title">Mapping Between Different Sequence Alphabets</span></h4><p>A Seq-map-table provides a mapping from the values of one alphabet to the values of another, very like the way complements are mapped above. A Seq-map-table has two Seq-code-types, one giving the alphabet to map from and the other the alphabet to map to. The Seq-map-table has the same number of rows and the same "start-at" value as the Seq-code-table for the alphabet it maps FROM. This makes the mapping a simple array lookup using the value of a residue of the FROM alphabet and subtracting "start-at". Remember that alphabets are not created equal and mapping from a bigger alphabet to a smaller may result in loss of information.</p></div><div class="sec" id="ch_datamod.Pubdesc_Publication_"><h4><span class="title">Pubdesc: Publication Describing a Bioseq</span></h4><p>A Pubdesc is a data structure used to record how a particular publication described a Bioseq. It contains the citation itself as a Pub-equiv (see the <a href="ch_datamod.html#ch_datamod.datamodel.biblio">Bibliographic References</a> chapter) so that equivalent forms of the citation (e.g. a MEDLINE uid and a Cit-Art) can all be accommodated in a single data structure. Then a number of additional fields allow a more complete description of what was presented in the publication. These extra fields are generally only filled in for entries produced by the NCBI journal scanning component of GenBank, also known as the Backbone database. This information is not generally available in data from any other database yet.</p><p>Pubdesc.name is the name given the sequence in the publication, usually in the figure. Pubdesc.fig gives the figure the Bioseq appeared in so a scientist can locate it in the paper. Pubdesc.num preserves the numbering system used by the author (see Numbering below). Pubdesc.numexc, if TRUE, indicates that a "numbering exception" was found (i.e. the author's numbering did not agree with the number of residues in the sequence). This usually indicates an error in the preparation of the figure. If Pubdesc.poly-a is TRUE, then a poly-A tract was indicated for the Bioseq in the figure, but was not explicitly preserved in the sequence itself (e.g. ...AGAATTTCT (Poly-A) ). Pubdesc.maploc is the map location for this sequence as given by the author in this paper. Pubdesc.seq-raw allows the presentation of the sequence exactly as typed from the figure. This is never used now. Pubdesc.align-group, if present, indicates the Bioseq was presented in a group aligned with other Bioseqs. The align-group value is an arbitrary integer. Other Bioseqs from the same publication which are part of the same alignment will have the same align-group number.</p><p>Pubdesc.comment is simply a free text comment associated with this publication. SWISSPROT entries may also have this field filled.</p></div><div class="sec" id="ch_datamod.Numbering_Applying_a"><h4><span class="title">Numbering: Applying a Numbering System to a Bioseq</span></h4><p>Internally, locations on Bioseqs are ALWAYS integer offsets in the range 0 to (length - 1). However, it is often helpful to display some other numbering system. The Numbering data structure supports a variety of numbering styles and conventions. In the ASN.1 specification, it is simply a CHOICE of the four possible types. When a Numbering object is supplied as a Seq-descr, then it applies to the complete length of the Bioseq. A Numbering object can also be a feature, in which case it only applies to the interval defined by the feature's location.</p><div class="sec" id="ch_datamod.Numcont_A_Continuous"><h5><span class="title">Num-cont: A Continuous Integer Numbering System</span></h5><p>The most widely used numbering system for sequences is some form of a continuous integer numbering. Num-cont.refnum is the number to assign to the first residue in the Bioseq. If Num-cont.has-zero is TRUE, the numbering system uses zero. When biologists start numbering with a negative number, it is quite common for them to skip zero, going directly from -1 to +1, so the DEFAULT for has-zero is FALSE. This only reflects common usage, not any recommendation in terms of convention. Any useful software tool should support both conventions, since they are both used in the literature. Finally, the most common numbering systems are ascending; however descending numbering systems are encountered from time to time, so Num-cont.ascending would then be set to FALSE.</p></div><div class="sec" id="ch_datamod.Numreal_A_Real_Numbe"><h5><span class="title">Num-real: A Real Number Numbering Scheme</span></h5><p>Genetic maps may use real numbers as "map units" since they treat the chromosome as a continuous coordinate system, instead of a discrete, integer coordinate system of base pairs. Thus a Bioseq of type "map" which may use an underlying integer coordinate system from 0 to 5 million may be best presented to the user in the familiar 0.0 to 100.0 map units. Num-real supports a simple linear equation specifying the relationship:</p><p>map units = ( Num-real.a * base_pair_position) + Num-real.b</p><p>in this example. Since such numbering systems generally have their own units (e.g. "map units", "centisomes", "centimorgans", etc), Num-real.units provides a string for labeling the display.</p></div><div class="sec" id="ch_datamod.Numenum_An_Enumerate"><h5><span class="title">Num-enum: An Enumerated Numbering Scheme</span></h5><p>Occasionally biologists do not use a continuous numbering system at all. Crystallographers and immunologists, for example, who do extensive studies on one or a few sequences, may name the individual residues in the sequence as they fit them into a theoretical framework. So one might see residues numbered ... "10" "11" "12" "12A" "12B" "12C" "13" "14" ... To accommodate this sort of scheme the "name" of each residue must be explicitly given by a string, since there is no anticipating any convention that may be used. The Num-enum.num gives the number of residue names (which should agree with the number of residues in the Bioseq, in the case of use as a Seq-descr), followed by the names as strings.</p></div><div class="sec" id="ch_datamod.Numref_Numbering_by_"><h5><span class="title">Num-ref: Numbering by Reference to Another Bioseq</span></h5><p>Two types of references are allowed. The "sources" references are meant to apply the numbering system of constituent Bioseqs to a segmented Bioseq. This is useful for seeing the mapping from the parts to the whole.</p><p>The "aligns" reference requires that the Num-ref-aligns alignment be filled in with an alignment of the target Bioseq with one or more pieces of other Bioseqs. The numbering will come from the aligned pieces.</p></div><div class="sec" id="ch_datamod.Numbering_C_Class"><h5><span class="title">Numbering: C++ Class</span></h5><p>A Numbering object is implemented by the C++ class <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCNumbering.html">CNumbering</a>. The choice of numbering type is represented by the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCNumbering__Base.html#431389cd64d215c294e8f46f416372e0">E_Choice</a> enumeration. The class contains methods for getting and setting the various types of numbering.</p></div></div></div></div><div class="sec" id="ch_datamod.datamodel.seqset"><h2><span class="title">Collections of Sequences</span></h2><p>This section describes the types used to organize multiple Bioseqs into tree structures. The types are located in the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/seqset/seqset.asn">seqset.asn</a> module.</p><div class="sec" id="ch_datamod.datamodel.cpp.seqset"><h3><span class="title">C++ Implementation Notes</span></h3><ul><li><p><a href="ch_datamod.html#ch_datamod._Introduction_5">Introduction</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Seqentry_The_Sequenc">Seq-entry: The Sequence Entry</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Bioseqset_A_Set_Of_S">Bioseq-set: A Set Of Seq-entry's</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Bioseqsets_are_Conve">Bioseq-sets are Convenient Packages</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_s_7">ASN.1 Specification: seqset.asn</a></p></li></ul><div class="sec" id="ch_datamod._Introduction_5"><h4><span class="title">Introduction</span></h4><p>A biological sequence is often most appropriately stored in the context of other, related sequences. Such a collection might have a biological basis (e.g. a nucleic acid and its translated proteins, or the chains of an enzyme complex) or some other basis (e.g. a release of GenBank, or the sequences published in an article). The Bioseq-set provides a framework for collections of sequences.</p></div><div class="sec" id="ch_datamod.Seqentry_The_Sequenc"><h4><span class="title">Seq-entry: The Sequence Entry</span></h4><p>Sometimes a sequence is not part of a collection (e.g. a single annotated protein). Thus a sequence entry could be either a single Bioseq or a collection of them. A Seq-entry is an entity which represents this choice. A great deal of NCBI software is designed to accept a Seq-entry as the primary unit of data. This is the most powerful and flexible object to use as a target software development in general.</p><p>Some of the important methods for <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeq__entry.html">CSeq_entry</a> are:</p><ul><li><p><span class="nctnt ncbi-func">GetLabel()</span> - append a label based on type or content of the current Seq-entry</p></li><li><p><span class="nctnt ncbi-func">GetParentEntry()</span> - gets the parent of the current Seq-entry</p></li><li><p><span class="nctnt ncbi-func">Parentize()</span> - recursive update of parent Seq-entries</p></li></ul></div><div class="sec" id="ch_datamod.Bioseqset_A_Set_Of_S"><h4><span class="title">Bioseq-set: A Set Of Seq-entry's</span></h4><p>A Bioseq-set contains a convenient collection of Seq-entry's. It can have descriptors and annotations just like a single Bioseq (see <a href="ch_datamod.html#ch_datamod._Biological_Sequences">Biological Sequences</a>). It can have identifiers for the set, although these are less thoroughly controlled than Seq-ids at this time. Since the "heart" of a Bioseq-set is a collection of Seq-entry's, which themselves are either a Bioseq or a Bioseq-set, a Bioseq-set can recursively contain other sets. This recursive property makes for a very rich data structure, and a necessary one for biological sequence data, but presents new challenges for software to manipulate and display it. We will discuss some guidelines for building and using Bioseq-sets below, based on the NCBI experience to date.</p><p>Some of the important methods for <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCBioseq__set.html">CBioseq_set</a> are:</p><ul><li><p><span class="nctnt ncbi-func">GetLabel()</span> - append a label based on type or content of <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCBioseq__set.html">CBioseq_set</a></p></li><li><p><span class="nctnt ncbi-func">GetParentSet()</span> - gets the parent of the current <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCBioseq__set.html">CBioseq_set</a></p></li></ul><div class="sec" id="ch_datamod.id_local_identifier_"><h5><span class="title">id: local identifier for this set</span></h5><p>The id field just contains an integer or string to identify this set for internal use by a software system or database. This is useful for building collections of sequences for temporary use, but still be able to cite them.</p></div><div class="sec" id="ch_datamod.coll_global_identifi"><h5><span class="title">coll: global identifier for this set</span></h5><p>The coll field is a Dbtag, which will accept a string to identify a source database and a string or integer as an identifier within that database. This semi-controlled form provides a global identifier for the set of sequences in a simple way.</p></div><div class="sec" id="ch_datamod.level_nesting_level_"><h5><span class="title">level: nesting level of set</span></h5><p>Since Bioseq-sets are recursive, the level integer was conceived as a way of explicitly indicating the nesting level. In practice we have found this to be of little or no use and recommend it be ignored and eventually removed.</p></div><div class="sec" id="ch_datamod.class_classification"><h5><span class="title">class: classification of sets</span></h5><p>The class field is an attempt to classify sets of sequences that may be widely used. There are a number which are just releases of well known databases and others which represent biological groupings.</p><p><b>Bioseq-set classes</b></p><p>The following table summarizes the types of Bioseq-sets:</p><div class="table" id="ch_datamod.T13"><table><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1"><b>Value</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>ASN.1 name</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Explanation</b></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1">not-set</td><td align="left" valign="middle" rowspan="1" colspan="1">not determined </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">nuc-prot</td><td align="left" valign="middle" rowspan="1" colspan="1">a nucleic acid and the proteins from its coding regions </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">segset</td><td align="left" valign="middle" rowspan="1" colspan="1">a segmented Bioseq and the Bioseqs it is made from </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">conset</td><td align="left" valign="middle" rowspan="1" colspan="1">a constructed Bioseq and the Bioseqs it was assembled from </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">4</td><td align="left" valign="middle" rowspan="1" colspan="1">parts</td><td align="left" valign="middle" rowspan="1" colspan="1">a set cotained within a segset or conset holding the Bioseqs which are the components of the segmented or constructed Bioseq </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">5</td><td align="left" valign="middle" rowspan="1" colspan="1">gibb</td><td align="left" valign="middle" rowspan="1" colspan="1">GenInfo Backbone entries (NCBI Journal Scanning Database) </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">gi</td><td align="left" valign="middle" rowspan="1" colspan="1">GenInfo entries (NCBI ID Database) </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">7</td><td align="left" valign="middle" rowspan="1" colspan="1">genbank</td><td align="left" valign="middle" rowspan="1" colspan="1">GenBank entries </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">8</td><td align="left" valign="middle" rowspan="1" colspan="1">pir</td><td align="left" valign="middle" rowspan="1" colspan="1">PIR entries </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">9</td><td align="left" valign="middle" rowspan="1" colspan="1">pub-set</td><td align="left" valign="middle" rowspan="1" colspan="1">all the Seq-entry's from a single publication </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">10</td><td align="left" valign="middle" rowspan="1" colspan="1">equiv</td><td align="left" valign="middle" rowspan="1" colspan="1">a set of equivalent representations of the same sequence (e.g. a genetic map Bioseq and a physical map Bioseq for the same chromosome) </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">11</td><td align="left" valign="middle" rowspan="1" colspan="1">swissprot</td><td align="left" valign="middle" rowspan="1" colspan="1">SWISSPROT entries </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">pdb-entry</td><td align="left" valign="middle" rowspan="1" colspan="1">all the Bioseqs associated with a single PDB structure </td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">255</td><td align="left" valign="middle" rowspan="1" colspan="1">other</td><td align="left" valign="middle" rowspan="1" colspan="1">new type. Usually Bioseq-set.release will have an explanatory string</td></tr></tbody></table></div></div><div class="sec" id="ch_datamod.release_an_explanato"><h5><span class="title">release: an explanatory string</span></h5><p>This is just a free text field which can contain a human readable description of the set. Often used to show which release of GenBank, for example.</p></div><div class="sec" id="ch_datamod.date"><h5><span class="title">date</span></h5><p>This is a date associated with the creation of this set.</p></div><div class="sec" id="ch_datamod.descr_Seqdescr_for_t"><h5><span class="title">descr: Seq-descr for this set</span></h5><p>Just like a Bioseq, a Bioseq-set can have Seq-descr (see <a href="ch_datamod.html#ch_datamod._Biological_Sequences">Biological Sequences</a>) which set it in a biological or bibliographic context, or confer a title or a name. The rule for descriptors at the set level is that they apply to "all of everything below". So if an Org-ref is given at the set level, it means that every Bioseq in the set comes from that organism. If this is not true, then Org-ref would not appear on the set, but different Org-refs would occur on lower level members.</p><p>For any Bioseq in arbitrarily deeply nested Bioseq-sets, one should be able to collect all Bioseq-set.descr from all higher level Bioseq-sets that contain the Bioseq, and move them to the Bioseq. If this process introduces any confusion or contradiction, then the set level descriptor has been incorrectly used.</p><p>The only exception to this is the title and name types, which often refer to the set level on which they are placed (a nuc-prot may have the title "Adh gene and ADH protein", while the Bioseqs have the titles "Adh gene" and "ADH protein". The gain in code sharing by using exactly the same Seq-descr for Bioseq or Bioseq-set seemed to outweigh the price of this one exception to the rule.</p><p>To simplify access to elements like this that depend on a set context, a series of BioseqContext() functions are provided in utilities which allow easy access to all relevant descriptors starting with a specific Bioseq and moving up the levels in the set.</p></div><div class="sec" id="ch_datamod.seqset_the_sequences"><h5><span class="title">seq-set: the sequences and sets within the Bioseq-set</span></h5><p>The seq-set field contains a SEQUENCE OF Seq-entry which represent the contents of the Bioseq-set. As mentioned above, these may be nested internally to any level. Although there is no guarantee that members of a set will come in any particular order, NCBI finds the following conventions useful and natural.</p><p>For sets of entries from specific databases, each Seq-entry is the "natural" size of an entry from those databases. Thus GenBank will contain a set of Seq-entry which will be a mixture of Bioseq (just a nucleic acid, no coding regions), seg-set (segmented nucleic acid, no coding regions), or nuc-prot (nucleic acid (as Bioseq or seg-set) and proteins from the translated coding regions). PDB will contain a mixture of Bioseq (single chain structures) or pdb-entry (multi-chain structures).</p><p>A segset, representing a segmented sequence combines the segmented Bioseq with the set of the Bioseqs that make it up.</p><pre>segset (Bioseq-set) contains<br />    segmented sequence (Bioseq)<br />    parts (Bioseq-set) contains<br />        first piece (Bioseq)<br />        second piece (Bioseq<br />        etc</pre><p>A consset has the same layout as a segset, except the top level Bioseq is constructured rather than segmented.</p><p>A nuc-prot set gives the nucleic acid and its protein products at the same levels.</p><pre>nuc-prot (Bioseq-set) contains<br />    nucleic acid (Bioseq)<br />    protein1 (Bioseq)<br />    protein2 (Bioseq)<br />    etc.</pre><p>A nuc-prot set where the nucleic acid is segmented simply replaces the nucleic acid Bioseq with a seg-set.</p><pre>nuc-prot (Bioseq-set) contains<br />    nucleic acid segset (Bioseq-set) contains<br />        segmented sequence (Bioseq)<br />        parts (Bioseq-set) contains<br />            first piece (Bioseq)<br />            second piece (Bioseq<br />            etc<br />    protein1 (Bioseq)<br />    protein2 (Bioseq)<br />    etc.</pre></div><div class="sec" id="ch_datamod.annot_Seqannots_for_"><h5><span class="title">annot: Seq-annots for the set</span></h5><p>A Bioseq-set can have Seq-annots just like a Bioseq can. Because all forms of Seq-annot use explicit ids for the Bioseqs they reference, there is no dependence on context. Any Seq-annot can appear at any level of nesting in the set (or even stand alone) without any loss of information.</p><p>However, as a convention, NCBI puts the Seq-annot at the nesting level of the set that contains all the Bioseqs referenced by it, if possible. So if a feature applies just to one Bioseq, it goes in the Bioseq.annot itself. If it applies to all the members of a segmented set, it goes in Bioseq-set.annot of the segset. If, like a coding region, it points to both nucleic acid and protein sequences, it goes in the Bioseq-set.annot of the nuc-prot set.</p></div></div><div class="sec" id="ch_datamod.Bioseqsets_are_Conve"><h4><span class="title">Bioseq-sets are Convenient Packages</span></h4><p>Remember that Bioseq-sets are just convenient ways to package Bioseqs and associated annotations. But Bioseqs may appear in various contexts and software should always be prepared to deal with them that way. A segmented Bioseq may not appear as part of a segset and a Bioseq with coding regions may not appear as part of a nuc-prot set. In both cases the elements making up the segmented Bioseq and the Bioseqs involved in the coding regions all use Seq-locs, which explicit reference Seq-ids. So they are not dependent on context. NCBI packages Bioseqs in sets for convenience, so all the closely related elements can be retrieved together. But this is only a convenience, not a requirement of the specification. The same caveat applies to the ordering conventions within a set, described above.</p></div></div></div><div class="sec" id="ch_datamod.datamodel.seqloc"><h2><span class="title">Sequence Locations and Identifiers</span></h2><p>This section contains documentation for types used to identify Bioseqs and describe locations on them. These types are defined in the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/seqloc/seqloc.asn">seqloc.asn</a> module.</p><div class="sec" id="ch_datamod.datamodel.cpp.seqloc"><h3><span class="title">C++ Implementation Notes</span></h3><ul><li><p><a href="ch_datamod.html#ch_datamod._Introduction_6">Introduction</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._Seqid_Identifying_Se_1">Seq-id: Identifying Sequences</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Seqid_Semantics_of_U">Seq-id: Semantics of Use</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Seqid_The_C_Implemen">Seq-id: The C++ Implementation</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.NCBI_ID_Database_Imp">NCBI ID Database: Imposing Stable Seq-ids</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Seqloc_Locations_on_">Seq-loc: Locations on a Bioseq</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Seqloc_The_C_Impleme">Seq-loc: The C++ Implementation</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_s_8">ASN.1 Specification: seqloc.asn</a></p></li></ul><div class="sec" id="ch_datamod._Introduction_6"><h4><span class="title">Introduction</span></h4><p>As described in the <a href="ch_datamod.html#ch_datamod._Biological_Sequences">Biological Sequences</a> chapter, a Bioseq always has at least one identifier. This means that any valid biological sequence can be referenced by using this identifier. However, all identifiers are not created equal. They may differ in their basic structure (e.g. a GenBank accession number is required to have an uppercase letter followed by exactly five digits while the NCBI GenInfo Id uses a simple integer identifier). They also differ in how they are used (e.g. the sequence identified by the GenBank accession number may change from release to release while the sequence identified by the NCBI GenInfo Id will always be exactly the same sequence).</p><p>Locations of regions on Bioseqs are always given as integer offsets, also described in the <a href="ch_datamod.html#ch_datamod._Biological_Sequences">Biological Sequences</a> chapter. So the first residue is always 0 and the last residue is always (length - 1). Further, since all the classes of Bioseqs from bands on a gel to genetic or physical maps to sequenced DNA use the same integer offset convention, locations always have the same form and meaning even when moving between very different types of Bioseq representations. This allows alignment, comparison, and display functions, among others, to have the same uniform interface and semantics, no matter what the underlying Bioseq class. Specialized numbering systems are supported but only as descriptive annotation (see Numbering in <a href="ch_datamod.html#ch_datamod._Biological_Sequences_1">Biological Sequences</a> and Feature types "seq" and "num" in <a href="ch_datamod.html#ch_datamod.datamodel.seqfeat">Sequence Features</a>). The internal conventions for positions on sequences are always the same.</p><p>There are no implicit Bioseq locations. All locations include a sequence identifier. This means Features, Alignments, and Graphs are always independent of context and can always be exchanged, submitted to databases, or stored as independent objects. The main consequence of this is that information ABOUT regions of Bioseqs can be developed and contributed to the public scientific discussion without any special rights of editing the Bioseq itself needing to be granted to anyone but the original author of the Bioseq. Bioseqs in the public databases, then, no longer need an anointed curator (beyond the original author) to be included in ongoing scientific discussion and data exchange by electronic media.</p><p>In addition to the various sequence location and identifier classes, several convenience functions for comparing or manipulating Na-strands are defined in <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/include/objects/seqloc/Na_strand.hpp">Na_strand.hpp</a>:</p><ul><li><p><span class="nctnt ncbi-func">IsForward()</span></p></li><li><p><span class="nctnt ncbi-func">IsReverse()</span></p></li><li><p><span class="nctnt ncbi-func">Reverse()</span></p></li><li><p><span class="nctnt ncbi-func">SameOrientation()</span></p></li></ul></div><div class="sec" id="ch_datamod._Seqid_Identifying_Se_1"><h4><span class="title">Seq-id: Identifying Sequences</span></h4><p>In a pure sense, a Seq-id is meant to unambiguously identify a Bioseq. Unfortunately, different databases have different semantic rules regarding the stability and ambiguity of their best available identifiers. For this reason a Bioseq can have more than one Seq-id, so that the Seq-id with the best semantics for a particular use can be selected from all that are available for that Bioseq, or so that a new Seq-id with different semantics can be conferred on an existing Bioseq. Further, Seq-id is defined as a CHOICE of datatypes which may differ considerably in their structure and semantics from each other. Again, this is because differing sequence databases use different conventions for identifying sequences and it is important not to lose this critical information from the original data source.</p><p>One Seq-id type, "gi", has been implemented specifically to make a simple, absolutely stable Seq-id available for sequence data derived from any source. It is discussed in detail below.</p><p>A Textseq-id structure is used in many Seq-ids described below. It has four possible fields; a name, an accession number, a release, and a version. Formally, all fields are OPTIONAL, although to be useful, a Textseq-id should have at least a name or an accession or both. This style of Seq-id is used by GenBank, EMBL, DDBJ, PIR, SWISS-PROT, and PRF, but the semantics of its use differ considerably depending on the database. However none of these databases guarantees the stability of name or accession (i.e. that it points at a specific sequence), so to be unambiguous the id must also have the version. See the discussion under <a href="ch_datamod.html#ch_datamod.Seqid_Semantics_of_U">Seq-id: Semantics</a> for details.</p><p>Some important methods of the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeq__id.html">CSeq_id</a> class are:</p><ul><li><p><span class="nctnt ncbi-func">CSeq_id()</span> -- constructors to simplify creation of Seq-ids from primitive types (string, int). Some of these constructors auto-detect the type of the Seq-id from its string representation.</p></li><li><p><span class="nctnt ncbi-func">Compare()</span> -- compare Seq-ids.</p></li><li><p><span class="nctnt ncbi-func">GetTextseq_Id ()</span> -- checks whether the Seq-id subtype is Textseq-id compatible and returns its value.</p></li><li><p><span class="nctnt ncbi-func">IdentifyAccession()</span> -- deduces Seq-id information from a bare accession.</p></li><li><p><span class="nctnt ncbi-func">Match()</span> -- compare Seq-ids.</p></li></ul><p>Some important nonmember template functions are:</p><ul><li><p><span class="nctnt ncbi-func">FindGi()</span> -- returns gi from id list if exists, returns 0 otherwise.</p></li><li><p><span class="nctnt ncbi-func">FindTextseq_id()</span> -- returns text seq-id from id list if exists, returns 0 otherwise.</p></li><li><p><span class="nctnt ncbi-func">GetSeq_idByType()</span> -- search the container of <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCRef.html">CRef</a>&lt;<a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeq__id.html">CSeq_id</a>&gt; for the id of given type.</p></li></ul></div><div class="sec" id="ch_datamod.Seqid_Semantics_of_U"><h4><span class="title">Seq-id: Semantics of Use</span></h4><p>Different databases use their ids in different ways and these patterns may change over time. An attempt is made is this section to describe current usage and offer some guidelines for interpreting Seq-ids.</p><div class="sec" id="ch_datamod.local_Privately_Main"><h5><span class="title">local: Privately Maintained Data</span></h5><p>The local Seq-id is an Object-id (see discussion in <a href="ch_datamod.html#ch_datamod.datamodel.general">General Use Objects</a>), which is a CHOICE of a string or an integer. This is to reconcile the requirement that all Bioseqs have a Seq-id and the needs of local software tools to manipulate data produced or maintained privately. This might be pre-publication data, data still being developed, or proprietary data. The Object-id will accommodate either a string or a number as is appropriate for the local environment. It is the responsibility of local software to keep the local Seq-ids unique. A local Seq-id is not globally unique, so when Bioseqs with such identifiers are published or exchanged, context (i.e. the submitter or owner of the id) must be maintained or a new id class must be applied to the Bioseq (e.g. the assignment of a GenBank accession upon direct data submission to GenBank).</p></div><div class="sec" id="ch_datamod.refseq_From_the_Reference_Seq"><h5><span class="title">refseq: From the Reference Sequence project at the NCBI</span></h5><p>The <a href="http://www.ncbi.nlm.nih.gov/RefSeq/">Reference Sequence project</a> at the NCBI aims to provide a comprehensive, integrated, non-redundant, well-annotated set of sequences, including genomic DNA, transcripts, and proteins. RefSeq assigns accessions (but not a LOCUS) to all entries. RefSeq accessions begin with two letters followed by an underscore, with additional letters after the underscore for some accessions. The leading characters have a distinct meaning as described in the <a href="http://www.ncbi.nlm.nih.gov/projects/RefSeq/key.html#accession">RefSeq accession format reference</a>.</p></div><div class="sec" id="ch_datamod.general_Ids_from_Loc"><h5><span class="title">general: Ids from Local Databases</span></h5><p>The Seq-id type "general" uses a Dbtag (see discussion in <a href="ch_datamod.html#ch_datamod.datamodel.general">General Use Objects</a>), which is an Object-id as in Seq-id.local, above, with an additional string to identify a source database. This means that an integer or string id from a smaller database can create Seq-ids which both cite the database source and make the local Seq-ids globally unique (usually). For example, the EcoSeq database is a collection of E.coli sequences derived from many sources, maintained by Kenn Rudd. Each sequence in EcoSeq has a unique descriptive name which is used as its primary identifier. A "general" Seq-id could be make for the EcoSeq entry "EcoAce" by making the following "general" Seq-id:</p><pre>Seq-id ::= general {<br />        db "EcoSeq" ,<br />        tag str "EcoAce" }</pre></div><div class="sec" id="ch_datamod.gibbsq__gibbmt_GenIn"><h5><span class="title">gibbsq, gibbmt: GenInfo Backbone Ids</span></h5><p>The "gibbsq" and "gibbmt" IDs were formerly used to access the "GenInfo Backbone" database. They are now obsolete.</p></div><div class="sec" id="ch_datamod.genbank__embl__ddbj_"><h5><span class="title">genbank, embl, ddbj: The International Nucleic Acid Sequence Databases</span></h5><p>NCBI (GenBank) in the U.S., the European Molecular Biology Laboratory datalibrary (EMBL) in Europe, and the DNA Database of Japan (DDBJ) in Japan are members of an international collaboration of nucleic acid sequence databases. Each collects data, often directly submitted by authors, and makes releases of its data in its own format independently of each other. However, there are agreements in place for all the parties to exchange information with each other in an attempt to avoid duplication of effort and provide a world wide comprehensive database to their users. So a release by one of these databases is actually a composite of data derived from all three sources.</p><p>All three databases assign a mnemonic name (called a LOCUS name by GenBank and DDBJ, and an entry name by EMBL) which is meant to carry meaning encoded into it. The first few letters indicate the organism and next few a gene product, and so on. There is no concerted attempt to keep an entry name the same from release to release, nor is there any attempt for the same entry to have the same entry name in the three different databases (since they construct entry names using different conventions). While many people are used to referring to entries by name (and thus name is included in a Textseq-id) it is a notoriously unreliable way of identifying a Bioseq and should normally be avoided.</p><p>All three databases also assign an Accession Number to each entry. Accession numbers do not convey meaning, other than in a bookkeeping sense. Unlike names, accession numbers are meant to be same for the same entry, no matter which database one looks in. Thus, accession number is the best id for a Bioseq from this collaboration. Unfortunately rules for the use of accession numbers have not required that an accession number uniquely identify a sequence. A database may change an accession when it merely changes the annotation on an entry. Conversely, a database may not change an accession even though it has changed the sequence itself. There is no consistency about when such events may occur. There is also no exact method of recording the history of an entry in this collaboration, so such accession number shifts make it possible to lose track of entries by outside users of the databases. With all these caveats, accession numbers are still the best identifiers available within this collaboration.</p><p>To compensate for such shifts, it is advisable to supplement accession numbers with version numbers to yield stable, unique identifiers for all three databases.  (Historically, it was likewise possible to supplement them with release fields, but those are no longer in active use and retrieval services will disregard them.)</p></div><div class="sec" id="ch_datamod.pir_PIR_Internationa"><h5><span class="title">pir: PIR International</span></h5><p>The PIR database is also produced through an international collaboration with contributors in the US at the Protein Identification Resource of the National Biomedical Research Foundation (NBRF), in Europe at the Martinsried Institute for Protein Sequences (MIPS), and in Japan at the International Protein Information Database in Japan (JIPID). They also use an entry name and accession number. The PIR accession numbers, however, are not related to the GenBank/EMBL/DDBJ accession numbers in any way and have a very different meaning. In PIR, the entry name identifies the sequence, which is meant to be the "best version" of that protein. The accession numbers are in transition from a meaning more similar to the GenBank/EMBL/DDBJ accessions, to one in which an accession is associated with protein sequences exactly as they appeared in specific publications. Thus, at present, PIR ids may have both an accession and a name, they will move to more typically having either a name or an accession, depending on what is being cited, the "best" sequence or an original published sequence.</p></div><div class="sec" id="ch_datamod.swissprot_SWISSPROT"><h5><span class="title">swissprot: UniProt Knowledgebase</span></h5><p>Originally the Seq-id type "swissprot" referred to the Swiss-Prot database, but now it refers to the UniProtKB database. This change was made after the Swiss-Prot, TrEMBL, and PIR databases were combined to form UniProtKB. The swissprot name is meant to be easily remembered and it codes biological information, but it is not a stable identifier from release to release. The accession, which only conveys bookkeeping information, serves as a relatively stable identifier from release to release, and in conjunction with a version uniquely identifies a UniProtKB entry.</p><p>With the exception of legacy PIR entry names (which the C++ Toolkit cannot recognize when untagged), UniProtKB identifiers are coordinated with those of GenBank, EMBL, and DDBJ and do not conflict.</p></div><div class="sec" id="ch_datamod.prf_Protein_Research"><h5><span class="title">prf: Protein Research Foundation</span></h5><p>The Protein Research Foundation in Japan has a large database of protein sequence and peptide fragments derived from the literature. Again, there is a name and an accession number. Since this database is meant only to record the sequence as it appeared in a particular publication, the relationship between the id and the sequence is quite stable in practice.</p></div><div class="sec" id="ch_datamod.patent_Citing_a_Pate"><h5><span class="title">patent: Citing a Patent</span></h5><p>The minimal information to unambiguously identify a sequence in a patent is first to unambiguously identify the patent (by the Patent-seq-id.cit, see <a href="ch_datamod.html#ch_datamod.datamodel.biblio">Bibliographic References</a> for a discussion of Id-pat) and then providing an integer serial number to identify the sequence within the patent. The sequence data for sequence related patents are now being submitted to the international patent offices in computer readable form, and the serial number for the sequence is assigned by the processing office. However, older sequence related patents were not assigned serial numbers by the processing patent offices. For those sequences the serial number is assigned arbitrarily (but still uniquely). Note that a sequence with a Patent-seq-id just appeared as part of a patent document. It is NOT necessarily what was patented by the patent document.</p></div><div class="sec" id="ch_datamod.pdb_Citing_a_Biopoly"><h5><span class="title">pdb: Citing a Biopolymer Chain from a Structure Database</span></h5><p>The Protein Data Bank (PDB, also known as the Brookhaven Database), is a collection of data about structures of biological entities such hemoglobin or cytochrome c. The basic entry in PDB is a structural model of a molecule, not a sequence as in most sequence databases. A molecule may have multiple chains. So a PDB-seq-id has a string for the PDB entry name (called PDB-mol-id here) and a single character for a chain identifier within the molecule. The use of the single character just maps the PDB practice. The character may be a digit, a letter, or even a space (ASCII 32). As with the databases using the Textseq-id, the sequence of the chain in PDB associated with this information is not stable, so to be unambiguous the id must also include the release date.</p></div><div class="sec" id="ch_datamod.giim_GenInfo_Import_"><h5><span class="title">giim: GenInfo Import Id</span></h5><p>A Giimport-id ("giim") was a temporary id used to identify sequences imported into the GenInfo system at NCBI before long term identifiers, such as "gi", became stable. It is now obsolete.</p></div><div class="sec" id="ch_datamod.gi_A_Stable__Uniform"><h5><span class="title">gi: A Stable, Uniform Id Applied to Sequences From All Sources</span></h5><p>A Seq-id of type "gi" is a simple integer assigned to a sequence by the NCBI "ID" database. It can be applied to a Bioseq of any representation class, nucleic acid or protein. It uniquely identifies a sequence from a particular source. If the sequence changes at all, then a new "gi" is assigned. The "gi" does not change if only annotations are changed. Thus the "gi" provides a simple, uniform way of identifying a stable coordinate system on a Bioseq provided by data sources which themselves may not have stable ids. This is the identifier of choice for all references to Bioseqs through features or alignments. See discussion below.</p></div></div><div class="sec" id="ch_datamod.Seqid_The_C_Implemen"><h4><span class="title">Seq-id: The C++ Implementation</span></h4><p>A Seq-id is implemented in C++ as a choice, summarized in the following table:</p><p><b>Seq-id</b></p><div class="table" id="ch_datamod.T14"><table><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1"><b>Value</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Enum name</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Description</b></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1">e_not_set </td><td align="left" valign="middle" rowspan="1" colspan="1">no variant selected</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Local </td><td align="left" valign="middle" rowspan="1" colspan="1">local use</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Gibbsq </td><td align="left" valign="middle" rowspan="1" colspan="1">GenInfo back-bone seq id</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Gibbmt </td><td align="left" valign="middle" rowspan="1" colspan="1">GenInfo back-bone molecule</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">4</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Giim </td><td align="left" valign="middle" rowspan="1" colspan="1">GenInfo import id</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">5</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Genbank </td><td align="left" valign="middle" rowspan="1" colspan="1">genbank</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Embl </td><td align="left" valign="middle" rowspan="1" colspan="1">embl</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">7</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Pir </td><td align="left" valign="middle" rowspan="1" colspan="1">pir</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">8</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Swissprot </td><td align="left" valign="middle" rowspan="1" colspan="1">swissprot</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">9</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Patent </td><td align="left" valign="middle" rowspan="1" colspan="1">patent</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">10</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Other </td><td align="left" valign="middle" rowspan="1" colspan="1">for historical reasons, 'other' = 'refseq'</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">11</td><td align="left" valign="middle" rowspan="1" colspan="1">e_General </td><td align="left" valign="middle" rowspan="1" colspan="1">general - for other databases</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">12</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Gi </td><td align="left" valign="middle" rowspan="1" colspan="1">GenInfo integrated database</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">13</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Ddbj </td><td align="left" valign="middle" rowspan="1" colspan="1">DDBJ</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">14</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Prf </td><td align="left" valign="middle" rowspan="1" colspan="1">PRF SEQDB</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">15</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Pdb </td><td align="left" valign="middle" rowspan="1" colspan="1">PDB sequence</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">16</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Tpg</td><td align="left" valign="middle" rowspan="1" colspan="1">3<sup>rd</sup> party annot/seq Genbank</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">17</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Tpeq</td><td align="left" valign="middle" rowspan="1" colspan="1">3<sup>rd</sup> party annot/seq EMBL</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">18</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Tpd</td><td align="left" valign="middle" rowspan="1" colspan="1">3<sup>rd</sup> party annot/seq DDBJ</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">19</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Gpipe</td><td align="left" valign="middle" rowspan="1" colspan="1">Internal NCBI genome pipeline processing id</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">20</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Named_annot_track</td><td align="left" valign="middle" rowspan="1" colspan="1">Internal named annotation tracking id</td></tr></tbody></table></div><p>A large number of additional functions for manipulating SeqIds are described in the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/include/objmgr/util/sequence.hpp">Sequence Utilities</a> chapter.</p></div><div class="sec" id="ch_datamod.NCBI_ID_Database_Imp"><h4><span class="title">NCBI ID Database: Imposing Stable Seq-ids</span></h4><p>As described in the <a href="ch_datamod.html#ch_datamod.datamodel.data_model">Data Model</a> section, Bioseqs provide a simple integer coordinate system through which a host of different data and analytical results can be easily associated with each other, even with scientists working independently of each other and on heterogeneous systems. For this model to work, however, requires stable identifiers for these integer coordinate systems. If one scientist notes a coding region from positions 10-50 of sequence "A", then the database adds a single base pair at position 5 of "A" without changing the identifier of "A", then at the next release of the database the scientist's coding region is now frame-shifted one position and invalid. Unfortunately this is currently the case due to the casual use of sequence identifiers by most existing databases.</p><p>Since NCBI integrates data from many different databases which follow their own directions, we must impose stable ids on an unstable starting material. While a daunting task, it is not, in the main, impossible. We have built a database called "ID", whose sole task is to assign and track stable sequence ids. ID assigns "gi" numbers, simple arbitrary integers which stably identify a particular sequence coordinate system.</p><p>The first time ID "sees" a Bioseq, say EMBL accession A00000, it checks to see if it has a Bioseq from EMBL with this accession already. If not, it assigns a new GI, say 5, to the entry and adds it to the Bioseq.id chain (the original EMBL id is not lost). It also replaces all references in the entry (say in the feature table) to EMBL A00000 to GI 5. This makes the annotations now apply to a stable coordinate system.</p><p>Now EMBL sends an update of the entry which is just a correction to the feature table. The same process occurs, except this time there is a previous entry with the same EMBL accession number. ID retrieves the old entry and compares the sequence of the old entry with the new entry. Since they are identical it reassigns GI 5 to the same entry, converts the new annotations, and stores it as the most current view of that EMBL entry.</p><p>Now ID gets another update to A00000, but this time the sequence is different. ID assigns a new GI, say 6, to this entry. It also updates the sequence history (Seq-inst.hist, see the <a href="ch_datamod.html#ch_datamod._Biological_Sequences_1">Biological Sequences</a> section) of both old and new entries to make a doubly linked list. The GI 5 entry has a pointer that it has been replaced by GI 6, and the GI 6 entry has a pointer showing it replaced GI 5. When NCBI makes a new data release the entry designated GI 6 will be released to represent EMBL entry A00000. However, the ASN.1 form of the data contains an explicit history. A scientist who annotated a coding region on GI 5 can discover that it has been replaced by GI 6. The GI 5 entry can still be retrieved from ID, aligned with GI 6, and the scientist can determine if her annotation is still valid on the new entry. If she annotated using the accession number instead of the GI, of course, she could be out of luck.</p><p>Since ID is attempting to order a chaotic world, mistakes will inevitably be made. However, it is clear that in the vast majority of cases it is possible to impose stable ids. As scientists and software begin to use the GI ids and reap the benefits of stable ids, the world may gradually become less chaotic. The Seq-inst.hist data structure can even be used by data suppliers to actively maintain an explicit history without ID having to infer it, which would be the ideal case.</p></div><div class="sec" id="ch_datamod.Seqloc_Locations_on_"><h4><span class="title">Seq-loc: Locations on a Bioseq</span></h4><p>A Seq-loc is a location on a Bioseq of any representation class, nucleic acid or protein. All Bioseqs provide a simple integer coordinate system from 0 to (length -1) and all Seq-locs refer to that coordinate system. All Seq-locs also explicitly the Bioseq (coordinate system) to which they apply with a Seq-id. Most objects which are attached to or reference sequences do so through a Seq-loc. Features are blocks of data attached by a Seq-loc. An alignment is just a collection of correlated Seq-locs. A segmented sequence is built from other sequences by reference to Seq-locs.</p><p>Some important methods of the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeq__loc.html">CSeq_loc</a> class and some of the subtype classes (<a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeq__interval.html">CSeq_interval</a>, <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeq__loc__mix.html">CSeq_loc_mix</a> etc.) are:</p><ul><li><p><span class="nctnt ncbi-func">CSeq_loc()</span> -- constructors to simplify creation of simple Seq-loc objects.</p></li><li><p><span class="nctnt ncbi-func">Compare()</span> -- compares two Seq-locs if they are defined on the same Bioseq.</p></li><li><p><span class="nctnt ncbi-func">GetTotalRange()</span> -- returns range, covering the whole Seq-loc. If the Seq-loc refers multiple Bioseqs, exception is thrown.</p></li><li><p><span class="nctnt ncbi-func">IsReverseStrand()</span> -- returns true if all ranges in the Seq-loc have reverse strand.</p></li><li><p><span class="nctnt ncbi-func">GetStart(), GetStop()</span> -- return start and stop positions of the Seq-loc. This may be different from GetTotalRange if the related Bioseq is circular or if the order of ranges in the Seq-loc is non-standard.</p></li><li><p><span class="nctnt ncbi-func">GetCircularLength()</span> -- returns length of the Seq-loc. If the sequence length is provided, the method checks whether the Seq-loc is circular and calculates the correct length, even if the location crosses a sequence start.</p></li><li><p><span class="nctnt ncbi-func">CheckId()</span> -- checks whether the Seq-loc refers to only one Seq-id and returns it; otherwise, it sends an exception.</p></li><li><p><span class="nctnt ncbi-func">Add()</span> -- adds a sub-location to the existing one.</p></li></ul><p>Beside these methods, a new class <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeq__loc__CI.html">CSeq_loc_CI</a> is defined in Seq_loc.hpp, which provides simplified access to individual ranges of any Seq-loc, regardless of its real type and structure.</p><div class="sec" id="ch_datamod.null_A_Gap"><h5><span class="title">null: A Gap</span></h5><p>A null Seq-loc can be used in a Seq-loc with many components to indicate a gap of unknown size. For example it is used in segmented sequences to indicate such gaps between the sequenced pieces.</p></div><div class="sec" id="ch_datamod.empty_A_Gap_in_an_Al"><h5><span class="title">empty: A Gap in an Alignment</span></h5><p>A alignment (see Sequence Alignments) may require that every Seq-loc refer to a Bioseq, even for a gap. They empty type fulfills this need.</p></div><div class="sec" id="ch_datamod.whole_A_Reference_to"><h5><span class="title">whole: A Reference to a Whole Bioseq</span></h5><p>This is just a shorthand for the Bioseq from 0 to (length -1). This form is falling out of favor at NCBI because it means one must retrieve the referenced Bioseq to determine the length of the location. An interval covering the whole Bioseq is equivalent to this and more useful. On the other hand, if an unstable Seq-id is used here, it always applies to the full length of the Bioseq, even if the length changes. This was the original rationale for this type. And it may still be valid while unstable sequences persist.</p></div><div class="sec" id="ch_datamod.int_An_Interval_on_a"><h5><span class="title">int: An Interval on a Bioseq</span></h5><p>An interval is a single continuous region of defined length on a Bioseq. A single integer value (Seqinterval.from), another single integer value (Seq-interval.to), and a Seq-id (Seq-interval.id) are required. The "from" and "to" values must be in the range 0 to (length -1) of the Bioseq cited in "id". If there is uncertainty about either the "from" or "to" values, it is expressed in additional fields "fuzz-from" and/or "fuzz-to", and the "from" and "to" values can be considered a "best guess" location. This design means that simple software can ignore fuzzy values, but they are not lost to more sophisticated tools.</p><p>The "from" value is ALWAYS less than or equal to the "to" value, no matter what strand the interval is on. It may be convenient for software to present intervals on the minus strand with the "to" value before the "from" value, but internally this is NEVER the case. This requirement means that software which determines overlaps of locations need never treat plus or minus strand locations differently and it greatly simplifies processing.</p><p>The value of Seq-interval.strand is the only value different in intervals on the plus or minus strand. Seq-interval.strand is OPTIONAL since it is irrelevant for proteins, but operationally it will DEFAULT to plus strand on nucleic acid locations where it is not supplied.</p><p>The plus or minus strand is an attribute on each simple Seq-loc (interval or point) instead of as an operation on an arbitrarily complex location (as in the GenBank/EMBL/DDBJ flatfile Feature Table) since it means even very complex locations can be processed to a base pair location in simple linear order, instead of requiring that the whole expression be processed and resolved first.</p></div><div class="sec" id="ch_datamod.packedint_A_Series_o"><h5><span class="title">packed-int: A Series of Intervals</span></h5><p>A Packed-seqint is simply a SEQUENCE OF Seq-interval. That means the location is resolved by evaluating a series of Seq-interval in order. Note that the Seq-intervals in the series need not all be on the same Bioseq or on the same strand.</p></div><div class="sec" id="ch_datamod.pnt_A_Single_Point_o"><h5><span class="title">pnt: A Single Point on a Sequence</span></h5><p>A Seq-point is essentially one-half of a Seq-interval and the discussion (above) about fuzziness and strand applies equally to Seq-point.</p></div><div class="sec" id="ch_datamod.packedpnt_A_Collecti"><h5><span class="title">packed-pnt: A Collection of Points</span></h5><p>A Packed-seqpnt is an optimization for attaching a large number of points to a single Bioseq. Information about the Seq-id, strand, or fuzziness need not be duplicated for every point. Of course, this also means it must apply equally to all points as well. This would typically be the case for listing all the cut sites of a certain restriction enzyme, for example.</p></div><div class="sec" id="ch_datamod.mix_An_Arbitrarily_C"><h5><span class="title">mix: An Arbitrarily Complex Location</span></h5><p>A Seq-loc-mix is simply a SEQUENCE OF Seq-loc. The location is resolved by resolving each Seq-loc in order. The component Seq-locs may be of any complexity themselves, making this definition completely recursive. This means a relatively small amount of software code can process locations of extreme complexity with relative ease.</p><p>A Seq-loc-mix might be used to represent a segmented sequence with gaps of unknown length. In this case it would consist of some elements of type "int" for intervals on Bioseqs and some of type "null" representing gaps of unknown length. Another use would be to combine a Seq-interval representing an untranslated leader, with a Packed-seqint from a multi-exon coding region feature, and another Seq-interval representing an untranslated 3' end, to define the extent of an mRNA on a genomic sequence.</p></div><div class="sec" id="ch_datamod.equiv_Equivalent_Loc"><h5><span class="title">equiv: Equivalent Locations</span></h5><p>This form is simply a SET OF Seq-locs that are equivalent to each other. Such a construct could be used to represent alternative splicing, for example (and is when translating the GenBank/EMBL/DDBJ location "one-of"). However note that such a location can never resolve to a single result. Further, if there are multiple "equiv" forms in a complex Seq-loc, it is unclear if all possible combinations are valid. In general this construct should be avoided unless there is no alternative.</p></div><div class="sec" id="ch_datamod.bond_A_Chemical_Bond"><h5><span class="title">bond: A Chemical Bond Between Two Residues</span></h5><p>The data elements in a Seq-bond are just two Seq-points. The meaning is that these two points have a chemical bond between them (which is different than describing just the location of two points). At NCBI we have restricted its use to covalent bonds. Note that the points may be on the same (intra-chain bond) or different (inter-chain bond) Bioseqs.</p></div><div class="sec" id="ch_datamod.feat_A_Location_Indi"><h5><span class="title">feat: A Location Indirectly Referenced Through A Feature</span></h5><p>This one is really for the future, when not only Bioseqs, but features have stable ids. The meaning is "the location of this feature". This way one could give a valid location by citing, for example a Gene feature, which would resolve to the location of that gene on a Bioseq. When identifiable features become common (see <a href="ch_datamod.html#ch_datamod.datamodel.seqfeat">Sequence Features</a>) this will become a very useful location.</p></div></div><div class="sec" id="ch_datamod.Seqloc_The_C_Impleme"><h4><span class="title">Seq-loc: The C++ Implementation</span></h4><p>The following table summarizes the Choice variants for <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeq__loc.html">CSeq_loc</a> objects.</p><p><b>Seq-loc</b></p><div class="table" id="ch_datamod.T15"><table><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1"><b>Enum Value</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Enum name</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>ASN.1 name</b></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1">e_not_set</td><td align="center" valign="middle" rowspan="1" colspan="1"></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Null</td><td align="left" valign="middle" rowspan="1" colspan="1">null</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Empty</td><td align="left" valign="middle" rowspan="1" colspan="1">empty</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Whole</td><td align="left" valign="middle" rowspan="1" colspan="1">whole</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">4</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Int</td><td align="left" valign="middle" rowspan="1" colspan="1">int</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">5</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Packed_int</td><td align="left" valign="middle" rowspan="1" colspan="1">packed-int</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">6</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Pnt</td><td align="left" valign="middle" rowspan="1" colspan="1">pnt</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">7</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Packed_pnt</td><td align="left" valign="middle" rowspan="1" colspan="1">packed-pnt</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">8</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Mix</td><td align="left" valign="middle" rowspan="1" colspan="1">mix</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">9</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Equiv</td><td align="left" valign="middle" rowspan="1" colspan="1">equiv</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">10</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Bond</td><td align="left" valign="middle" rowspan="1" colspan="1">bond</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">11</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Feat</td><td align="left" valign="middle" rowspan="1" colspan="1">feat</td></tr></tbody></table></div><p>Note that e_Mix and e_Equiv Seq-loc types can recursively contain other Seq-locs. Also, the e_Int type (implemented by <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeq__interval.html">CSeq_interval</a>) has the following strand enumeration:</p><div class="table" id="ch_datamod.T16"><table><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1"><b>Enum Value</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Enum name</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Notes</b></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Na_strand_unknown</td><td align="center" valign="middle" rowspan="1" colspan="1"></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">1</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Na_strand_plus</td><td align="center" valign="middle" rowspan="1" colspan="1"></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">2</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Na_strand_minus</td><td align="center" valign="middle" rowspan="1" colspan="1"></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">3</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Na_strand_both</td><td align="left" valign="middle" rowspan="1" colspan="1">in forward direction</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">4</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Na_strand_both_rev</td><td align="left" valign="middle" rowspan="1" colspan="1">in reverse direction</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">5</td><td align="left" valign="middle" rowspan="1" colspan="1">e_Na_strand_other</td><td align="center" valign="middle" rowspan="1" colspan="1"></td></tr></tbody></table></div><p>In addition, there are a large number of utility functions for working with SeqLocs described in the chapter on <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/include/objmgr/util/sequence.hpp">Sequence Utilities</a>. This allow traversal of complex locations, comparison of locations for overlap, conversion of coordinates in locations, and ability to open a window on a Bioseq through a location.</p></div></div></div><div class="sec" id="ch_datamod.datamodel.seqfeat"><h2><span class="title">Sequence Features</span></h2><p>This section documents data structures used to describe regions of Bioseqs. The types are located in the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/seqfeat/seqfeat.asn">seqfeat.asn</a> module.</p><div class="sec" id="ch_datamod.datamodel.cpp.seqfeat"><h3><span class="title">C++ Implementation Notes</span></h3><p>In the C++ Toolkit, many types defined in the seqfeat ASN.1 module are extended to simplify access to the feature data. The <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeq__feat.html">CSeq_feat</a> class has methods for comparing features by type and location. The <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeqFeatData.html">CSeqFeatData</a> class defines feature subtypes and qualifiers so that you can better identify individual features.</p><ul><li><p><a href="ch_datamod.html#ch_datamod.datamodel.seqalign">Introduction</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Seqfeat_Structure_of">Seq-feat: Structure of a Feature</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.SeqFeatData_Type_Spe">SeqFeatData: Type Specific Feature Data</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Seqfeat_Implementati">Seq-feat Implementation in C++</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.CdRegion_Coding_Regi">CdRegion: Coding Region</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Genetic_Codes">Genetic Codes</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Rsiteref_Reference_T">Rsite-ref: Reference To A Restriction Enzyme</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.RNAref_Reference_To_">RNA-ref: Reference To An RNA</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Generef_Reference_To">Gene-ref: Reference To A Gene</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Protref_Reference_To">Prot-ref: Reference To A Protein</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Txinit_Transcription">Txinit: Transcription Initiation</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Current_Genetic_Code">Current Genetic Code Table: gc.prt</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_s_9">ASN.1 Specification: seqfeat.asn</a></p></li></ul><div class="sec" id="ch_datamod.datamodel.seqalign"><h4><span class="title">Introduction</span></h4><p>A sequence feature (Seq-feat) is a block of structured data (SeqFeatData) explicitly attached to a region of a Bioseq through one or two Seq-locs (see Sequence Locations and Identifiers). The Seq-feat itself can carry information common to all features, as well as serving as the junction between the SeqFeatData and Seq-loc(s). Since a Seq-feat references a Bioseq through an explicit Seq-loc, a Seq-feat is an entity which can stand alone, or be moved between contexts without loss of information. Thus, information ABOUT Bioseqs can be created, exchanged, and compared independently from the Bioseq itself. This is an important attribute of the NCBI data model.</p><p>A feature table is a set of Seq-feat gathered together within a Seq-annot (see <a href="ch_datamod.html#ch_datamod._Biological_Sequences">Biological Sequences</a>). The Seq-annot allows the features to be attributed to a source and be associated with a title or comment. Seq-feats are normally exchanged "packaged" into a feature table.</p></div><div class="sec" id="ch_datamod.Seqfeat_Structure_of"><h4><span class="title">Seq-feat: Structure of a Feature</span></h4><p>A Seq-feat is a data structure common to all features. The fields it contains can be evaluated by software the same way for all features, ignoring the "data" element which is what makes each feature class unique.</p><div class="sec" id="ch_datamod.id_Features_Can_Have"><h5><span class="title">id: Features Can Have Identifiers</span></h5><p>At this time unique identifiers for features are even less available or controlled than sequence identifiers. However, as molecular biology informatics becomes more sophisticated, it will become not only useful, but essential to be able to cite features as precisely as NCBI is beginning to be able to cite sequences. The Seq-feat.id slot is where these identifiers will go. The Feat-id object for features, meant to be equivalent of the Seq-id object for Bioseqs, is not very fully developed yet. It can accommodate feature ids from the NCBI Backbone database, local ids, and the generic Dbtag type. Look for better characterized global ids to appear here in future as the requirement for structured data exchange becomes increasingly accepted.</p></div><div class="sec" id="ch_datamod.data_Structured_Data"><h5><span class="title">data: Structured Data Makes Feature Types Unique</span></h5><p>Each type of feature can have a data structure which is specifically designed to accommodate all the requirements of that type with no concern about the requirements of other feature types. Thus a coding region data structure can have fielded elements for reading frame and genetic code, while a tRNA data structure would have information about the amino acid transferred.</p><p>This design completely modularizes the components required specifically by each feature type. If a new field is required by a particular feature type, it does not affect any of the others. A new feature type, even a very complex one, can be added without affecting any of the others.</p><p>Software can be written in a very modular fashion, reflecting the data design. Functions common to all features (such as determining all features in a sequence region) simply ignore the "data" field and are robust against changes or additions to this component. Functions which process particular types have a well defined data interface unique to each type.</p><p>Perhaps a less obvious consequence is code and data reuse. Data objects used in other contexts can be used as features simply by making them a CHOICE in SeqFeatData. For example, the publication feature reuses the Pubdesc type used for Bioseq descriptors. This type includes all the standard bibliographic types (see <a href="ch_datamod.html#ch_datamod.datamodel.biblio">Bibliographic References</a>) used by MEDLINE or other bibliographic databases. Software which displays, queries, or retrieves publications will work without change on the "data" component of a publication feature because it is EXACTLY THE SAME object. This has profound positive consequences for both data and code development and maintenance.</p><p>This modularization also makes it natural to discuss each allowed feature type separately as is done in the SeqFeatData section below.</p></div><div class="sec" id="ch_datamod.partial_This_Feature"><h5><span class="title">partial: This Feature is Incomplete</span></h5><p>If Seq-feat.partial is TRUE, the feature is incomplete in some (unspecified) way. The details of incompleteness may be specified in more detail in the Seq-feat.location field. This flag allows quick exclusion of incomplete features when doing a database wide survey. It also allows the feature to be flagged when the details of incompleteness may not be know.</p><p>Seq-feat.partial should ALWAYS be TRUE if the feature is incomplete, even if Seq-feat.location indicates the incompleteness as well.</p></div><div class="sec" id="ch_datamod.except_There_is_Some"><h5><span class="title">except: There is Something Biologically Exceptional</span></h5><p>The Seq-feat.except flag is similar to the Seq-feat.partial flag in that it allows a simple warning that there is something unusual about this feature, without attempting to structure a detailed explanation. Again, this allows software scanning features in the database to ignore atypical cases easily. If Seq-feat.except is TRUE, Seq-feat.comment should contain a string explaining the exceptional situation.</p><p>Seq-feat.except does not necessarily indicate there is something wrong with the feature, but more that the biological exceeds the current representational capacity of the feature definition and that this may lead to an incorrect interpretation. For example, a coding region feature on genomic DNA where post-transcriptional editing of the RNA occurs would be a biological exception. If one translates the region using the frame and genetic code given in the feature one does not get the protein it points to, but the data supplied in the feature is, in fact, correct. It just does not take into account the RNA editing process.</p><p>Ideally, one should try to avoid or minimize exceptions by the way annotation is done. An approach to minimizing the RNA editing problem is described in the "product" section below. If one is forced to use exception consistently, it is a signal that a new or revised feature type is needed.</p></div><div class="sec" id="ch_datamod.comment_A_Comment_Ab"><h5><span class="title">comment: A Comment About This Feature</span></h5><p>No length limit is set on the comment, but practically speaking brief is better.</p></div><div class="sec" id="ch_datamod.product_Does_This_Fe"><h5><span class="title">product: Does This Feature Produce Another Bioseq?</span></h5><p>A Seq-feat is unusual in that it can point to two different sequence locations. The "product" location enables two Bioseqs to be linked together in a source/product relationship explicitly. This is very valuable for features which describe a transformation from one Bioseq to another, such as coding region (nucleic acid to protein) or the various RNA types (genomic nucleic acid to RNA product).</p><p>This explicit linkage is extremely valuable for connecting diverse types. Linkage of nucleic acid to protein through coding region makes data traversal from gene to product or back simple and explicit, but clearly of profound biological significance. Less obvious, but nonetheless useful is the connection between a tRNA gene and the modified sequence of the tRNA itself, or of a transcribed coding region and an edited mRNA.</p><p>Note that such a feature is as valuable in association with its product Bioseq alone as it is with its source Bioseq alone, and could be distributed with either or both.</p></div><div class="sec" id="ch_datamod.location_Source_Loca"><h5><span class="title">location: Source Location of This Feature</span></h5><p>The Seq-feat.location is the traditional location associated with a feature. While it is possible to use any Seq-loc type in Seq-feat.location, it is recommended to use types which resolve to a single unique sequence. The use of a type like Seq-loc-equiv to represent alternative splicing of exons (similar to the GenBank/EMBL/DDBJ feature table "one-of") is strongly discouraged. Consider the example of such an alternatively spliced coding region. What protein sequence is coded for by such usage? This problem is accentuated by the availability of the "product" slot. Which protein sequence is the product of this coding region? While such a short hand notation may seem attractive at first glance, it is clearly much more useful to represent each splicing alternative, and its associated protein product, times of expression, etc. separately.</p></div><div class="sec" id="ch_datamod.qual_GenBank_Style_Q"><h5><span class="title">qual: GenBank Style Qualifiers</span></h5><p>The GenBank/EMBL/DDBJ feature table uses "qualifiers", a combination of a string key and a string value. Many of these qualifiers do not map to the ASN.1 specification, so this provides a means of carrying them in the Seq-feat for features derived from those sources.</p></div><div class="sec" id="ch_datamod.title_A_User_Defined"><h5><span class="title">title: A User Defined Name</span></h5><p>This field is provided for naming features for display. It would be used by end-user software to allow the user to add locally meaningful names to features. This is not an id, as this is provided by the "id" slot.</p></div><div class="sec" id="ch_datamod.ext_A_User_Defined_S"><h5><span class="title">ext: A User Defined Structured Extension</span></h5><p>The "ext" field allows the extension of a standard feature type with a structured User-object (see <a href="ch_datamod.html#ch_datamod.datamodel.general">General Use Objects</a>) defined by a user. For example, a particular scientist may have additional detailed information about coding regions which do not fit into the standard CdRegion data type. Rather than create a completely new feature type, the CdRegion type can be extended by filling in as much of the standard CdRegion fields as possible, then putting the additional information in the User-object. Software which only expects a standard coding region will operate on the extended feature without a problem, while software that can make use of the additional data in the User-object can operate on exactly the same the feature.</p></div><div class="sec" id="ch_datamod.cit_Citations_For_Th"><h5><span class="title">cit: Citations For This Feature</span></h5><p>This slot is a set of Pubs which are citations about the feature itself, not about the Bioseq as a whole. It can be of any type, although the most common is type "pub", a set of any kind of Pubs. The individual Pubs within the set may be Pub-equivs (see <a href="ch_datamod.html#ch_datamod.datamodel.biblio">Bibliographic References</a>) to hold equivalent forms for the same publication, so some thought should be given to the process of accessing all the possible levels of information in this seemingly simple field.</p></div><div class="sec" id="ch_datamod.expev_Experimental_E"><h5><span class="title">exp-ev: Experimental Evidence</span></h5><p>If it is known for certain that there is or is not experimental evidence supporting a particular feature, Seq-feat.exp-ev can be "experimental" or "not-experimental" respectively. If the type of evidence supporting the feature is not known, exp-ev should not be given at all.</p><p>This field is only a simple flag. It gives no indication of what kind of evidence may be available. A structured field of this type will differ from feature type to feature type, and thus is inappropriate to the generic Seq-feat. Information regarding the quality of the feature can be found in the CdRegion feature and even more detail on methods in the Tx-init feature. Other feature types may gain experimental evidence fields appropriate to their types as it becomes clear what a reasonable classification of that evidence might be.</p></div><div class="sec" id="ch_datamod.xref_Linking_To_Othe"><h5><span class="title">xref: Linking To Other Features</span></h5><p>SeqFeatXrefs are copies of the Seq-feat.data field and (optionally) the Seq-feat.id field from other related features. This is a copy operation and is meant to keep some degree of connectivity or completeness with a Seq-feat that is moved out of context. For example, in a collection of data including a nucleic acid sequence and its translated protein product, there would be a Gene feature on the nucleic acid, a <a href="ch_datamod.html#ch_datamod.Protref_Reference_To">Prot-ref</a> feature on the protein, and a CdRegion feature linking all three together. However, if the CdRegion feature is taken by itself, the name of the translated protein and the name of the gene are not immediately available. The Seq-feat.xref provides a simple way to copy the relevant information. Note that there is a danger to any such copy operation in that the original source of the copied data may be modified without updating the copy. Software should be careful about this, and the best course is to take the original data if it is available to the software, using any copies in xref only as a last resort. If the "id" is included in the xref, this makes it easier for software to keep the copy up to date. But it depends on widespread use of feature ids.</p></div></div><div class="sec" id="ch_datamod.SeqFeatData_Type_Spe"><h4><span class="title">SeqFeatData: Type Specific Feature Data</span></h4><p>The "data" slot of a Seq-feat is filled with SeqFeatData, which is just a CHOICE of a variety of specific data structures. They are listed under their CHOICE type below, but for most types a detailed discussion will be found under the type name itself later in this chapter, or in another chapter. That is because most types are data objects in their own right, and may find uses in many other contexts than features.</p><div class="sec" id="ch_datamod.gene_Location_Of_A_G"><h5><span class="title">gene: Location Of A Gene</span></h5><p>A gene is a feature of its own, rather than a modifier of other features as in the GenBank/EMBL/DDBJ feature tables. A gene is a heritable region of nucleic acid sequence which confers a measurable phenotype. That phenotype may be achieved by many components of the gene including but not limited to coding regions, promoters, enhancers, terminators, and so on. The gene feature is meant to approximately cover the region of nucleic acid considered by workers in the field to be the gene. This admittedly fuzzy concept has an appealing simplicity and fits in well with higher level views of genes such as genetic maps.</p><p>The gene feature is implemented by a Gene-ref object, or a "reference to" a gene. The Gene-ref object is discussed below.</p></div><div class="sec" id="ch_datamod.org_Source_Organism_"><h5><span class="title">org: Source Organism Of The Bioseq</span></h5><p>Normally when a whole Bioseq or set of Bioseqs is from the same organism, the Org-ref (reference to Organism) will be found at the descriptor level of the Bioseq or Bioseq-set (see <a href="ch_datamod.html#ch_datamod._Biological_Sequences_1">Biological Sequences</a>). However, in some cases the whole Bioseq may not be from the same organism. This may occur naturally (e.g. a provirus integrated into a host chromosome) or artificially (e.g. recombinant DNA techniques).</p><p>The org feature is implemented by an Org-ref object, or a "reference to" an organism. The Orgref is discussed below.</p></div><div class="sec" id="ch_datamod.cdregion_Coding_Region_1"><h5><span class="title">cdregion: Coding Region</span></h5><p>A cdregion is a region of nucleic acid which codes for a protein. It can be thought of as "instructions to translate" a nucleic acid, not simply as a series of exons or a reflection of an mRNA or primary transcript. Other features represent those things. Unfortunately, most existing sequences in the database are only annotated for coding region, so transcription and splicing information must be inferred (often inaccurately) from it. We encourage the annotation of transcription features in addition to the coding region. Note that since the cdregion is "instructions to translate", one can represent translational stuttering by having overlapping intervals in the Seq-feat.location. Again, beware of assuming a cdregion definitely reflects transcription.</p><p>A cdregion feature is implemented by a Cdregion object, discussed below.</p></div><div class="sec" id="ch_datamod.prot_Describing_A_Pr"><h5><span class="title">prot: Describing A Protein</span></h5><p>A protein feature describes and/or names a protein or region of a protein. It uses a <a href="ch_datamod.html#ch_datamod.Protref_Reference_To">Prot-ref</a> object, or "reference to" a protein, described in detail below.</p><p>A single amino acid Bioseq can have many protein features on it. It may have one over its full length describing a pro-peptide, then a shorter one describing the mature peptide. An extreme case might be a viral polyprotein which would have one protein feature for the whole polyprotein, then additional protein features for each of the component mature proteins. One should always take into account the "location" slot of a protein feature.</p></div><div class="sec" id="ch_datamod.rna_Describing_An_RN"><h5><span class="title">rna: Describing An RNA</span></h5><p>An RNA feature can describe both coding intermediates and structural RNAs using an RNA-ref, or "reference to" an RNA. The RNA-ref is described in more detail below. The Seq-feat.location for an RNA can be attached to either the genomic sequence coding for the RNA, or to the sequence of the RNA itself, when available. The determination of whether the Bioseq the RNA feature is attached to is genomic or an RNA type is made by examining the Bioseq.descr.mol-type, not by making assumptions based on the feature. When both the genomic Bioseq and the RNA Bioseq are both available, one could attach the RNA Seq-feat.location to the genomic sequence and the Seq-feat.product to the RNA to connect them and capture explicitly the process by which the RNA is created.</p></div><div class="sec" id="ch_datamod.pub_Publication_Abou"><h5><span class="title">pub: Publication About A Bioseq Region</span></h5><p>When a publication describes a whole Bioseq, it would normally be at the "descr" slot of the Bioseq. However, if it applies to a sub region of the Bioseq, it is convenient to make it a feature. The pub feature uses a Pubdesc (see <a href="ch_datamod.html#ch_datamod._Biological_Sequences">Biological Sequences</a> for a detailed description) to describe a publication and how it relates to the Bioseq. To indicate a citation about a specific feature (as opposed to about the sequence region in general), use the Seq-feat.cit slot of that feature.</p></div><div class="sec" id="ch_datamod.seq_Tracking_Origina"><h5><span class="title">seq: Tracking Original Sequence Sources</span></h5><p>The "seq" feature is a simple way to associate a region of sequence with a region of another. For example, if one wished to annotate a region of a recombinant sequence as being from "pBR322 10-50" one would simply use a Seq-loc (see Sequence Locations and Identifiers) for the interval 10-50 on Seq-id pBR322. Software tools could use such information to provide the pBR322 numbering system over that interval.</p><p>This feature is really meant to accommodate older or approximate data about the source of a sequence region and is no more than annotation. More specific and computationally useful ways of doing this are (1) create the recombinant sequence as a segmented sequence directly (see <a href="ch_datamod.html#ch_datamod._Biological_Sequences">Biological Sequences</a>), (2) use the Seq-hist field of a Bioseq to record its history, (3) create alignments (see Sequence Alignments) which are also valid Seq-annots, to indicate more complex relationships of one Bioseq to others.</p></div><div class="sec" id="ch_datamod.imp_Importing_Featur"><h5><span class="title">imp: Importing Features From Other Data Models</span></h5><p>The SeqFeatData types explicitly define only certain well understood or widely used feature types. There may be other features contained in databases converted to this specification which are not represented by this ASN.1 specification. At least for GenBank, EMBL, DDBJ, PIR, and SWISS-PROT, these can be mapped to an Imp-feat structure so the features are not lost, although they are still unique to the source database. All these features have the basic form of a string key, a location (carried as the original string), and a descriptor (another string). In the GenBank/EMBL/DDBJ case, any additional qualifiers can be carried on the Seq-feat.qual slot.</p><p>GenBank/EMBL/DDBJ use a "location" called "replace" which is actually an editing operation on the sequence which incorporates literal strings. Since the locations defined in this specification are locations on sequences, and not editing operations, features with replace operators are all converted to Imp-feat so that the original location string can be preserved. This same strategy is taken in the face of incorrectly constructed locations encountered in parsing outside databases into ASN.1.</p></div><div class="sec" id="ch_datamod.region_A_Named_Regio"><h5><span class="title">region: A Named Region</span></h5><p>The region feature provides a simple way to name a region of a Bioseq (e.g. "globin locus", "LTR", "subrepeat region", etc).</p></div><div class="sec" id="ch_datamod.comment_A_Comment_On"><h5><span class="title">comment: A Comment On A Region Of Sequence</span></h5><p>The comment feature allows a comment to be made about any specified region of sequence. Since comment is already a field in Seq-feat, there is no need for an additional type specific data item in this case, so it is just NULL.</p></div><div class="sec" id="ch_datamod.bond_A_Bond_Between_"><h5><span class="title">bond: A Bond Between Residues</span></h5><p>This feature annotates a bond between two residues. A Seq-loc of type "bond" is expected in Seq-feat.location. Certain types of bonds are given in the ENUMERATED type. If the bond type is "other" the Seq-feat.comment slot should be used to explain the type of the bond. Allowed bond types are:</p><pre>disulfide (1) ,<br />thiolester (2) ,<br />xlink (3) ,<br />thioether (4) ,<br />other (255)</pre></div><div class="sec" id="ch_datamod.site_A_Defined_Site"><h5><span class="title">site: A Defined Site</span></h5><p>The site feature annotates a know site from the following specified list. If the site is "other" then Seq-feat.comment should be used to explain the site.</p><pre>active (1) ,<br />binding (2) ,<br />cleavage (3) ,<br />inhibit (4) ,<br />modified (5),<br />glycosylation (6) ,<br />myristoylation (7) ,<br />mutagenized (8) ,<br />metal-binding (9) ,<br />phosphorylation (10) ,<br />acetylation (11) ,<br />amidation (12) ,<br />methylation (13) ,<br />hydroxylation (14) ,<br />sulfatation (15) ,<br />oxidative-deamination (16) ,<br />pyrrolidone-carboxylic-acid (17) ,<br />gamma-carboxyglutamic-acid (18) ,<br />blocked (19) ,<br />lipid-binding (20) ,<br />np-binding (21) ,<br />dna-binding (22) ,<br />other (255)</pre></div><div class="sec" id="ch_datamod.rsite_A_Restriction_"><h5><span class="title">rsite: A Restriction Enzyme Cut Site</span></h5><p>A restriction map is basically a feature table with rsite features. Software which generates such a feature table could then use any sequence annotation viewer to display its results. Restriction maps generated by physical methods (before sequence is available), can use this feature to create a map type Bioseq representing the ordered restriction map. For efficiency one would probably create one Seq-feat for each restriction enzyme used and used the Packed-pnt Seq-loc in the location slot. See Rsite-ref, below.</p></div><div class="sec" id="ch_datamod.user_A_User_Defined_"><h5><span class="title">user: A User Defined Feature</span></h5><p>An end-user can create a feature completely of their own design by using a User-object (see <a href="ch_datamod.html#ch_datamod.datamodel.general">General Use Objects</a>) for SeqFeatData. This provides a means for controlled addition and testing of new feature types, which may or may not become widely accepted or to "graduate" to a defined SeqFeatData type. It is also a means for software to add structured information to Bioseqs for its own use and which may never be intended to become a widely used standard. All the generic feature operations, including display, deletion, determining which features are carried on a sub region of sequence, etc, can be applied to an user feature with no knowledge of the particular User-object structure or meaning. Yet software which recognizes that User-object can take advantage of it.</p><p>If an existing feature type is available but lacks certain additional fields necessary for a special task or view of information, then it should be extended with the Seq-feat.ext slot, rather than building a complete user feature de novo.</p></div><div class="sec" id="ch_datamod.txinit_Transcription_Initia_1"><h5><span class="title">txinit: Transcription Initiation</span></h5><p>This feature is used to designate the region of transcription initiation, about which considerable knowledge is available. See <a href="ch_datamod.html#ch_datamod.Txinit_Transcription">Txinit</a>, below.</p></div><div class="sec" id="ch_datamod.num_Applying_Custom_"><h5><span class="title">num: Applying Custom Numbering To A Region</span></h5><p>A Numbering object can be used as a Bioseq descriptor to associate various numbering systems with an entire Bioseq. When used as a feature, the numbering system applies only to the region in Seq-feat.location. This make multiple, discontinuous numbering systems available on the same Bioseq. See <a href="ch_datamod.html#ch_datamod._Biological_Sequences">Biological Sequences</a> for a description of Numbering, and also Seq-feat.seq, above, for an alternative way of applying a sequence name and its numbering system to a sequence region.</p></div><div class="sec" id="ch_datamod.psecstr_Protein_Seco"><h5><span class="title">psec-str: Protein Secondary Structure</span></h5><p>Secondary structure can be annotated on a protein sequence using this type. It can be predicted by algorithm (in which case Seq-feat.exp-ev should be "not-experimental") or by analysis of the known protein structure (Seq-feat.exp-ev = "experimental"). Only three types of secondary structure are currently supported. A "helix" is any helix, a "sheet" is beta sheet, and "turn" is a beta or gamma turn. Given the controversial nature of secondary structure classification (not be mention prediction), we opted to keep it simple until it was clear that more detail was really necessary or understood.</p></div><div class="sec" id="ch_datamod.nonstdresidue_Unusua"><h5><span class="title">non-std-residue: Unusual Residues</span></h5><p>When an unusual residue does not have a direct sequence code, the "best" standard substitute can be used in the sequence and the residue can be labeled with its real name. No attempt is made to enforce a standard nomenclature for this string.</p></div><div class="sec" id="ch_datamod._het_Heterogen_1"><h5><span class="title">het: Heterogen</span></h5><p>In the PDB structural database, non-biopolymer atoms associated with a Bioseq are referred to as "heterogens". When a heterogen appears as a feature, it is assumed to be bonded to the sequence positions in Seq-feat.location. If there is no specific bonding information, the heterogen will appear as a descriptor of the Bioseq. The Seq-loc for the Seq-feat.location will probably be a point or points, not a bond. A Seq-loc of type bond is between sequence residues.</p></div></div><div class="sec" id="ch_datamod.Seqfeat_Implementati"><h4><span class="title">Seq-feat Implementation in C++</span></h4><p>The C++ implementation of a Seq-feat is mostly straightforward. However, some explanation of the "id" and "data" slots will be helpful. Both are implemented as a Choice and contained in the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeq__feat.html">CSeq_feat</a> object. The tables below summarize the id and data choice variants.</p><p><b>SeqFeat.id</b></p><div class="table" id="ch_datamod.T17"><table><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1"><b>ASN.1 name</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Value</b></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">(not present)</td><td align="left" valign="middle" rowspan="1" colspan="1">0</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">gibb</td><td align="left" valign="middle" rowspan="1" colspan="1">1</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">giim</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">local</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">general</td><td align="left" valign="middle" rowspan="1" colspan="1">4</td></tr></tbody></table></div><p><b>SeqFeat.data</b></p><div class="table" id="ch_datamod.T18"><table><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1"><b>ASN.1 name</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Value</b></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">(not present)</td><td align="left" valign="middle" rowspan="1" colspan="1">0</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">gene</td><td align="left" valign="middle" rowspan="1" colspan="1">1</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">org</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">cdregion</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">prot</td><td align="left" valign="middle" rowspan="1" colspan="1">4</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">rna</td><td align="left" valign="middle" rowspan="1" colspan="1">5</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">pub</td><td align="left" valign="middle" rowspan="1" colspan="1">6</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">seq</td><td align="left" valign="middle" rowspan="1" colspan="1">7</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">imp</td><td align="left" valign="middle" rowspan="1" colspan="1">8</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">region</td><td align="left" valign="middle" rowspan="1" colspan="1">9</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">comment</td><td align="left" valign="middle" rowspan="1" colspan="1">10</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">bond</td><td align="left" valign="middle" rowspan="1" colspan="1">11</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">site</td><td align="left" valign="middle" rowspan="1" colspan="1">12</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">rsite</td><td align="left" valign="middle" rowspan="1" colspan="1">13</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">user</td><td align="left" valign="middle" rowspan="1" colspan="1">14</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">txinit</td><td align="left" valign="middle" rowspan="1" colspan="1">15</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">num</td><td align="left" valign="middle" rowspan="1" colspan="1">16</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">psec-str</td><td align="left" valign="middle" rowspan="1" colspan="1">17</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">non-std-residue</td><td align="left" valign="middle" rowspan="1" colspan="1">18</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">het</td><td align="left" valign="middle" rowspan="1" colspan="1">19</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">biosrc</td><td align="left" valign="middle" rowspan="1" colspan="1">20</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">clone</td><td align="left" valign="middle" rowspan="1" colspan="1">21</td></tr></tbody></table></div><p>Of course, within the software tools for producing GenBank, report, or other formats from ASN.1 are functions to format and display features as well. There are some functions to manipulate the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeqFeatData.html">CSeqFeatData</a> objects, such as the translation of a CdRegion, and a host of functions to use and compare the Seq-locs of "product" and "location" or easily access and use the sequence regions they point to. These functions are discussed in the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/include/objmgr/util/sequence.hpp">Sequence Utilities</a> chapter. Additional functions, described in <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/include/objects/misc/sequence_macros.hpp">Exploring The Data</a>, allow one to easily locate features of interest by type, in arbitrarily complex objects.</p></div><div class="sec" id="ch_datamod.CdRegion_Coding_Regi"><h4><span class="title">CdRegion: Coding Region</span></h4><p>A CdRegion, in association with a Seq-feat, is considered "instructions to translate" to protein. The Seq-locs used by the Seq-feat do not necessarily reflect the exon structure of the primary transcript (although they often do). A Seq-feat of type CdRegion can point both to the source nucleic acid and to the protein sequence it produces. Most of the information about the source nucleic acid (such as the gene) or the destination protein (such as its name) is associated directly with those Bioseqs. The CdRegion only serves as a link between them, and as a method for explicitly encoding the information needed to derive one from the other.</p><div class="sec" id="ch_datamod.orf_Open_Reading_Fra"><h5><span class="title">orf: Open Reading Frame</span></h5><p>CdRegion.orf is TRUE if the coding region is only known to be an open reading frame. This is a signal that nothing is known about the protein product, or even if it is produced. In this case the translated protein sequence will be attached, but there will be no other information associated with it. This flag allows such very speculative coding regions to be easily ignored when scanning the database for genuine protein coding regions.</p><p>The orf flag is not set when any reasonable argument can be made that the CdRegion is really expressed, such as detection of mRNA or strong sequence similarity to known proteins.</p></div><div class="sec" id="ch_datamod.Translation_Informat"><h5><span class="title">Translation Information</span></h5><p>CdRegion has several explicit fields to define how to translate the coding region. Reading frame is explicitly given or defaults to frame one.</p><p>The genetic code is assumed to be the universal code unless given explicitly. The code itself is given, rather than requiring software to determine the code at run-time by analyzing the phylogenetic position of the Bioseq. Genetic code is described below.</p><p>Occasionally the genetic code is not followed at specific positions in the sequence. Examples are the use of alternate initiation codons only in the first position, the effects of suppresser tRNAs, or the addition of selenocysteine. The Code-break object specifies the three bases of the codon in the Bioseq which is treated differently and the amino acid which is generated at that position. During translation the genetic code is followed except at positions indicated by Code-breaks, where the instructions in the Code-break are followed instead.</p></div><div class="sec" id="ch_datamod.Problems_With_Transl"><h5><span class="title">Problems With Translations</span></h5><p>In a surprising number of cases an author publishes both a nucleic acid sequence and the protein sequence produced by its coding region, but the translation of the coding region does not yield the published protein sequence. On the basis of the publication it is not possible to know for certain which sequence is correct. In the NCBI Backbone database both sequences are preserved as published by the author, but the conflict flag is set to TRUE in the CdRegion. If available, the number of gaps and mismatches in the alignment of the translated sequence to the published protein sequence are also given so a judgment can be made about the severity of the problem.</p></div></div><div class="sec" id="ch_datamod.Genetic_Codes"><h4><span class="title">Genetic Codes</span></h4><p>A Genetic-code is a SET which may include one or more of a name, integer id, or 64 cell arrays of amino acid codes in different alphabets. Thus, in a CdRegion, one can either refer to a genetic code by name or id; provide the genetic code itself, or both. Tables of genetic codes are provided in the NCBI software release with most possibilities filled in.</p><p>The Genetic-code.name is a descriptive name for the genetic code, mainly for display to humans. The integer id refers to the ids in the gc.val (binary ASN.1) or gc.prt (text ASN.1) file of genetic codes maintained by NCBI, distributed with the software tools and Entrez releases, and published in the GenBank/EMBL/DDBJ feature table document. Genetic-code.id is the best way to explicitly refer to a genetic code.</p><p>The genetic codes themselves are arrays of 64 amino acid codes. The index to the position in the array of the amino acid is derived from the codon by the following method:</p><p>index = (base1 * 16) + (base2 * 4) + base3</p><p>where T=0, C=1, A=2, G=3</p><p>Note that this encoding of the bases is not the same as any of the standard nucleic acid encoding described in Biological Sequence. This set of values was chosen specifically for genetic codes because it results in the convenient groupings of amino acid by codon preferred for display of genetic code tables.</p><p>The genetic code arrays have names which indicate the amino acid alphabet used (e.g. ncbieaa). The same encoding technique is used to specify start codons. Alphabet names are prefixed with "s" (e.g. sncbieaa) to indicate start codon arrays. Each cell of a start codon array contains either the gap code ("-" for ncbieaa) or an amino acid code if it is valid to use the codon as a start codon. Currently all starts are set to code for methionine, since it has never been convincingly demonstrated that a protein can start with any other amino acid. However, if other amino acids are shown to be used as starts, this structure can easily accommodate that information.</p><p>The contents of gc.prt, the current supported genetic codes, is given at the end of this chapter.</p><div class="sec" id="ch_datamod.C_Implementation_Of_"><h5><span class="title">C++ Implementation Of Genetic Codes</span></h5><p>The GeneticCode type is summarized as follows:</p><p><b>GeneticCode Elements</b></p><div class="table" id="ch_datamod.T19"><table><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1"><b>ASN.1 name</b></td><td align="left" valign="middle" rowspan="1" colspan="1"><b>Value</b></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">name</td><td align="left" valign="middle" rowspan="1" colspan="1">1</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">id</td><td align="left" valign="middle" rowspan="1" colspan="1">2</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">ncbieaa</td><td align="left" valign="middle" rowspan="1" colspan="1">3</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">ncbi8aa</td><td align="left" valign="middle" rowspan="1" colspan="1">4</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">ncbistdaa</td><td align="left" valign="middle" rowspan="1" colspan="1">5</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">sncbieaa</td><td align="left" valign="middle" rowspan="1" colspan="1">6</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">sncbi8aa</td><td align="left" valign="middle" rowspan="1" colspan="1">7</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">sncbistdaa</td><td align="left" valign="middle" rowspan="1" colspan="1">8</td></tr></tbody></table></div></div></div><div class="sec" id="ch_datamod.Rsiteref_Reference_T"><h4><span class="title">Rsite-ref: Reference To A Restriction Enzyme</span></h4><p>This simple data structure just references a restriction enzyme. It is a choice of a simple string (which may or may not be from a controlled vocabulary) or a Dbtag, in order to cite an enzyme from a specific database such as RSITE. The Dbtag is preferred, if available.</p><p>Note that this reference is not an Rsite-entry which might contain a host of information about the restriction enzyme, but is only a reference to the enzyme.</p></div><div class="sec" id="ch_datamod.RNAref_Reference_To_"><h4><span class="title">RNA-ref: Reference To An RNA</span></h4><p>An RNA-ref allows naming and a minimal description of various RNAs. The "type" is a controlled vocabulary for dividing RNAs into broad, well accepted classes. The "pseudo" field is used for RNA pseudogenes.</p><p>The "ext" field allows the addition of structure information appropriate to a specific RNA class as appropriate. The "name" extension allows naming the "other" type or adding a modifier, such as "28S" to rRNA. For tRNA there is a structured extension which as fields for the amino acid transferred, drawn from the standard amino acid alphabets, and a value for one or more codons that this tRNA recognizes. The values of the codons are calculated as a number from 0 to 63 using the same formula as for calculating the index to Genetic Codes, above.</p><p>As nomenclature and attributes for classes of RNAs becomes better understood and accepted, the RNA-ref.ext will gain additional extensions.</p></div><div class="sec" id="ch_datamod.Generef_Reference_To"><h4><span class="title">Gene-ref: Reference To A Gene</span></h4><p>A Gene-ref is not intended to carry all the information one might want to know about a gene, but to provide a small set of information and reference some larger body of information, such as an entry in a genetic database.</p><p>The "locus" field is for the gene symbol, preferably an official one (e.g. "Adh"). The "allele" field is for an allele symbol (e.g. "S"). The "desc" field is for a descriptive name for the gene (e.g. "Alcohol dehydrogenase, SLOW allele"). One should fill in as many of these fields as possible.</p><p>The "maploc" field accepts a string with a map location using whatever conventions are appropriate to the organism. This field is hardly definitive and if up to date mapping information is desired a true mapping database should always be consulted.</p><p>If "pseudo" is TRUE, this is a pseudogene.</p><p>The "db" field allows the Gene-ref to be attached to controlled identifiers from established gene databases. This allows a direct key to a database where gene information will be kept up to date without requiring that the rest of the information in the Gene-ref necessarily be up to date as well. This type of foreign key is essential to keeping loosely connected data up to date and NCBI is encouraging gene databases to make such controlled keys publicly available.</p><p>The "syn" field holds synonyms for the gene. It does not attempt to discriminate symbols, alleles, or descriptions.</p></div><div class="sec" id="ch_datamod.Protref_Reference_To"><h4><span class="title">Prot-ref: Reference To A Protein</span></h4><p>A Prot-ref is meant to reference a protein very analogous to the way a Gene-ref references a gene. The "name" field is a SET OF strings to allow synonyms. The first name is presumed to be the preferred name by software tools. Since there is no controlled vocabulary for protein names this is the best that can be done at this time. "ADH" and "alcohol dehydrogenase" are both protein names.</p><p>The "desc" field is for a description of the protein. This field is often not necessary if the name field is filled in, but may be informative in some cases and essential in cases where the protein has not yet been named (e.g. ORF21 putative protein).</p><p>The "ec" field contains a SET of EC numbers. These strings are expected to be only numbers separated by periods (no leading "EC"). Sometimes the last few positions will be occupied by dashes or not filled in at all if the protein has not been fully characterized. Examples of EC numbers are ( 1.14.13.8 or 1.14.14.- or 1.14.14.3 or 1.14.--.-- or 1.14 ).</p><p>The "activity" field allows the various known activities of the protein to be specified. This can be very helpful, especially when the name is not informative.</p><p>The "db" field is to accommodate keys from protein databases. While protein nomenclature is not well controlled, there are subfields such as immunology which have controlled names. There are also databases which characterize proteins in other ways than sequence, such as 2-d spot databases which could provide such a key.</p></div><div class="sec" id="ch_datamod.Txinit_Transcription"><h4><span class="title">Txinit: Transcription Initiation</span></h4><p>This is an example of a SeqFeatData block designed and built by a domain expert, an approach the NCBI strongly encourages and supports. The Txinit structure was developed by Philip Bucher and David Ghosh. It carries most of the information about transcription initiation represented in the Eukaryotic Promoter Database (EPD). The Txinit structure carries a host of detailed experimental information, far beyond the simple "promoter" features in GenBank/EMBL/DDBJ. EPD is released as a database in its own right and as Txinit Seq-feats. NCBI will be incorporating the EPD in its feature table form to provide expert annotation of the sequence databases in the manner described in the Data Model chapter.</p><p>The Txinit object is well described by its comments in the ASN.1 definition. The best source of more in depth discussion of these fields is in the EPD documentation, and so it will not be reproduced here.</p></div><div class="sec" id="ch_datamod.Current_Genetic_Code"><h4><span class="title">Current Genetic Code Table: gc.prt</span></h4><pre>--**************************************************************************<br />--  This is the NCBI genetic code table<br />--  Base 1-3 of each codon have been added as comments to facilitate<br />--    readability at the suggestion of Peter Rice, EMBL<br />--*************************************************************************<br />Genetic-code-table ::= {<br />{<br />name "Standard" ,<br />name "SGC0" ,<br />id 1 ,<br />ncbieaa  "FFLLSSSSYY**CC*WLLLLPPPPHHQQRRRRIIIMTTTTNNKKSSRRVVVVAAAADDEEGGGG",<br />sncbieaa "-----------------------------------M----------------------------"<br />-- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG<br />-- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG<br />-- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG<br />} ,<br />{<br />name "Vertebrate Mitochondrial" ,<br />name "SGC1" ,<br />id 2 ,<br />ncbieaa  "FFLLSSSSYY**CCWWLLLLPPPPHHQQRRRRIIMMTTTTNNKKSS**VVVVAAAADDEEGGGG",<br />sncbieaa "--------------------------------MMMM---------------M------------"<br />-- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG<br />-- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG<br />-- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG<br />} ,<br />{<br />name "Yeast Mitochondrial" ,<br />name "SGC2" ,<br />id 3 ,<br />ncbieaa  "FFLLSSSSYY**CCWWTTTTPPPPHHQQRRRRIIMMTTTTNNKKSSRRVVVVAAAADDEEGGGG",<br />sncbieaa "-----------------------------------M----------------------------"<br />-- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG<br />-- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG<br />-- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG<br />} ,<br />{<br />name "Mold Mitochondrial and Mycoplasma" ,<br />name "SGC3" ,<br />id 4 ,<br />ncbieaa  "FFLLSSSSYY**CCWWLLLLPPPPHHQQRRRRIIIMTTTTNNKKSSRRVVVVAAAADDEEGGGG",<br />sncbieaa "-----------------------------------M----------------------------"<br />-- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG<br />-- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG<br />-- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG<br />} ,<br />{<br />name "Invertebrate Mitochondrial" ,<br />name "SGC4" ,<br />id 5 ,<br />ncbieaa  "FFLLSSSSYY**CCWWLLLLPPPPHHQQRRRRIIMMTTTTNNKKSSSSVVVVAAAADDEEGGGG",<br />sncbieaa "---M----------------------------M-MM----------------------------"<br />-- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG<br />-- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG<br />-- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG<br />} ,<br />{<br />name "Ciliate Macronuclear and Daycladacean" ,<br />name "SGC5" ,<br />id 6 ,<br />ncbieaa  "FFLLSSSSYYQQCC*WLLLLPPPPHHQQRRRRIIIMTTTTNNKKSSRRVVVVAAAADDEEGGGG",<br />sncbieaa "-----------------------------------M----------------------------"<br />-- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG<br />-- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG<br />-- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG<br />} ,<br />{<br />name "Protozoan Mitochondrial (and Kinetoplast)" ,<br />name "SGC6" ,<br />id 7 ,<br />ncbieaa  "FFLLSSSSYY**CCWWLLLLPPPPHHQQRRRRIIIMTTTTNNKKSSRRVVVVAAAADDEEGGGG",<br />sncbieaa "--MM---------------M------------MMMM---------------M------------"<br />-- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG<br />-- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG<br />-- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG<br />} ,<br />{<br />name "Plant Mitochondrial/Chloroplast (posttranscriptional variant)" ,<br />name "SGC7" ,<br />id 8 ,<br />ncbieaa  "FFLLSSSSYY**CC*WLLLLPPPPHHQQRRRWIIIMTTTTNNKKSSRRVVVVAAAADDEEGGGG",<br />sncbieaa "--M-----------------------------MMMM---------------M------------"<br />-- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG<br />-- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG<br />-- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG<br />} ,<br />{<br />name "Echinoderm Mitochondrial" ,<br />name "SGC8" ,<br />id 9 ,<br />ncbieaa  "FFLLSSSSYY**CCWWLLLLPPPPHHQQRRRRIIIMTTTTNNNKSSSSVVVVAAAADDEEGGGG",<br />sncbieaa "-----------------------------------M----------------------------"<br />-- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG<br />-- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG<br />-- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG<br />} ,<br />{<br />name "Euplotid Macronuclear" ,<br />name "SGC9" ,<br />id 10 ,<br />ncbieaa  "FFLLSSSSYY*QCCCWLLLLPPPPHHQQRRRRIIIMTTTTNNKKSSRRVVVVAAAADDEEGGGG",<br />sncbieaa "-----------------------------------M----------------------------"<br />-- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG<br />-- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG<br />-- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG<br />} ,<br />{<br />name "Eubacterial" ,<br />id 11 ,<br />ncbieaa  "FFLLSSSSYY**CC*WLLLLPPPPHHQQRRRRIIIMTTTTNNKKSSRRVVVVAAAADDEEGGGG",<br />sncbieaa "---M---------------M------------M--M---------------M------------"<br />-- Base1  TTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCAAAAAAAAAAAAAAAAGGGGGGGGGGGGGGGG<br />-- Base2  TTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGGTTTTCCCCAAAAGGGG<br />-- Base3  TCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAGTCAG<br />} <br />}</pre></div></div></div><div class="sec" id="ch_datamod._Sequence_Alignments_1"><h2><span class="title">Sequence Alignments</span></h2><div class="sec" id="ch_datamod.Sequence_Alignments"><h3><span class="title">Sequence Alignments</span></h3><ul><li><p><a href="ch_datamod.html#ch_datamod.Introduction">Introduction</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Seqalign">Seq-align</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Score_Score_Of_An_Al">Score: Score Of An Alignment Or Segment</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Densediag_Segments_F">Dense-diag: Segments For diags Seq-align</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Denseseg_Segments_fo">Dense-seg: Segments for "global" or "partial" Seq-align</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Stdseg_Aligning_Any_">Std-seg: Aligning Any Bioseq Type With Any Other</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_s_10">ASN.1 Specification: seqalign.asn</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.C_Implementation_Not">C++ Implementation Notes</a></p></li></ul><div class="sec" id="ch_datamod.Introduction"><h4><span class="title">Introduction</span></h4><p>A sequence alignment is a mapping of the coordinates of one <span class="nctnt ncbi-type">Bioseq</span> onto the coordinates of one or more other <span class="nctnt ncbi-type">Bioseq</span>s. Such a mapping may be associated with a score and/or a method for doing the alignment. An alignment can be generated algorithmically by software or manually by a scientist. The <span class="nctnt ncbi-type">Seq-align</span> object is designed to capture the final result of the process, not the process itself.</p><p>A <span class="nctnt ncbi-type">Seq-align</span> is one of the forms of <span class="nctnt ncbi-type">Seq-annot</span> and is as acceptable a sequence annotation as a feature table. <span class="nctnt ncbi-type">Seq-align</span>s would normally be "packaged" in a <span class="nctnt ncbi-type">Seq-annot</span> for exchange with other tools or databases so the alignments can be identified and given a title.</p><p>The most common sequence alignment is from one sequence to another with a one to one relationship between the aligned residues of one sequence with the residues of the other (with allowance for gaps). Two types of <span class="nctnt ncbi-type">Seq-align</span> types, <span class="nctnt ncbi-type">Dense-seg</span> and <span class="nctnt ncbi-type">Dense-diag</span> are specifically for this type of alignment. The <span class="nctnt ncbi-type">Std-seg</span>, on the other hand, is very generic and does not assume that the length of one aligned region is necessarily the same as the other. This permits expansion and contraction of one <span class="nctnt ncbi-type">Bioseq</span> relative to another, which is necessary in the case of a physical map <span class="nctnt ncbi-type">Bioseq</span> aligned to a genetic map <span class="nctnt ncbi-type">Bioseq</span>, or a sequence <span class="nctnt ncbi-type">Bioseq</span> aligned with any map <span class="nctnt ncbi-type">Bioseq</span>.</p><p>All the forms of <span class="nctnt ncbi-type">Seq-align</span> are composed of segments. Each segment is an aligned region which contains only sequence or only a gap for any sequence in the alignment. Below is a three dimensional alignment with six segments:</p><pre>    Seq-ids<br />    id=100        AAGGCCTTTTAGAGATGATGATGATGATGA<br />    id=200        AAGGCCTaTTAG.......GATGATGATGA<br />    id=300        ....CCTTTTAGAGATGATGAT....ATGA<br />                  | 1 |   2  |   3   |4| 5  | 6|  Segments</pre><p>Taking only two of the sequences in a two way alignment, only three segments are needed to define the alignment:</p><pre>    Seq-ids<br />    id=100        AAGGCCTTTTAGAGATGATGATGATGATGA<br />    id=200        AAGGCCTaTTAG.......GATGATGATGA<br />                  |     1    |   2   |     3   |  Segments</pre></div><div class="sec" id="ch_datamod.Seqalign"><h4><span class="title">Seq-align</span></h4><p>A <span class="nctnt ncbi-type">Seq-align</span> is a collection of segments representing one complete alignment. The whole <span class="nctnt ncbi-type">Seq-align</span> may have a Score representing some measure of quality or attributing the method used to build the <span class="nctnt ncbi-type">Seq-align</span>. In addition, each segment may have a score for that segment alone.</p><div class="sec" id="ch_datamod.type_global"><h5><span class="title">type: global</span></h5><p>A global alignment is the alignment of <span class="nctnt ncbi-type">Bioseq</span>s over their complete length. It expresses the relationship between the intact <span class="nctnt ncbi-type">Bioseq</span>s. As such it is typically used in studies of homology between closely related proteins or genomes where there is reason to believe they share a common origin over their complete lengths.</p><p>The segments making up a global alignment are assumed to be connected in order from first to last to make up the alignment, and that the full lengths of all sequences will be accounted for in the alignment.</p></div><div class="sec" id="ch_datamod.type_partial"><h5><span class="title">type: partial</span></h5><p>A partial alignment only defines a relationship between sequences for the lengths actually included in the alignment. No claim is made that the relationship pertains to the full lengths of any of the sequences.</p><p>Like a global alignment, the segments making up a partial alignment are assumed to be connected in order from first to last to make up the alignment. Unlike a global alignment, it is not assumed the alignment will necessarily account for the full lengths of any or all sequences.</p><p>A partial or global alignment may use either the <span class="nctnt ncbi-type">denseg</span> choice of segment (for aligned <span class="nctnt ncbi-type">Bioseq</span>s with one to one residue mappings, such as protein or nucleic acid sequences) or the <span class="nctnt ncbi-type">std</span> choice for any <span class="nctnt ncbi-type">Bioseq</span>s including maps. In both cases there is an ordered relationship between one segment and the next to make the complete alignment.</p></div><div class="sec" id="ch_datamod.type_diags"><h5><span class="title">type: diags</span></h5><p>A <span class="nctnt ncbi-type">Seq-align</span> of type <span class="nctnt ncbi-type">diags</span> means that each segment is independent of the next and no claims are made about the reasonableness of connecting one segment to another. This is the kind of relationship shown by a "dot matrix" display. A series of diagonal lines in a square matrix indicate unbroken regions of similarity between the sequences. However, diagonals may overlap multiple times, or regions of the matrix may have no diagonals at all. The <span class="nctnt ncbi-type">diags</span> type of alignment captures that kind of relationship, although it is not limited to two dimensions as a dot matrix is.</p><p>The <span class="nctnt ncbi-type">diags</span> type of <span class="nctnt ncbi-type">Seq-align</span> may use either the <span class="nctnt ncbi-type">dendiag</span> choice of segment (for aligned <span class="nctnt ncbi-type">Bioseq</span>s with one to one residue mappings, such as protein or nucleic acid sequences) or the <span class="nctnt ncbi-type">std</span> choice for any <span class="nctnt ncbi-type">Bioseq</span>s including maps. In both cases the <span class="nctnt ncbi-type">SEQUENCE OF</span> does not imply any ordered relationship between one segment and the next. Each segment is independent of any other.</p></div><div class="sec" id="ch_datamod.Typedisc"><h5><span class="title">Type:disc</span></h5><p>A discontinuous alignment is a set of alignments between two or more sequences. The alignments in the set represent the aligned chunks, broken by unaligned regions (represented by the implicit gaps in-between the alignments in the set).</p><p>Each chunk is a non-recursive <span class="nctnt ncbi-type">Seq-align</span> of type ''global'' or ''partial'' and with the same dimension. <span class="nctnt ncbi-type">Seq-id</span>s in all <span class="nctnt ncbi-type">Seq-align</span>s are identical (and in the same order).</p><p>Examples of usage include mRNA-to-genomic alignments representing exons or genomic-to-genomic alignments containing unaligned regions.</p></div><div class="sec" id="ch_datamod.dim_Dimensionality_O"><h5><span class="title">dim: Dimensionality Of The Alignment</span></h5><p>Most scientists are familiar with pairwise, or two dimensional, sequence alignments. However, it is often useful to align sequences in more dimensions. The <span class="nctnt ncbi-type">dim</span> attribute of <span class="nctnt ncbi-type">Seq-align</span> indicates the number of sequences which are <b>simultaneously</b> aligned. A three dimensional alignment is a true three way alignment (ABC), not three pairwise alignments (AB, AC, BC). Three pairwise alignments are three <span class="nctnt ncbi-type">Seq-align</span> objects, each with dimension equal to two.</p><p>Another common situation is when many sequences are aligned to one, as is the case of a merge of a number of components into a larger sequence, or the relationship of many mutant alleles to the wild type sequence. This is also a collection of two dimensional alignments, where one of the <span class="nctnt ncbi-type">Bioseq</span>s is common to all alignments. If the wild type <span class="nctnt ncbi-type">Bioseq</span> is A, and the mutants are B, C, D, then the <span class="nctnt ncbi-type">Seq-annot</span> would contain three two dimensional alignments, AB, AC, AD.</p><p>The <span class="nctnt ncbi-type">dim</span> attribute at the level of the <span class="nctnt ncbi-type">Seq-align</span> is <b>optional</b>, while the <span class="nctnt ncbi-type">dim</span> attribute is required on <b>each</b> segment. This is because it is convenient for a global or partial alignment to know the dimensionality for the whole alignment. It is also an integrity check that every segment in such a <span class="nctnt ncbi-type">Seq-align</span> has the same dimension. For <span class="nctnt ncbi-type">diags</span> however, the segments are independent of each other, and may even have different dimensions. This would be true for algorithms that locate the best n-way diagonals, where n can be 2 to the number of sequences. For a simple dot-matrix, all segments would be dimension two.</p></div></div><div class="sec" id="ch_datamod.Score_Score_Of_An_Al"><h4><span class="title">Score: Score Of An Alignment Or Segment</span></h4><p>A Score contains an id (of type Object-id) which is meant to identify the method used to generate the score. It could be a string (e.g. "BLAST raw score", "BLAST p value") or an integer for use by a software system planning to process a number of defined values. The value of the Score is either an integer or real number. Both <span class="nctnt ncbi-type">Seq-align</span> and segment types allow more than one Score so that a variety of measures for the same alignment can be accommodated.</p></div><div class="sec" id="ch_datamod.Densediag_Segments_F"><h4><span class="title">Dense-diag: Segments For diags Seq-align</span></h4><p>A <span class="nctnt ncbi-type">Seq-align</span> of type <span class="nctnt ncbi-type">diags</span> represents a series of unconnected diagonals as a <span class="nctnt ncbi-type">SEQUENCE OF Dense-diag</span>. Since each <span class="nctnt ncbi-type">Dense-diag</span> is unrelated to the next the <span class="nctnt ncbi-type">SEQUENCE OF</span> just suggests a presentation order. It does not imply anything about the reasonableness of joining one <span class="nctnt ncbi-type">Dense-diag</span> to the next. In fact, for a multi-sequence comparison, each <span class="nctnt ncbi-type">Dense-diag</span> may have a different dimension and/or include <span class="nctnt ncbi-type">Bioseq</span>s not included by another <span class="nctnt ncbi-type">Dense-diag</span>.</p><p>A single <span class="nctnt ncbi-type">Dense-diag</span> defines its dimension with <span class="nctnt ncbi-type">dim</span>. There should be <span class="nctnt ncbi-type">dim</span> number of <span class="nctnt ncbi-type">Seq-id</span> in <span class="nctnt ncbi-type">ids</span>, indicating the <span class="nctnt ncbi-type">Bioseq</span>s involved in the segment, in order. There should be <span class="nctnt ncbi-type">dim</span> number of integers in <span class="nctnt ncbi-type">starts</span> (offsets into the <span class="nctnt ncbi-type">Bioseq</span>s, starting with 0, as in any <span class="nctnt ncbi-type">Seq-loc</span>) indicating the first (lowest numbered) residue of each <span class="nctnt ncbi-type">Bioseq</span> involved in the segment is, in the same order as <span class="nctnt ncbi-type">ids</span>. The <span class="nctnt ncbi-type">len</span> indicates the length of all <span class="nctnt ncbi-type">Bioseq</span>s in the segment. Thus the last residue involved in the segment for every <span class="nctnt ncbi-type">Bioseq</span> will be its <span class="nctnt ncbi-type">start</span> plus <span class="nctnt ncbi-type">len - 1</span>.</p><p>In the case of nucleic acids, if any or all of the segments are on the complement strand of the original <span class="nctnt ncbi-type">Bioseq</span>, then there should be <span class="nctnt ncbi-type">dim</span> number of Na-strand in <span class="nctnt ncbi-type">len</span> in the same order as <span class="nctnt ncbi-type">ids</span>, indicating which segments are on the plus or minus strands. The fact that a segment is on the minus strand or not does NOT affect the values chosen for <span class="nctnt ncbi-type">starts</span>. It is still the lowest numbered offset of a residue involved in the segment.</p><p>Clearly all <span class="nctnt ncbi-type">Bioseq</span> regions involved in a <span class="nctnt ncbi-type">Dense-diag</span> must have the same length, so this form does not allow stretching of one <span class="nctnt ncbi-type">Bioseq</span> compared to another, as may occur when comparing a genetic map <span class="nctnt ncbi-type">Bioseq</span> to a physical map or sequence <span class="nctnt ncbi-type">Bioseq</span>. In this case one would use <span class="nctnt ncbi-type">Std-seg</span>.</p></div><div class="sec" id="ch_datamod.Denseseg_Segments_fo"><h4><span class="title">Dense-seg: Segments for "global" or "partial" Seq-align</span></h4><p>A <span class="nctnt ncbi-type">Dense-seg</span> is a single entity which describes a complete global or partial alignment containing many segments. Like <span class="nctnt ncbi-type">Dense-diag</span> above, it is only appropriate when there is no stretching of the <span class="nctnt ncbi-type">Bioseq</span> coordinates relative to each other (as may happen when aligning a physical to a genetic map <span class="nctnt ncbi-type">Bioseq</span>). In that case, one would use a SEQUENCE OF <span class="nctnt ncbi-type">Std-seg</span>, described below.</p><p>A <span class="nctnt ncbi-type">Dense-seg</span> must give the dimension of the alignment in <span class="nctnt ncbi-type">dim</span> and the number of segments in the alignment in <span class="nctnt ncbi-type">numseg</span>. The <span class="nctnt ncbi-type">ids</span> slot must contain <span class="nctnt ncbi-type">dim</span> number of <span class="nctnt ncbi-type">Seq-id</span>s for the <span class="nctnt ncbi-type">Bioseq</span>s used in the alignment.</p><p>The <span class="nctnt ncbi-type">starts</span> slot contains the lowest numbered residue contained in each segment, in <span class="nctnt ncbi-type">ids</span> order. The <span class="nctnt ncbi-type">starts</span> slot should have <span class="nctnt ncbi-type">numseg</span> times <span class="nctnt ncbi-type">dim</span> integers, or the start of each <span class="nctnt ncbi-type">Bioseq</span> in the first segment in <span class="nctnt ncbi-type">ids</span> order, followed by the start of each <span class="nctnt ncbi-type">Bioseq</span> in the second segment in <span class="nctnt ncbi-type">ids</span> order and so on. A <span class="nctnt ncbi-type">start</span> of minus one indicates that the <span class="nctnt ncbi-type">Bioseq</span> is not present in the segment (i.e. a gap in a <span class="nctnt ncbi-type">Bioseq</span>).</p><p>The <span class="nctnt ncbi-type">lens</span> slot contains the length of each segment in segment order, so <span class="nctnt ncbi-type">lens</span> will contain <span class="nctnt ncbi-type">numseg</span> integers.</p><p>If any or all of the sequences are on the minus strand of the original <span class="nctnt ncbi-type">Bioseq</span>, then there should be <span class="nctnt ncbi-type">numseg</span> times <span class="nctnt ncbi-type">dim</span> Na-strand values in <span class="nctnt ncbi-type">len</span> in the same order as <span class="nctnt ncbi-type">starts</span>. Whether a sequence segment is on the plus or minus strand has <b>no</b> effect on the value selected for <span class="nctnt ncbi-type">starts</span>. It is <b>always</b> the lowest numbered residue included in the segment.</p><p>The <span class="nctnt ncbi-type">scores</span> is a <span class="nctnt ncbi-type">SEQUENCE OF Score</span>, one for each segment. So there should be <span class="nctnt ncbi-type">numseg Scores</span>, if <span class="nctnt ncbi-type">scores</span> is filled. A single <span class="nctnt ncbi-type">Score</span> for the whole alignment would appear in the <span class="nctnt ncbi-type">score</span> slot of the <span class="nctnt ncbi-type">Seq-align</span>.</p><p>The three dimensional alignment show above is repeated below, followed by its ASN.1 encoding into a <span class="nctnt ncbi-type">Seq-align</span> using <span class="nctnt ncbi-type">Dense-seg</span>. The <span class="nctnt ncbi-type">Seq-id</span>s are given in the ASN.1 as type "local".</p><pre>    Seq-ids<br /><br />    id=100        AAGGCCTTTTAGAGATGATGATGATGATGA<br />    id=200        AAGGCCTaTTAG.......GATGATGATGA<br />    id=300        ....CCTTTTAGAGATGATGAT....ATGA<br />                  | 1 |   2  |   3   |4| 5  | 6|  Segments<br /><br />Seq-align ::= {<br />    type global ,<br />    dim 3 ,<br />    segs denseg {<br />        dim 3 ,<br />        numseg 6 ,<br />        ids {<br />            local id 100 ,<br />            local id 200 ,<br />            local id 300 } ,<br />        starts { 0,0,-1, 4,4,0, 12,-1,8, 19,12,15, 22,15,-1, 26,19,18 } ,<br />        lens { 4, 8, 7, 3, 4, 4 } } }</pre></div><div class="sec" id="ch_datamod.Stdseg_Aligning_Any_"><h4><span class="title">Std-seg: Aligning Any Bioseq Type With Any Other</span></h4><p>A <span class="nctnt ncbi-type">SEQUENCE OF Std-seg</span> can be used to describe any <span class="nctnt ncbi-type">Seq-align</span> type on any types of <span class="nctnt ncbi-type">Bioseq</span>s. A <span class="nctnt ncbi-type">Std-seg</span> is very purely a collection of correlated <span class="nctnt ncbi-type">Seq-loc</span>s. There is no requirement that the length of each <span class="nctnt ncbi-type">Bioseq</span> in a segment be the same as the other members of the segment or that the same <span class="nctnt ncbi-type">Seq-loc</span> type be used for each member of the segment. This allows stretching of one <span class="nctnt ncbi-type">Bioseq</span> relative to the other(s) and potentially very complex descriptions of relationships between sequences.</p><p>Each <span class="nctnt ncbi-type">Std-seg</span> must give its dimension, so it can be used for <span class="nctnt ncbi-type">diags</span>. Optionally it can give the Seq-ids for the <span class="nctnt ncbi-type">Bioseq</span>s used in the segment (again a convenience for <span class="nctnt ncbi-type">Seq-align</span> of type <span class="nctnt ncbi-type">diags</span>). The <span class="nctnt ncbi-type">loc</span> slot gives the locations on the <span class="nctnt ncbi-type">Bioseq</span>s used in this segment. As usual, there is also a place for various <span class="nctnt ncbi-type">Score</span>(s) associated with the segment. The example given above is presented again, this time as a <span class="nctnt ncbi-type">Seq-align</span> using <span class="nctnt ncbi-type">Std-seg</span>s. Note the use of <span class="nctnt ncbi-type">Seq-loc</span> type "empty" to indicate a gap. Alternatively one could simply change the <span class="nctnt ncbi-type">dim</span> for each segment to exclude the <span class="nctnt ncbi-type">Bioseq</span>s not present in the segment, although this would require more interpretation by software.</p><pre>    Seq-ids<br />    id=100          AAGGCCTTTTAGAGATGATGATGATGATGA<br />    id=200          AAGGCCTaTTAG.......GATGATGATGA<br />    id=300          ....CCTTTTAGAGATGATGAT....ATGA<br />                    | 1 |   2  |   3   |4| 5  | 6|  Segments<br /><br />Seq-align ::= {<br />    type global ,<br />    dim 3 ,<br />    segs std {<br />        {<br />            dim 3 ,<br />            loc {<br />                int {<br />                    id local id 100 ,<br />                    from 0 ,<br />                    to 3<br />                } ,<br />                int {<br />                    id local id 200 ,<br />                    from 0 ,<br />                    to 3<br />                } ,<br />                empty local id 300<br />            }<br />        } ,<br />        {<br />            dim 3 ,<br />            loc {<br />                int {<br />                    id local id 100 ,<br />                    from 4 ,<br />                    to 11<br />                } ,<br />                int {<br />                    id local id 200 ,<br />                    from 4 ,<br />                    to 11<br />                } ,<br />                int {<br />                    id local id 300 ,<br />                    from 0 ,<br />                    to 7<br />                }<br />            }<br />        } ,<br />        {<br />            dim 3 ,<br />            loc {<br />                int {<br />                    id local id 100 ,<br />                    from 12 ,<br />                    to 18<br />                } ,<br />                empty local id 200 ,<br />                int {<br />                    id local id 300 ,<br />                    from 8 ,<br />                    to 14<br />                }<br />            }<br />        } ,<br />        {<br />            dim 3 ,<br />            loc {<br />                int {<br />                    id local id 100 ,<br />                    from 19 ,<br />                    to 21<br />                } ,<br />                int {<br />                    id local id 200 ,<br />                    from 12 ,<br />                    to 14<br />                } ,<br />                int {<br />                    id local id 300 ,<br />                    from 15 ,<br />                    to 17<br />                }<br />            }<br />        } ,<br />        {<br />            dim 3 ,<br />            loc {<br />                int {<br />                    id local id 100 ,<br />                    from 22 ,<br />                    to 25<br />                } ,<br />                int {<br />                    id local id 200 ,<br />                    from 15 ,<br />                    to 18<br />                } ,<br />                empty local id 300<br />            }<br />        } ,<br />        {<br />            dim 3 ,<br />            loc {<br />                int {<br />                    id local id 100 ,<br />                    from 26 ,<br />                    to 29<br />                } ,<br />                int {<br />                    id local id 200 ,<br />                    from 19 ,<br />                    to 22<br />                } ,<br />                int {<br />                    id local id 300 ,<br />                    from 18 ,<br />                    to 21<br />                }<br />            }<br />        }<br />    }<br />}</pre><p>Clearly the <span class="nctnt ncbi-type">Std-seg</span> method should only be used when its flexibility is required. Nonetheless, there is no ready substitute for <span class="nctnt ncbi-type">Std-seg</span> when flexibility is demanded.</p></div><div class="sec" id="ch_datamod.C_Implementation_Not"><h4><span class="title">C++ Implementation Notes</span></h4><p>The C++ Toolkit adds several methods to the classes generated from ASN.1 specifications to simplify alignment data access and manipulation. The <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCSeq__align.html">CSeq_align</a> class has methods returning <span class="nctnt ncbi-type">Seq-id</span>, start, stop, and strand for a particular alignment row, regardless of its representation; it allows swapping alignment rows or converting the alignment from one type to another. The <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml/classCDense__seg.html">CDense_seg</a> class extends the default set of alignment members with sequence character width (1 or 3, depending on molecule type).</p></div></div></div><div class="sec" id="ch_datamod.datamodel.seqres"><h2><span class="title">Sequence Graphs</span></h2><p> The Sequence Graphs section describes the Seq-graph type used to associate some analytical data with a region on a Bioseq. The type definition is located in the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/seqres/seqres.asn">seqres.asn</a> module.</p><ul><li><p><a href="ch_datamod.html#ch_datamod._Introduction_9">Introduction</a></p></li><li><p><a href="ch_datamod.html#ch_datamod.Seqgraph_Graph_on_a_">Seq-graph: Graph on a Bioseq</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_s_11">ASN.1 Specification: seqres.asn</a></p></li></ul><div class="sec" id="ch_datamod._Introduction_9"><h3><span class="title">Introduction</span></h3><p>Analytical tools can attach results to Bioseqs in named collections as Seq-annots. This allows analytical programs developed from various sources to add information to a standard object (the Bioseq) and then let a single program designed for displaying a Bioseq and its associated information show the analytical results in an integrated fashion. Feature tables have been discussed previously, and can serve as the vehicle for results from restriction mapping programs, motif searching programs, open reading frame locators, and so on. Alignment programs and curator tools can produce Seq-annots containing Seq-aligns. In this chapter we present the third annotation type, a graph, which can be used to show properties like G+C content, surface potential, hydrophobicity, and so on.</p></div><div class="sec" id="ch_datamod.Seqgraph_Graph_on_a_"><h3><span class="title">Seq-graph: Graph on a Bioseq</span></h3><p>A Seq-graph defines some continuous set of values over a defined interval on a Bioseq. It has slots for a title and a comment. The "loc" field defines the region of the Bioseq to which the graph applies. Titles can be given for the X (graph value) axis and/or the Y (sequence axis) of the graph. The "comp" slot allows a compression to supplied (i.e. how many residues are represented by a single value of the graph?). Compression is assumed to be one otherwise. Scaling values, a and b can be used to scale the values given in the Seq-graph to those displayed on the graph (by the formula "display value" = (a times "graph value") plus b). Finally, the number of values in the graph must be given (and should agree with the length of "loc" divided by "comp").</p><p>The graphs themselves can be coded as byte, integer, or real values. Each type defines the maximum and minimum values to show on the graph (no given values need necessarily reach the maximum or minimum) and the value along which to draw the X axis of the graph.</p></div></div><div class="sec" id="ch_datamod.Common_ASN1_Specifications"><h2><span class="title">Common ASN.1 Specifications</span></h2><p>Following are the ASN.1 specifications referenced in this chapter:</p><ul><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_g">general.asn</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_b_1">biblio.asn</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_p_2">pub.asn</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_m_3">medline.asn</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_s_4">seq.asn</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_s_5">seqblock.asn</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_s_6">seqcode.asn</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_s_7">seqset.asn</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_s_8">seqloc.asn</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_s_9">seqfeat.asn</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_s_10">seqalign.asn</a></p></li><li><p><a href="ch_datamod.html#ch_datamod._ASN1_Specification_s_11">seqres.asn</a></p></li></ul><div class="sec" id="ch_datamod._ASN1_Specification_g"><h3><span class="title">ASN.1 Specification: general.asn</span></h3><p>See also the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/general/general.asn">online-version</a> of this specification, which may be more up-to-date.</p><pre>--$Revision$<br />--**********************************************************************<br />--<br />--  NCBI General Data elements<br />--  by James Ostell, 1990<br />--  Version 3.0 - June 1994<br />--<br />--**********************************************************************<br /><br />NCBI-General DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS Date, Person-id, Object-id, Dbtag, Int-fuzz, User-object, User-field;<br /><br />-- StringStore is really a VisibleString.  It is used to define very<br />--   long strings which may need to be stored by the receiving program<br />--   in special structures, such as a ByteStore, but it's just a hint.<br />--   AsnTool stores StringStores in ByteStore structures.<br />-- OCTET STRINGs are also stored in ByteStores by AsnTool<br />-- <br />-- typedef struct bsunit {             /* for building multiline strings */<br />   -- Nlm_Handle str;            /* the string piece */<br />   -- Nlm_Int2 len_avail,<br />       -- len;<br />   -- struct bsunit PNTR next; }       /* the next one */<br />-- Nlm_BSUnit, PNTR Nlm_BSUnitPtr;<br />-- <br />-- typedef struct bytestore {<br />   -- Nlm_Int4 seekptr,       /* current position */<br />      -- totlen,             /* total stored data length in bytes */<br />      -- chain_offset;       /* offset in ByteStore of first byte in curchain */<br />   -- Nlm_BSUnitPtr chain,       /* chain of elements */<br />      -- curchain;           /* the BSUnit containing seekptr */<br />-- } Nlm_ByteStore, PNTR Nlm_ByteStorePtr;<br />--<br />-- AsnTool incorporates this as a primitive type, so the definition<br />--   is here just for completeness<br />-- <br />--  StringStore ::= [APPLICATION 1] IMPLICIT OCTET STRING<br />--<br /><br />-- BigInt is really an INTEGER. It is used to warn the receiving code to expect<br />--   a value bigger than Int4 (actually Int8). It will be stored in DataVal.bigintvalue<br />--<br />--   Like StringStore, AsnTool incorporates it as a primitive. The definition would be:<br />--   BigInt ::= [APPLICATION 2] IMPLICIT INTEGER<br />--<br /><br />-- Date is used to replace the (overly complex) UTCTtime, GeneralizedTime<br />--  of ASN.1<br />--  It stores only a date<br />--<br /><br />Date ::= CHOICE {<br />    str VisibleString ,        -- for those unparsed dates<br />    std Date-std }             -- use this if you can<br /><br />Date-std ::= SEQUENCE {        -- NOTE: this is NOT a unix tm struct<br />    year INTEGER ,             -- full year (including 1900)<br />    month INTEGER OPTIONAL ,   -- month (1-12)<br />    day INTEGER OPTIONAL ,     -- day of month (1-31)<br />    season VisibleString OPTIONAL ,  -- for "spring", "may-june", etc<br />    hour INTEGER OPTIONAL ,    -- hour of day (0-23)<br />    minute INTEGER OPTIONAL ,  -- minute of hour (0-59)<br />    second INTEGER OPTIONAL }  -- second of minute (0-59)<br /><br />-- Dbtag is generalized for tagging<br />-- eg. { "Social Security", str "023-79-8841" }<br />-- or  { "member", id 8882224 }<br /><br />Dbtag ::= SEQUENCE {<br />    db VisibleString ,          -- name of database or system<br />    tag Object-id }         -- appropriate tag<br /><br />-- Object-id can tag or name anything<br />--<br /><br />Object-id ::= CHOICE {<br />    id INTEGER ,<br />    str VisibleString }<br /><br />-- Person-id is to define a std element for people<br />--<br /><br />Person-id ::= CHOICE {<br />    dbtag Dbtag ,               -- any defined database tag<br />    name Name-std ,             -- structured name<br />    ml VisibleString ,          -- MEDLINE name (semi-structured)<br />                                --    eg. "Jones RM"<br />    str VisibleString,          -- unstructured name<br />    consortium VisibleString }  -- consortium name<br /><br />Name-std ::= SEQUENCE { -- Structured names<br />    last VisibleString ,<br />    first VisibleString OPTIONAL ,<br />    middle VisibleString OPTIONAL ,<br />    full VisibleString OPTIONAL ,    -- full name eg. "J. John Smith, Esq"<br />    initials VisibleString OPTIONAL,  -- first + middle initials<br />    suffix VisibleString OPTIONAL ,   -- Jr, Sr, III<br />    title VisibleString OPTIONAL }    -- Dr., Sister, etc<br /><br />--**** Int-fuzz **********************************************<br />--*<br />--*   uncertainties in integer values<br /><br />Int-fuzz ::= CHOICE {<br />    p-m INTEGER ,                    -- plus or minus fixed amount<br />    range SEQUENCE {                 -- max to min<br />        max INTEGER ,<br />        min INTEGER } ,<br />    pct INTEGER ,                    -- % plus or minus (x10) 0-1000<br />    lim ENUMERATED {                 -- some limit value<br />        unk (0) ,                    -- unknown<br />        gt (1) ,                     -- greater than<br />        lt (2) ,                     -- less than<br />        tr (3) ,                     -- space to right of position<br />        tl (4) ,                     -- space to left of position<br />        circle (5) ,                 -- artificial break at origin of circle<br />        other (255) } ,              -- something else<br />    alt SET OF INTEGER }             -- set of alternatives for the integer<br /><br /><br />--**** User-object **********************************************<br />--*<br />--*   a general object for a user defined structured data item<br />--*    used by Seq-feat and Seq-descr<br /><br />User-object ::= SEQUENCE {<br />    class VisibleString OPTIONAL ,   -- endeavor which designed this object<br />    type Object-id ,                 -- type of object within class<br />    data SEQUENCE OF User-field }    -- the object itself<br /><br />User-field ::= SEQUENCE {<br />    label Object-id ,                -- field label<br />    num INTEGER OPTIONAL ,           -- required for strs, ints, reals, oss<br />    data CHOICE {                    -- field contents<br />        str VisibleString ,<br />        int INTEGER ,<br />        real REAL ,<br />        bool BOOLEAN ,<br />        os OCTET STRING ,<br />        object User-object ,         -- for using other definitions<br />        strs SEQUENCE OF VisibleString ,<br />        ints SEQUENCE OF INTEGER ,<br />        reals SEQUENCE OF REAL ,<br />        oss SEQUENCE OF OCTET STRING ,<br />        fields SEQUENCE OF User-field ,<br />        objects SEQUENCE OF User-object } }<br /><br /><br /><br />END</pre></div><div class="sec" id="ch_datamod._ASN1_Specification_b_1"><h3><span class="title">ASN.1 Specification: biblio.asn</span></h3><p>See also the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/biblio/biblio.asn">online-version</a> of this specification, which may be more up-to-date.</p><pre>--$Revision$<br />--****************************************************************<br />--<br />--  NCBI Bibliographic data elements<br />--  by James Ostell, 1990<br />--<br />--  Taken from the American National Standard for<br />--      Bibliographic References<br />--      ANSI Z39.29-1977<br />--  Version 3.0 - June 1994<br />--  PubMedId added in 1996<br />--  ArticleIds and eprint elements added in 1999<br />--<br />--****************************************************************<br /><br />NCBI-Biblio DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS Cit-art, Cit-jour, Cit-book, Cit-pat, Cit-let, Id-pat, Cit-gen,<br />        Cit-proc, Cit-sub, Title, Author, PubMedId;<br /><br />IMPORTS Person-id, Date, Dbtag FROM NCBI-General;<br /><br />    -- Article Ids<br /><br />ArticleId ::= CHOICE {         -- can be many ids for an article<br />    pubmed PubMedId ,      -- see types below<br />    medline MedlineUID ,<br />    doi DOI ,<br />    pii PII ,<br />    pmcid PmcID ,<br />    pmcpid PmcPid ,<br />        pmpid PmPid ,<br />        other Dbtag  }    -- generic catch all<br /><br />PubMedId ::= INTEGER           -- Id from the PubMed database at NCBI<br />MedlineUID ::= INTEGER         -- Id from MEDLINE<br />DOI ::= VisibleString          -- Document Object Identifier<br />PII ::= VisibleString          -- Controlled Publisher Identifier<br />PmcID ::= INTEGER              -- PubMed Central Id<br />PmcPid ::= VisibleString       -- Publisher Id supplied to PubMed Central<br />PmPid ::= VisibleString        -- Publisher Id supplied to PubMed<br /><br />ArticleIdSet ::= SET OF ArticleId<br /><br />    -- Status Dates<br /><br />PubStatus ::= INTEGER {        -- points of publication<br />    received  (1) ,            -- date manuscript received for review<br />    accepted  (2) ,            -- accepted for publication<br />    epublish  (3) ,            -- published electronically by publisher<br />    ppublish  (4) ,            -- published in print by publisher<br />    revised   (5) ,            -- article revised by publisher/author<br />    pmc       (6) ,            -- article first appeared in PubMed Central<br />    pmcr      (7) ,            -- article revision in PubMed Central<br />    pubmed    (8) ,            -- article citation first appeared in PubMed<br />    pubmedr   (9) ,            -- article citation revision in PubMed<br />    aheadofprint (10),         -- epublish, but will be followed by print<br />    premedline (11),           -- date into PreMedline status<br />    medline    (12),           -- date made a MEDLINE record<br />    other    (255) }<br /><br />PubStatusDate ::= SEQUENCE {   -- done as a structure so fields can be added<br />    pubstatus PubStatus ,<br />    date Date }                -- time may be added later<br /><br />PubStatusDateSet ::= SET OF PubStatusDate<br /><br />    -- Citation Types<br /><br />Cit-art ::= SEQUENCE {                  -- article in journal or book<br />    title Title OPTIONAL ,              -- title of paper (ANSI requires)<br />    authors Auth-list OPTIONAL ,        -- authors (ANSI requires)<br />    from CHOICE {                       -- journal or book<br />        journal Cit-jour ,<br />        book Cit-book ,<br />        proc Cit-proc } ,<br />    ids ArticleIdSet OPTIONAL }         -- lots of ids<br /><br />Cit-jour ::= SEQUENCE {             -- Journal citation<br />    title Title ,                   -- title of journal<br />    imp Imprint }<br /><br />Cit-book ::= SEQUENCE {              -- Book citation<br />    title Title ,                    -- Title of book<br />    coll Title OPTIONAL ,            -- part of a collection<br />    authors Auth-list,               -- authors<br />    imp Imprint }<br /><br />Cit-proc ::= SEQUENCE {             -- Meeting proceedings<br />    book Cit-book ,                 -- citation to meeting<br />    meet Meeting }                  -- time and location of meeting<br /><br />    -- Patent number and date-issue were made optional in 1997 to<br />    --   support patent applications being issued from the USPTO<br />    --   Semantically a Cit-pat must have either a patent number or<br />    --   an application number (or both) to be valid<br /><br />Cit-pat ::= SEQUENCE {                  -- patent citation<br />    title VisibleString ,<br />    authors Auth-list,                  -- author/inventor<br />    country VisibleString ,             -- Patent Document Country<br />    doc-type VisibleString ,            -- Patent Document Type<br />    number VisibleString OPTIONAL,      -- Patent Document Number<br />    date-issue Date OPTIONAL,           -- Patent Issue/Pub Date<br />    class SEQUENCE OF VisibleString OPTIONAL ,      -- Patent Doc Class Code<br />    app-number VisibleString OPTIONAL , -- Patent Doc Appl Number<br />    app-date Date OPTIONAL ,            -- Patent Appl File Date<br />    applicants Auth-list OPTIONAL ,     -- Applicants<br />    assignees Auth-list OPTIONAL ,      -- Assignees<br />    priority SEQUENCE OF Patent-priority OPTIONAL , -- Priorities<br />    abstract VisibleString OPTIONAL }   -- abstract of patent<br /><br />Patent-priority ::= SEQUENCE {<br />    country VisibleString ,             -- Patent country code<br />    number VisibleString ,              -- number assigned in that country<br />    date Date }                         -- date of application<br /><br />Id-pat ::= SEQUENCE {                   -- just to identify a patent<br />    country VisibleString ,             -- Patent Document Country<br />    id CHOICE {<br />        number VisibleString ,          -- Patent Document Number<br />        app-number VisibleString } ,    -- Patent Doc Appl Number<br />    doc-type VisibleString OPTIONAL }   -- Patent Doc Type<br /><br />Cit-let ::= SEQUENCE {                  -- letter, thesis, or manuscript<br />    cit Cit-book ,                      -- same fields as a book<br />    man-id VisibleString OPTIONAL ,     -- Manuscript identifier<br />    type ENUMERATED {<br />        manuscript (1) ,<br />        letter (2) ,<br />        thesis (3) } OPTIONAL }<br />                                -- NOTE: this is just to cite a<br />                                -- direct data submission, see NCBI-Submit<br />                                -- for the form of a sequence submission<br />Cit-sub ::= SEQUENCE {          -- citation for a direct submission<br />    authors Auth-list ,         -- not necessarily authors of the paper<br />    imp Imprint OPTIONAL ,      -- this only used to get date.. will go<br />    medium ENUMERATED {         -- medium of submission<br />        paper   (1) ,<br />        tape    (2) ,<br />        floppy  (3) ,<br />        email   (4) ,<br />        other   (255) } OPTIONAL ,<br />    date Date OPTIONAL ,              -- replaces imp, will become required<br />    descr VisibleString OPTIONAL }    -- description of changes for public view<br /><br />Cit-gen ::= SEQUENCE {      -- NOT from ANSI, this is a catchall<br />    cit VisibleString OPTIONAL ,     -- anything, not parsable<br />    authors Auth-list OPTIONAL ,<br />    muid INTEGER OPTIONAL ,      -- medline uid<br />    journal Title OPTIONAL ,<br />    volume VisibleString OPTIONAL ,<br />    issue VisibleString OPTIONAL ,<br />    pages VisibleString OPTIONAL ,<br />    date Date OPTIONAL ,<br />    serial-number INTEGER OPTIONAL ,   -- for GenBank style references<br />    title VisibleString OPTIONAL ,     -- eg. cit="unpublished",title="title"<br />    pmid PubMedId OPTIONAL }           -- PubMed Id<br /><br /><br />    -- Authorship Group<br />Auth-list ::= SEQUENCE {<br />        names CHOICE {<br />            std SEQUENCE OF Author ,        -- full citations<br />            ml SEQUENCE OF VisibleString ,  -- MEDLINE, semi-structured<br />            str SEQUENCE OF VisibleString } , -- free for all<br />        affil Affil OPTIONAL }        -- author affiliation<br /><br />Author ::= SEQUENCE {<br />    name Person-id ,                        -- Author, Primary or Secondary<br />    level ENUMERATED {<br />        primary (1),<br />        secondary (2) } OPTIONAL ,<br />    role ENUMERATED {                   -- Author Role Indicator<br />        compiler (1),<br />        editor (2),<br />        patent-assignee (3),<br />        translator (4) } OPTIONAL ,<br />    affil Affil OPTIONAL ,<br />    is-corr BOOLEAN OPTIONAL }          -- TRUE if corresponding author<br /><br />Affil ::= CHOICE {<br />    str VisibleString ,                 -- unparsed string<br />    std SEQUENCE {                      -- std representation<br />    affil VisibleString OPTIONAL ,      -- Author Affiliation, Name<br />    div VisibleString OPTIONAL ,        -- Author Affiliation, Division<br />    city VisibleString OPTIONAL ,       -- Author Affiliation, City<br />    sub VisibleString OPTIONAL ,        -- Author Affiliation, County Sub<br />    country VisibleString OPTIONAL ,    -- Author Affiliation, Country<br />    street VisibleString OPTIONAL ,    -- street address, not ANSI<br />    email VisibleString OPTIONAL ,<br />    fax VisibleString OPTIONAL ,<br />    phone VisibleString OPTIONAL ,<br />    postal-code VisibleString OPTIONAL }}<br /><br />    -- Title Group<br />    -- Valid for = A = Analytic (Cit-art)<br />    --             J = Journals (Cit-jour)<br />    --             B = Book (Cit-book)<br />                                                 -- Valid for:<br />Title ::= SET OF CHOICE {<br />    name VisibleString ,    -- Title, Anal,Coll,Mono    AJB<br />    tsub VisibleString ,    -- Title, Subordinate       A B<br />    trans VisibleString ,   -- Title, Translated        AJB<br />    jta VisibleString ,     -- Title, Abbreviated        J<br />    iso-jta VisibleString , -- specifically ISO jta      J<br />    ml-jta VisibleString ,  -- specifically MEDLINE jta  J<br />    coden VisibleString ,   -- a coden                   J<br />    issn VisibleString ,    -- ISSN                      J<br />    abr VisibleString ,     -- Title, Abbreviated         B<br />    isbn VisibleString }    -- ISBN                       B<br /><br />Imprint ::= SEQUENCE {                  -- Imprint group<br />    date Date ,                         -- date of publication<br />    volume VisibleString OPTIONAL ,<br />    issue VisibleString OPTIONAL ,<br />    pages VisibleString OPTIONAL ,<br />    section VisibleString OPTIONAL ,<br />    pub Affil OPTIONAL,                     -- publisher, required for book<br />    cprt Date OPTIONAL,                     -- copyright date, "    "   "<br />    part-sup VisibleString OPTIONAL ,       -- part/sup of volume<br />    language VisibleString DEFAULT "ENG" ,  -- put here for simplicity<br />    prepub ENUMERATED {                     -- for prepublication citations<br />        submitted (1) ,                     -- submitted, not accepted<br />        in-press (2) ,                      -- accepted, not published<br />        other (255)  } OPTIONAL ,<br />    part-supi VisibleString OPTIONAL ,      -- part/sup on issue<br />    retract CitRetract OPTIONAL ,           -- retraction info<br />    pubstatus PubStatus OPTIONAL ,          -- current status of this publication<br />    history PubStatusDateSet OPTIONAL }     -- dates for this record<br /><br />CitRetract ::= SEQUENCE {<br />    type ENUMERATED {                    -- retraction of an entry<br />        retracted (1) ,               -- this citation retracted<br />        notice (2) ,                  -- this citation is a retraction notice<br />        in-error (3) ,                -- an erratum was published about this<br />        erratum (4) } ,               -- this is a published erratum<br />    exp VisibleString OPTIONAL }      -- citation and/or explanation<br /><br />Meeting ::= SEQUENCE {<br />    number VisibleString ,<br />    date Date ,<br />    place Affil OPTIONAL }<br /><br />END</pre></div><div class="sec" id="ch_datamod._ASN1_Specification_p_2"><h3><span class="title">ASN.1 Specification: pub.asn</span></h3><p>See also the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/pub/pub.asn">online-version</a> of this specification, which may be more up-to-date.</p><pre>--$Revision$<br />--********************************************************************<br />--<br />--  Publication common set<br />--  James Ostell, 1990<br />--<br />--  This is the base class definitions for Publications of all sorts<br />--<br />--  support for PubMedId added in 1996<br />--********************************************************************<br /><br />NCBI-Pub DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS Pub, Pub-set, Pub-equiv;<br /><br />IMPORTS Medline-entry FROM NCBI-Medline<br />        Cit-art, Cit-jour, Cit-book, Cit-proc, Cit-pat, Id-pat, Cit-gen,<br />        Cit-let, Cit-sub, PubMedId FROM NCBI-Biblio;<br /><br />Pub ::= CHOICE {<br />    gen Cit-gen ,        -- general or generic unparsed<br />    sub Cit-sub ,        -- submission<br />    medline Medline-entry ,<br />    muid INTEGER ,       -- medline uid<br />    article Cit-art ,<br />    journal Cit-jour ,<br />    book Cit-book ,<br />    proc Cit-proc ,      -- proceedings of a meeting<br />    patent Cit-pat ,<br />    pat-id Id-pat ,      -- identify a patent<br />    man Cit-let ,        -- manuscript, thesis, or letter<br />    equiv Pub-equiv,     -- to cite a variety of ways<br />    pmid PubMedId }      -- PubMedId<br /><br />Pub-equiv ::= SET OF Pub   -- equivalent identifiers for same citation<br /><br />Pub-set ::= CHOICE {<br />    pub SET OF Pub ,<br />    medline SET OF Medline-entry ,<br />    article SET OF Cit-art ,<br />    journal SET OF Cit-jour ,<br />    book SET OF Cit-book ,<br />    proc SET OF Cit-proc ,      -- proceedings of a meeting<br />    patent SET OF Cit-pat }<br /><br />END</pre></div><div class="sec" id="ch_datamod._ASN1_Specification_m_3"><h3><span class="title">ASN.1 Specification: medline.asn</span></h3><p>See also the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/medline/medline.asn">online-version</a> of this specification, which may be more up-to-date.</p><pre>--$Revision$<br />--**********************************************************************<br />--<br />--  MEDLINE data definitions<br />--  James Ostell, 1990<br />--<br />--  enhanced in 1996 to support PubMed records as well by simply adding<br />--    the PubMedId and making MedlineId optional<br />--<br />--**********************************************************************<br /><br />NCBI-Medline DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS Medline-entry, Medline-si;<br /><br />IMPORTS Cit-art, PubMedId FROM NCBI-Biblio<br />        Date FROM NCBI-General;<br /><br />                                -- a MEDLINE or PubMed entry<br />Medline-entry ::= SEQUENCE {<br />    uid INTEGER OPTIONAL ,      -- MEDLINE UID, sometimes not yet available if from PubMed<br />    em Date ,                   -- Entry Month<br />    cit Cit-art ,               -- article citation<br />    abstract VisibleString OPTIONAL ,<br />    mesh SET OF Medline-mesh OPTIONAL ,<br />    substance SET OF Medline-rn OPTIONAL ,<br />    xref SET OF Medline-si OPTIONAL ,<br />    idnum SET OF VisibleString OPTIONAL ,  -- ID Number (grants, contracts)<br />    gene SET OF VisibleString OPTIONAL ,<br />    pmid PubMedId OPTIONAL ,               -- MEDLINE records may include the PubMedId<br />    pub-type SET OF VisibleString OPTIONAL, -- may show publication types (review, etc)<br />    mlfield SET OF Medline-field OPTIONAL ,  -- additional Medline field types<br />    status INTEGER {<br />    publisher (1) ,      -- record as supplied by publisher<br />    premedline (2) ,     -- premedline record<br />    medline (3) } DEFAULT medline }  -- regular medline record<br /><br />Medline-mesh ::= SEQUENCE {<br />    mp BOOLEAN DEFAULT FALSE ,       -- TRUE if main point (*)<br />    term VisibleString ,                   -- the MeSH term<br />    qual SET OF Medline-qual OPTIONAL }    -- qualifiers<br /><br />Medline-qual ::= SEQUENCE {<br />    mp BOOLEAN DEFAULT FALSE ,       -- TRUE if main point<br />    subh VisibleString }             -- the subheading<br /><br />Medline-rn ::= SEQUENCE {       -- medline substance records<br />    type ENUMERATED {           -- type of record<br />        nameonly (0) ,<br />        cas (1) ,               -- CAS number<br />        ec (2) } ,              -- EC number<br />    cit VisibleString OPTIONAL ,  -- CAS or EC number if present<br />    name VisibleString }          -- name (always present)<br /><br />Medline-si ::= SEQUENCE {       -- medline cross reference records<br />    type ENUMERATED {           -- type of xref<br />        ddbj (1) ,              -- DNA Data Bank of Japan<br />        carbbank (2) ,          -- Carbohydrate Structure Database<br />        embl (3) ,              -- EMBL Data Library<br />        hdb (4) ,               -- Hybridoma Data Bank<br />        genbank (5) ,           -- GenBank<br />        hgml (6) ,              -- Human Gene Map Library<br />        mim (7) ,               -- Mendelian Inheritance in Man<br />        msd (8) ,               -- Microbial Strains Database<br />        pdb (9) ,               -- Protein Data Bank (Brookhaven)<br />        pir (10) ,              -- Protein Identification Resource<br />        prfseqdb (11) ,         -- Protein Research Foundation (Japan)<br />        psd (12) ,              -- Protein Sequence Database (Japan)<br />        swissprot (13) ,        -- SwissProt<br />        gdb (14) } ,            -- Genome Data Base<br />    cit VisibleString OPTIONAL }    -- the citation/accession number<br /><br />Medline-field ::= SEQUENCE {<br />    type INTEGER {              -- Keyed type<br />        other (0) ,             -- look in line code<br />        comment (1) ,           -- comment line<br />        erratum (2) } ,         -- retracted, corrected, etc<br />    str VisibleString ,         -- the text<br />    ids SEQUENCE OF DocRef OPTIONAL }  -- pointers relevant to this text<br /><br />DocRef ::= SEQUENCE {           -- reference to a document<br />    type INTEGER {<br />        medline (1) ,<br />        pubmed (2) ,<br />        ncbigi (3) } ,<br />    uid INTEGER }<br /><br />END</pre></div><div class="sec" id="ch_datamod._ASN1_Specification_s_4"><h3><span class="title">ASN.1 Specification: seq.asn</span></h3><p>See also the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/seq/seq.asn">online-version</a> of this specification, which may be more up-to-date.</p><pre>--$Revision$<br />--**********************************************************************<br />--<br />--  NCBI Sequence elements<br />--  by James Ostell, 1990<br />--  Version 3.0 - June 1994<br />--<br />--**********************************************************************<br /><br />NCBI-Sequence DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS Annotdesc, Annot-descr, Bioseq, GIBB-mol, Heterogen, MolInfo,<br />        Numbering, Pubdesc, Seq-annot, Seq-data, Seqdesc, Seq-descr, Seq-ext,<br />        Seq-hist, Seq-inst, Seq-literal, Seqdesc, Delta-ext, Seq-gap;<br /><br />IMPORTS Date, Int-fuzz, Dbtag, Object-id, User-object FROM NCBI-General<br />        Seq-align FROM NCBI-Seqalign<br />        Seq-feat FROM NCBI-Seqfeat<br />        Seq-graph FROM NCBI-Seqres<br />        Pub-equiv FROM NCBI-Pub<br />        Org-ref FROM NCBI-Organism<br />        BioSource FROM NCBI-BioSource<br />        Seq-id, Seq-loc FROM NCBI-Seqloc<br />        GB-block FROM GenBank-General<br />        PIR-block FROM PIR-General<br />        EMBL-block FROM EMBL-General<br />        SP-block FROM SP-General<br />        PRF-block FROM PRF-General<br />        PDB-block FROM PDB-General<br />        Seq-table FROM NCBI-SeqTable;<br /><br />--*** Sequence ********************************<br />--*<br /><br />Bioseq ::= SEQUENCE {<br />    id SET OF Seq-id ,            -- equivalent identifiers<br />    descr Seq-descr OPTIONAL , -- descriptors<br />    inst Seq-inst ,            -- the sequence data<br />    annot SET OF Seq-annot OPTIONAL }<br /><br />--*** Descriptors *****************************<br />--*<br /><br />Seq-descr ::= SET OF Seqdesc<br /><br />Seqdesc ::= CHOICE {<br />    mol-type GIBB-mol ,          -- type of molecule<br />    modif SET OF GIBB-mod ,             -- modifiers<br />    method GIBB-method ,         -- sequencing method<br />    name VisibleString ,         -- a name for this sequence<br />    title VisibleString ,        -- a title for this sequence<br />    org Org-ref ,                -- if all from one organism<br />    comment VisibleString ,      -- a more extensive comment<br />    num Numbering ,              -- a numbering system<br />    maploc Dbtag ,               -- map location of this sequence<br />    pir PIR-block ,              -- PIR specific info<br />    genbank GB-block ,           -- GenBank specific info<br />    pub Pubdesc ,                -- a reference to the publication<br />    region VisibleString ,       -- overall region (globin locus)<br />    user User-object ,           -- user defined object<br />    sp SP-block ,                -- SWISSPROT specific info<br />    dbxref Dbtag ,               -- xref to other databases<br />    embl EMBL-block ,            -- EMBL specific information<br />    create-date Date ,           -- date entry first created/released<br />    update-date Date ,           -- date of last update<br />    prf PRF-block ,              -- PRF specific information<br />    pdb PDB-block ,              -- PDB specific information<br />    het Heterogen ,              -- cofactor, etc associated but not bound<br />    source BioSource ,           -- source of materials, includes Org-ref<br />    molinfo MolInfo }            -- info on the molecule and techniques<br /><br />--******* NOTE:<br />--*       mol-type, modif, method, and org are consolidated and expanded<br />--*       in Org-ref, BioSource, and MolInfo in this specification. They<br />--*       will be removed in later specifications. Do not use them in the<br />--*       the future. Instead expect the new structures.<br />--*<br />--***************************<br /><br />--********************************************************************<br />--<br />-- MolInfo gives information on the<br />-- classification of the type and quality of the sequence<br />--<br />-- WARNING: this will replace GIBB-mol, GIBB-mod, GIBB-method<br />--<br />--********************************************************************<br /><br />MolInfo ::= SEQUENCE {<br />    biomol INTEGER {<br />        unknown (0) ,<br />        genomic (1) ,<br />        pre-RNA (2) ,              -- precursor RNA of any sort really <br />        mRNA (3) ,<br />        rRNA (4) ,<br />        tRNA (5) ,<br />        snRNA (6) ,<br />        scRNA (7) ,<br />        peptide (8) ,<br />        other-genetic (9) ,      -- other genetic material<br />        genomic-mRNA (10) ,      -- reported a mix of genomic and cdna sequence<br />        cRNA (11) ,              -- viral RNA genome copy intermediate<br />        snoRNA (12) ,            -- small nucleolar RNA<br />        transcribed-RNA (13) ,   -- transcribed RNA other than existing classes<br />        ncRNA (14) ,<br />        tmRNA (15) ,<br />        other (255) } DEFAULT unknown ,<br />    tech INTEGER {<br />        unknown (0) ,<br />        standard (1) ,          -- standard sequencing<br />        est (2) ,               -- Expressed Sequence Tag<br />        sts (3) ,               -- Sequence Tagged Site<br />        survey (4) ,            -- one-pass genomic sequence<br />        genemap (5) ,           -- from genetic mapping techniques<br />        physmap (6) ,           -- from physical mapping techniques<br />        derived (7) ,           -- derived from other data, not a primary entity<br />        concept-trans (8) ,     -- conceptual translation<br />        seq-pept (9) ,          -- peptide was sequenced<br />        both (10) ,             -- concept transl. w/ partial pept. seq.<br />        seq-pept-overlap (11) , -- sequenced peptide, ordered by overlap<br />        seq-pept-homol (12) ,   -- sequenced peptide, ordered by homology<br />        concept-trans-a (13) ,  -- conceptual transl. supplied by author<br />        htgs-1 (14) ,           -- unordered High Throughput sequence contig<br />        htgs-2 (15) ,           -- ordered High Throughput sequence contig<br />        htgs-3 (16) ,           -- finished High Throughput sequence<br />        fli-cdna (17) ,         -- full length insert cDNA<br />        htgs-0 (18) ,           -- single genomic reads for coordination<br />        htc (19) ,              -- high throughput cDNA<br />        wgs (20) ,              -- whole genome shotgun sequencing<br />        barcode (21) ,          -- barcode of life project<br />        composite-wgs-htgs (22) , -- composite of WGS and HTGS<br />        tsa (23) ,              -- transcriptome shotgun assembly<br />        other (255) }           -- use Source.techexp<br />               DEFAULT unknown ,<br />    techexp VisibleString OPTIONAL ,   -- explanation if tech not enough<br />    --<br />    -- Completeness is not indicated in most records.  For genomes, assume<br />    -- the sequences are incomplete unless specifically marked as complete.<br />    -- For mRNAs, assume the ends are not known exactly unless marked as<br />    -- having the left or right end.<br />    --<br />    completeness INTEGER {<br />      unknown (0) ,<br />      complete (1) ,                   -- complete biological entity<br />      partial (2) ,                    -- partial but no details given<br />      no-left (3) ,                    -- missing 5' or NH3 end<br />      no-right (4) ,                   -- missing 3' or COOH end<br />      no-ends (5) ,                    -- missing both ends<br />      has-left (6) ,                   -- 5' or NH3 end present<br />      has-right (7) ,                  -- 3' or COOH end present<br />      other (255) } DEFAULT unknown ,<br />    gbmoltype VisibleString OPTIONAL } -- identifies particular ncRNA<br /><br /><br />GIBB-mol ::= ENUMERATED {       -- type of molecule represented<br />    unknown (0) ,<br />    genomic (1) ,<br />    pre-mRNA (2) ,              -- precursor RNA of any sort really <br />    mRNA (3) ,<br />    rRNA (4) ,<br />    tRNA (5) ,<br />    snRNA (6) ,<br />    scRNA (7) ,<br />    peptide (8) ,<br />    other-genetic (9) ,      -- other genetic material<br />    genomic-mRNA (10) ,      -- reported a mix of genomic and cdna sequence<br />    other (255) }<br />    <br />GIBB-mod ::= ENUMERATED {        -- GenInfo Backbone modifiers<br />    dna (0) ,<br />    rna (1) ,<br />    extrachrom (2) ,<br />    plasmid (3) ,<br />    mitochondrial (4) ,<br />    chloroplast (5) ,<br />    kinetoplast (6) ,<br />    cyanelle (7) ,<br />    synthetic (8) ,<br />    recombinant (9) ,<br />    partial (10) ,<br />    complete (11) ,<br />    mutagen (12) ,    -- subject of mutagenesis ?<br />    natmut (13) ,     -- natural mutant ?<br />    transposon (14) ,<br />    insertion-seq (15) ,<br />    no-left (16) ,    -- missing left end (5' for na, NH2 for aa)<br />    no-right (17) ,   -- missing right end (3' or COOH)<br />    macronuclear (18) ,<br />    proviral (19) ,<br />    est (20) ,        -- expressed sequence tag<br />    sts (21) ,        -- sequence tagged site<br />    survey (22) ,     -- one pass survey sequence<br />    chromoplast (23) ,<br />    genemap (24) ,    -- is a genetic map<br />    restmap (25) ,    -- is an ordered restriction map<br />    physmap (26) ,    -- is a physical map (not ordered restriction map)<br />    other (255) }<br /><br />GIBB-method ::= ENUMERATED {        -- sequencing methods<br />    concept-trans (1) ,    -- conceptual translation<br />    seq-pept (2) ,         -- peptide was sequenced<br />    both (3) ,             -- concept transl. w/ partial pept. seq.<br />    seq-pept-overlap (4) , -- sequenced peptide, ordered by overlap<br />    seq-pept-homol (5) ,   -- sequenced peptide, ordered by homology<br />    concept-trans-a (6) ,  -- conceptual transl. supplied by author<br />    other (255) }<br />    <br />Numbering ::= CHOICE {           -- any display numbering system<br />    cont Num-cont ,              -- continuous numbering<br />    enum Num-enum ,              -- enumerated names for residues<br />    ref Num-ref ,                -- by reference to another sequence<br />    real Num-real }              -- supports mapping to a float system<br />    <br />Num-cont ::= SEQUENCE {          -- continuous display numbering system<br />    refnum INTEGER DEFAULT 1,         -- number assigned to first residue<br />    has-zero BOOLEAN DEFAULT FALSE ,  -- 0 used?<br />    ascending BOOLEAN DEFAULT TRUE }  -- ascending numbers?<br /><br />Num-enum ::= SEQUENCE {          -- any tags to residues<br />    num INTEGER ,                        -- number of tags to follow<br />    names SEQUENCE OF VisibleString }    -- the tags<br /><br />Num-ref ::= SEQUENCE {           -- by reference to other sequences<br />    type ENUMERATED {            -- type of reference<br />        not-set (0) ,<br />        sources (1) ,            -- by segmented or const seq sources<br />        aligns (2) } ,           -- by alignments given below<br />    aligns Seq-align OPTIONAL }<br /><br />Num-real ::= SEQUENCE {          -- mapping to floating point system<br />    a REAL ,                     -- from an integer system used by Bioseq<br />    b REAL ,                     -- position = (a * int_position) + b<br />    units VisibleString OPTIONAL }<br /><br />Pubdesc ::= SEQUENCE {              -- how sequence presented in pub<br />    pub Pub-equiv ,                 -- the citation(s)<br />    name VisibleString OPTIONAL ,   -- name used in paper<br />    fig VisibleString OPTIONAL ,    -- figure in paper<br />    num Numbering OPTIONAL ,        -- numbering from paper<br />    numexc BOOLEAN OPTIONAL ,       -- numbering problem with paper<br />    poly-a BOOLEAN OPTIONAL ,       -- poly A tail indicated in figure?<br />    maploc VisibleString OPTIONAL , -- map location reported in paper<br />    seq-raw StringStore OPTIONAL ,  -- original sequence from paper<br />    align-group INTEGER OPTIONAL ,  -- this seq aligned with others in paper<br />    comment VisibleString OPTIONAL, -- any comment on this pub in context<br />    reftype INTEGER {           -- type of reference in a GenBank record<br />        seq (0) ,               -- refers to sequence<br />        sites (1) ,             -- refers to unspecified features<br />        feats (2) ,             -- refers to specified features<br />        no-target (3) }         -- nothing specified (EMBL)<br />        DEFAULT seq }<br /><br />Heterogen ::= VisibleString       -- cofactor, prosthetic group, inhibitor, etc<br /><br />--*** Instances of sequences *******************************<br />--*<br /><br />Seq-inst ::= SEQUENCE {            -- the sequence data itself<br />    repr ENUMERATED {              -- representation class<br />        not-set (0) ,              -- empty<br />        virtual (1) ,              -- no seq data<br />        raw (2) ,                  -- continuous sequence<br />        seg (3) ,                  -- segmented sequence<br />        const (4) ,                -- constructed sequence<br />        ref (5) ,                  -- reference to another sequence<br />        consen (6) ,               -- consensus sequence or pattern<br />        map (7) ,                  -- ordered map of any kind<br />        delta (8) ,              -- sequence made by changes (delta) to others<br />        other (255) } ,<br />    mol ENUMERATED {               -- molecule class in living organism<br />        not-set (0) ,              --   &gt; cdna = rna<br />        dna (1) ,<br />        rna (2) ,<br />        aa (3) ,<br />        na (4) ,                   -- just a nucleic acid<br />        other (255) } ,<br />    length INTEGER OPTIONAL ,      -- length of sequence in residues<br />    fuzz Int-fuzz OPTIONAL ,       -- length uncertainty<br />    topology ENUMERATED {          -- topology of molecule<br />        not-set (0) ,<br />        linear (1) ,<br />        circular (2) ,<br />        tandem (3) ,               -- some part of tandem repeat<br />        other (255) } DEFAULT linear ,<br />    strand ENUMERATED {            -- strandedness in living organism<br />        not-set (0) ,<br />        ss (1) ,                   -- single strand<br />        ds (2) ,                   -- double strand<br />        mixed (3) ,<br />        other (255) } OPTIONAL ,   -- default ds for DNA, ss for RNA, pept<br />    seq-data Seq-data OPTIONAL ,   -- the sequence<br />    ext Seq-ext OPTIONAL ,         -- extensions for special types<br />    hist Seq-hist OPTIONAL }       -- sequence history<br /><br />--*** Sequence Extensions **********************************<br />--*  for representing more complex types<br />--*  const type uses Seq-hist.assembly<br /><br />Seq-ext ::= CHOICE {<br />    seg Seg-ext ,        -- segmented sequences<br />    ref Ref-ext ,        -- hot link to another sequence (a view)<br />    map Map-ext ,        -- ordered map of markers<br />    delta Delta-ext }<br /><br />Seg-ext ::= SEQUENCE OF Seq-loc<br /><br />Ref-ext ::= Seq-loc<br /><br />Map-ext ::= SEQUENCE OF Seq-feat<br /><br />Delta-ext ::= SEQUENCE OF Delta-seq<br /><br />Delta-seq ::= CHOICE {<br />    loc Seq-loc ,       -- point to a sequence<br />    literal Seq-literal }   -- a piece of sequence<br /><br />Seq-literal ::= SEQUENCE {<br />    length INTEGER ,         -- must give a length in residues<br />    fuzz Int-fuzz OPTIONAL , -- could be unsure<br />    seq-data Seq-data OPTIONAL } -- may have the data<br /><br />--*** Sequence History Record ***********************************<br />--** assembly = records how seq was assembled from others<br />--** replaces = records sequences made obsolete by this one<br />--** replaced-by = this seq is made obsolete by another(s)<br /><br />Seq-hist ::= SEQUENCE {<br />    assembly SET OF Seq-align OPTIONAL ,-- how was this assembled?<br />    replaces Seq-hist-rec OPTIONAL ,    -- seq makes these seqs obsolete<br />    replaced-by Seq-hist-rec OPTIONAL , -- these seqs make this one obsolete<br />    deleted CHOICE {<br />        bool BOOLEAN ,<br />        date Date } OPTIONAL }<br /><br />Seq-hist-rec ::= SEQUENCE {<br />    date Date OPTIONAL ,<br />    ids SET OF Seq-id }<br />    <br />--*** Various internal sequence representations ************<br />--*      all are controlled, fixed length forms<br /><br />Seq-data ::= CHOICE {              -- sequence representations<br />    iupacna IUPACna ,              -- IUPAC 1 letter nuc acid code<br />    iupacaa IUPACaa ,              -- IUPAC 1 letter amino acid code<br />    ncbi2na NCBI2na ,              -- 2 bit nucleic acid code<br />    ncbi4na NCBI4na ,              -- 4 bit nucleic acid code<br />    ncbi8na NCBI8na ,              -- 8 bit extended nucleic acid code<br />    ncbipna NCBIpna ,              -- nucleic acid probabilities<br />    ncbi8aa NCBI8aa ,              -- 8 bit extended amino acid codes<br />    ncbieaa NCBIeaa ,              -- extended ASCII 1 letter aa codes<br />    ncbipaa NCBIpaa ,              -- amino acid probabilities<br />    ncbistdaa NCBIstdaa,           -- consecutive codes for std aas<br />    gap Seq-gap                    -- gap types<br />}<br /><br />Seq-gap ::= SEQUENCE {<br />    type INTEGER {<br />        unknown(0),<br />        fragment(1),<br />        clone(2),<br />        short-arm(3),<br />        heterochromatin(4),<br />        centromere(5),<br />        telomere(6),<br />        repeat(7),<br />        contig(8),<br />        other(255)<br />    },<br />    linkage INTEGER {<br />        unlinked(0),<br />        linked(1),<br />        other(255)<br />    } OPTIONAL<br />}<br /><br />IUPACna ::= StringStore       -- IUPAC 1 letter codes, no spaces<br />IUPACaa ::= StringStore       -- IUPAC 1 letter codes, no spaces<br />NCBI2na ::= OCTET STRING      -- 00=A, 01=C, 10=G, 11=T<br />NCBI4na ::= OCTET STRING      -- 1 bit each for agct<br />                              -- 0001=A, 0010=C, 0100=G, 1000=T/U<br />                              -- 0101=Purine, 1010=Pyrimidine, etc<br />NCBI8na ::= OCTET STRING      -- for modified nucleic acids<br />NCBIpna ::= OCTET STRING      -- 5 octets/base, prob for a,c,g,t,n<br />                              -- probabilities are coded 0-255 = 0.0-1.0<br />NCBI8aa ::= OCTET STRING      -- for modified amino acids<br />NCBIeaa ::= StringStore       -- ASCII extended 1 letter aa codes<br />                              -- IUPAC codes + U=selenocysteine<br />NCBIpaa ::= OCTET STRING      -- 25 octets/aa, prob for IUPAC aas in order:<br />                              -- A-Y,B,Z,X,(ter),anything<br />                              -- probabilities are coded 0-255 = 0.0-1.0<br />NCBIstdaa ::= OCTET STRING    -- codes 0-25, 1 per byte<br /><br />--*** Sequence Annotation *************************************<br />--*<br /><br />-- This is a replica of Textseq-id<br />-- This is specific for annotations, and exists to maintain a semantic<br />-- difference between IDs assigned to annotations and IDs assigned to<br />-- sequences<br />Textannot-id ::= SEQUENCE {<br />    name      VisibleString OPTIONAL ,<br />    accession VisibleString OPTIONAL ,<br />    release   VisibleString OPTIONAL ,<br />    version   INTEGER       OPTIONAL<br />}<br /><br />Annot-id ::= CHOICE {<br />    local Object-id ,<br />    ncbi INTEGER ,<br />    general Dbtag,<br />    other Textannot-id<br />}<br />    <br />Annot-descr ::= SET OF Annotdesc<br /><br />Annotdesc ::= CHOICE {<br />    name VisibleString ,         -- a short name for this collection<br />    title VisibleString ,        -- a title for this collection<br />    comment VisibleString ,      -- a more extensive comment<br />    pub Pubdesc ,                -- a reference to the publication<br />    user User-object ,           -- user defined object<br />    create-date Date ,           -- date entry first created/released<br />    update-date Date ,           -- date of last update<br />    src Seq-id ,                 -- source sequence from which annot came<br />    align Align-def,             -- definition of the SeqAligns<br />    region Seq-loc }             -- all contents cover this region<br /><br />Align-def ::= SEQUENCE {<br />    align-type INTEGER {         -- class of align Seq-annot<br />      ref (1) ,                  -- set of alignments to the same sequence<br />      alt (2) ,                  -- set of alternate alignments of the same seqs<br />      blocks (3) ,               -- set of aligned blocks in the same seqs<br />      other (255) } ,<br />    ids SET OF Seq-id OPTIONAL } -- used for the one ref seqid for now<br /><br />Seq-annot ::= SEQUENCE {<br />    id SET OF Annot-id OPTIONAL ,<br />    db INTEGER {                 -- source of annotation<br />        genbank (1) ,<br />        embl (2) ,<br />        ddbj (3) ,<br />        pir  (4) ,<br />        sp   (5) ,<br />        bbone (6) ,<br />        pdb   (7) ,<br />        other (255) } OPTIONAL ,<br />    name VisibleString OPTIONAL ,-- source if "other" above<br />    desc Annot-descr OPTIONAL ,  -- used only for stand alone Seq-annots<br />    data CHOICE {<br />        ftable SET OF Seq-feat ,<br />        align SET OF Seq-align ,<br />        graph SET OF Seq-graph ,<br />        ids SET OF Seq-id ,      -- used for communication between tools<br />        locs SET OF Seq-loc ,    -- used for communication between tools<br />        seq-table Seq-table } }  -- features in table form<br /><br />END</pre></div><div class="sec" id="ch_datamod._ASN1_Specification_s_5"><h3><span class="title">ASN.1 Specification: seqblock.asn</span></h3><p>See also the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/seqblock/seqblock.asn">online-version</a> of this specification, which may be more up-to-date.</p><pre>--$Revision$<br />--*********************************************************************<br />--<br />-- 1990 - J.Ostell<br />-- Version 3.0 - June 1994<br />--<br />--*********************************************************************<br />--*********************************************************************<br />--<br />--  EMBL specific data<br />--  This block of specifications was developed by Reiner Fuchs of EMBL<br />--  Updated by J.Ostell, 1994<br />--<br />--*********************************************************************<br /><br />EMBL-General DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS EMBL-dbname, EMBL-xref, EMBL-block;<br /><br />IMPORTS Date, Object-id FROM NCBI-General;<br /><br />EMBL-dbname ::= CHOICE {<br />    code ENUMERATED {<br />        embl(0),<br />        genbank(1),<br />        ddbj(2),<br />        geninfo(3),<br />        medline(4),<br />        swissprot(5),<br />        pir(6),<br />        pdb(7),<br />        epd(8),<br />        ecd(9),<br />        tfd(10),<br />        flybase(11),<br />        prosite(12),<br />        enzyme(13),<br />        mim(14),<br />        ecoseq(15),<br />        hiv(16) ,<br />        other (255) } ,<br />    name    VisibleString }<br /><br />EMBL-xref ::= SEQUENCE {<br />    dbname EMBL-dbname,<br />    id SEQUENCE OF Object-id }<br /><br />EMBL-block ::= SEQUENCE {<br />    class ENUMERATED {<br />        not-set(0),<br />        standard(1),<br />        unannotated(2),<br />        other(255) } DEFAULT standard,<br />    div ENUMERATED {<br />        fun(0),<br />        inv(1),<br />        mam(2),<br />        org(3),<br />        phg(4),<br />        pln(5),<br />        pri(6),<br />        pro(7),<br />        rod(8),<br />        syn(9),<br />        una(10),<br />        vrl(11),<br />        vrt(12),<br />        pat(13),<br />        est(14),<br />        sts(15),<br />        other (255) } OPTIONAL,<br />    creation-date Date,<br />    update-date Date,<br />    extra-acc SEQUENCE OF VisibleString OPTIONAL,<br />    keywords SEQUENCE OF VisibleString OPTIONAL,<br />    xref SEQUENCE OF EMBL-xref OPTIONAL }<br /><br />END<br /><br />--*********************************************************************<br />--<br />--  SWISSPROT specific data<br />--  This block of specifications was developed by Mark Cavanaugh of<br />--      NCBI working with Amos Bairoch of SWISSPROT<br />--<br />--*********************************************************************<br /><br />SP-General DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS SP-block;<br /><br />IMPORTS Date, Dbtag FROM NCBI-General<br />        Seq-id FROM NCBI-Seqloc;<br /><br />SP-block ::= SEQUENCE {         -- SWISSPROT specific descriptions<br />    class ENUMERATED {<br />        not-set (0) ,<br />        standard (1) ,      -- conforms to all SWISSPROT checks<br />        prelim (2) ,        -- only seq and biblio checked<br />        other (255) } ,<br />    extra-acc SET OF VisibleString OPTIONAL ,  -- old SWISSPROT ids<br />    imeth BOOLEAN DEFAULT FALSE ,  -- seq known to start with Met<br />    plasnm SET OF VisibleString OPTIONAL,  -- plasmid names carrying gene<br />    seqref SET OF Seq-id OPTIONAL,         -- xref to other sequences<br />    dbref SET OF Dbtag OPTIONAL ,          -- xref to non-sequence dbases<br />    keywords SET OF VisibleString OPTIONAL , -- keywords<br />    created Date OPTIONAL ,         -- creation date<br />    sequpd Date OPTIONAL ,          -- sequence update<br />    annotupd Date OPTIONAL }        -- annotation update<br /><br />END<br /><br />--*********************************************************************<br />--<br />--  PIR specific data<br />--  This block of specifications was developed by Jim Ostell of<br />--      NCBI<br />--<br />--*********************************************************************<br /><br />PIR-General DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS PIR-block;<br /><br />IMPORTS Seq-id FROM NCBI-Seqloc;<br /><br />PIR-block ::= SEQUENCE {          -- PIR specific descriptions<br />    had-punct BOOLEAN OPTIONAL ,      -- had punctuation in sequence ?<br />    host VisibleString OPTIONAL ,<br />    source VisibleString OPTIONAL ,     -- source line<br />    summary VisibleString OPTIONAL ,<br />    genetic VisibleString OPTIONAL ,<br />    includes VisibleString OPTIONAL ,<br />    placement VisibleString OPTIONAL ,<br />    superfamily VisibleString OPTIONAL ,<br />    keywords SEQUENCE OF VisibleString OPTIONAL ,<br />    cross-reference VisibleString OPTIONAL ,<br />    date VisibleString OPTIONAL ,<br />    seq-raw VisibleString OPTIONAL ,  -- seq with punctuation<br />    seqref SET OF Seq-id OPTIONAL }         -- xref to other sequences<br /><br />END<br /><br />--*********************************************************************<br />--<br />--  GenBank specific data<br />--  This block of specifications was developed by Jim Ostell of<br />--      NCBI<br />--<br />--*********************************************************************<br /><br />GenBank-General DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS GB-block;<br /><br />IMPORTS Date FROM NCBI-General;<br /><br />GB-block ::= SEQUENCE {          -- GenBank specific descriptions<br />    extra-accessions SEQUENCE OF VisibleString OPTIONAL ,<br />    source VisibleString OPTIONAL ,     -- source line<br />    keywords SEQUENCE OF VisibleString OPTIONAL ,<br />    origin VisibleString OPTIONAL,<br />    date VisibleString OPTIONAL ,       -- OBSOLETE old form Entry Date<br />    entry-date Date OPTIONAL ,          -- replaces date<br />    div VisibleString OPTIONAL ,        -- GenBank division<br />    taxonomy VisibleString OPTIONAL }   -- continuation line of organism<br /><br />END<br /><br />--**********************************************************************<br />-- PRF specific definition<br />--    PRF is a protein sequence database crated and maintained by<br />--    Protein Research Foundation, Minoo-city, Osaka, Japan.<br />--<br />--    Written by A.Ogiwara, Inst.Chem.Res. (Dr.Kanehisa's Lab),<br />--            Kyoto Univ., Japan<br />--<br />--**********************************************************************<br /><br />PRF-General DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS PRF-block;<br /><br />PRF-block ::= SEQUENCE {<br />      extra-src       PRF-ExtraSrc OPTIONAL,<br />      keywords        SEQUENCE OF VisibleString OPTIONAL<br />}<br /><br />PRF-ExtraSrc ::= SEQUENCE {<br />      host    VisibleString OPTIONAL,<br />      part    VisibleString OPTIONAL,<br />      state   VisibleString OPTIONAL,<br />      strain  VisibleString OPTIONAL,<br />      taxon   VisibleString OPTIONAL<br />}<br /><br />END<br /><br />--*********************************************************************<br />--<br />--  PDB specific data<br />--  This block of specifications was developed by Jim Ostell and<br />--      Steve Bryant of NCBI<br />--<br />--*********************************************************************<br /><br />PDB-General DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS PDB-block;<br /><br />IMPORTS Date FROM NCBI-General;<br /><br />PDB-block ::= SEQUENCE {          -- PDB specific descriptions<br />    deposition Date ,         -- deposition date  month,year<br />    class VisibleString ,<br />    compound SEQUENCE OF VisibleString ,<br />    source SEQUENCE OF VisibleString ,<br />    exp-method VisibleString OPTIONAL ,  -- present if NOT X-ray diffraction<br />    replace PDB-replace OPTIONAL } -- replacement history<br /><br />PDB-replace ::= SEQUENCE {<br />    date Date ,<br />    ids SEQUENCE OF VisibleString }   -- entry ids replace by this one<br /><br />END</pre></div><div class="sec" id="ch_datamod._ASN1_Specification_s_6"><h3><span class="title">ASN.1 Specification: seqcode.asn</span></h3><p>See also the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/seqcode/seqcode.asn">online-version</a> of this specification, which may be more up-to-date.</p><pre>--$Revision$<br />--  *********************************************************************<br />--<br />--  These are code and conversion tables for NCBI sequence codes<br />--  ASN.1 for the sequences themselves are define in seq.asn<br />--<br />--  Seq-map-table and Seq-code-table REQUIRE that codes start with 0<br />--    and increase continuously.  So IUPAC codes, which are upper case<br />--    letters will always have 65 0 cells before the codes begin.  This<br />--    allows all codes to do indexed lookups for things<br />--<br />--  Valid names for code tables are:<br />--    IUPACna<br />--    IUPACaa<br />--    IUPACeaa<br />--    IUPACaa3     3 letter amino acid codes : parallels IUPACeaa<br />--                   display only, not a data exchange type<br />--    NCBI2na<br />--    NCBI4na<br />--    NCBI8na<br />--    NCBI8aa<br />--    NCBIstdaa<br />--     probability types map to IUPAC types for display as characters<br /><br />NCBI-SeqCode DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS Seq-code-table, Seq-map-table, Seq-code-set;<br /><br />Seq-code-type ::= ENUMERATED {              -- sequence representations<br />    iupacna (1) ,              -- IUPAC 1 letter nuc acid code<br />    iupacaa (2) ,              -- IUPAC 1 letter amino acid code<br />    ncbi2na (3) ,              -- 2 bit nucleic acid code<br />    ncbi4na (4) ,              -- 4 bit nucleic acid code<br />    ncbi8na (5) ,              -- 8 bit extended nucleic acid code<br />    ncbipna (6) ,              -- nucleic acid probabilities<br />    ncbi8aa (7) ,              -- 8 bit extended amino acid codes<br />    ncbieaa (8) ,              -- extended ASCII 1 letter aa codes<br />    ncbipaa (9) ,              -- amino acid probabilities<br />    iupacaa3 (10) ,            -- 3 letter code only for display<br />    ncbistdaa (11) }           -- consecutive codes for std aas, 0-25<br /><br />Seq-map-table ::= SEQUENCE { -- for tables of sequence mappings <br />    from Seq-code-type ,      -- code to map from<br />    to Seq-code-type ,        -- code to map to<br />    num INTEGER ,             -- number of rows in table<br />    start-at INTEGER DEFAULT 0 ,   -- index offset of first element<br />    table SEQUENCE OF INTEGER }  -- table of values, in from-to order<br /><br />Seq-code-table ::= SEQUENCE { -- for names of coded values<br />    code Seq-code-type ,      -- name of code<br />    num INTEGER ,             -- number of rows in table<br />    one-letter BOOLEAN ,   -- symbol is ALWAYS 1 letter?<br />    start-at INTEGER DEFAULT 0 ,   -- index offset of first element<br />    table SEQUENCE OF<br />        SEQUENCE {<br />            symbol VisibleString ,      -- the printed symbol or letter<br />            name VisibleString } ,      -- an explanatory name or string<br />    comps SEQUENCE OF INTEGER OPTIONAL } -- pointers to complement nuc acid<br /><br />Seq-code-set ::= SEQUENCE {    -- for distribution<br />    codes SET OF Seq-code-table OPTIONAL ,<br />    maps SET OF Seq-map-table OPTIONAL }<br /><br />END</pre></div><div class="sec" id="ch_datamod._ASN1_Specification_s_7"><h3><span class="title">ASN.1 Specification: seqset.asn</span></h3><p>See also the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/seqset/seqset.asn">online-version</a> of this specification, which may be more up-to-date.</p><pre>--$Revision$<br />--**********************************************************************<br />--<br />--  NCBI Sequence Collections<br />--  by James Ostell, 1990<br />--<br />--  Version 3.0 - 1994<br />--<br />--**********************************************************************<br /><br />NCBI-Seqset DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS Bioseq-set, Seq-entry;<br /><br />IMPORTS Bioseq, Seq-annot, Seq-descr FROM NCBI-Sequence<br />        Object-id, Dbtag, Date FROM NCBI-General;<br /><br />--*** Sequence Collections ********************************<br />--*<br /><br />Bioseq-set ::= SEQUENCE {      -- just a collection<br />    id Object-id OPTIONAL ,<br />    coll Dbtag OPTIONAL ,          -- to identify a collection<br />    level INTEGER OPTIONAL ,       -- nesting level<br />    class ENUMERATED {<br />        not-set (0) ,<br />        nuc-prot (1) ,              -- nuc acid and coded proteins<br />        segset (2) ,                -- segmented sequence + parts<br />        conset (3) ,                -- constructed sequence + parts<br />        parts (4) ,                 -- parts for 2 or 3<br />        gibb (5) ,                  -- geninfo backbone<br />        gi (6) ,                    -- geninfo<br />        genbank (7) ,               -- converted genbank<br />        pir (8) ,                   -- converted pir<br />        pub-set (9) ,               -- all the seqs from a single publication<br />        equiv (10) ,                -- a set of equivalent maps or seqs<br />        swissprot (11) ,            -- converted SWISSPROT<br />        pdb-entry (12) ,            -- a complete PDB entry<br />        mut-set (13) ,              -- set of mutations<br />        pop-set (14) ,              -- population study<br />        phy-set (15) ,              -- phylogenetic study<br />        eco-set (16) ,              -- ecological sample study<br />        gen-prod-set (17) ,         -- genomic products, chrom+mRNA+protein<br />        wgs-set (18) ,              -- whole genome shotgun project<br />        named-annot (19) ,          -- named annotation set<br />        named-annot-prod (20) ,     -- with instantiated mRNA+protein<br />        read-set (21) ,             -- set from a single read<br />        paired-end-reads (22) ,     -- paired sequences within a read-set<br />        other (255) } DEFAULT not-set ,<br />    release VisibleString OPTIONAL ,<br />    date Date OPTIONAL ,<br />    descr Seq-descr OPTIONAL ,<br />    seq-set SEQUENCE OF Seq-entry ,<br />    annot SET OF Seq-annot OPTIONAL }<br /><br />Seq-entry ::= CHOICE {<br />        seq Bioseq ,<br />        set Bioseq-set }<br /><br />END</pre></div><div class="sec" id="ch_datamod._ASN1_Specification_s_8"><h3><span class="title">ASN.1 Specification: seqloc.asn</span></h3><p>See also the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/seqloc/seqloc.asn">online-version</a> of this specification, which may be more up-to-date.</p><pre>--$Revision$<br />--**********************************************************************<br />--<br />--  NCBI Sequence location and identifier elements<br />--  by James Ostell, 1990<br />--<br />--  Version 3.0 - 1994<br />--<br />--**********************************************************************<br /><br />NCBI-Seqloc DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS Seq-id, Seq-loc, Seq-interval, Packed-seqint, Seq-point, Packed-seqpnt,<br />        Na-strand, Giimport-id;<br /><br />IMPORTS Object-id, Int-fuzz, Dbtag, Date FROM NCBI-General<br />        Id-pat FROM NCBI-Biblio<br />        Feat-id FROM NCBI-Seqfeat;<br /><br />--*** Sequence identifiers ********************************<br />--*<br /><br />Seq-id ::= CHOICE {<br />    local Object-id ,            -- local use<br />    gibbsq INTEGER ,             -- Geninfo backbone seqid<br />    gibbmt INTEGER ,             -- Geninfo backbone moltype<br />    giim Giimport-id ,           -- Geninfo import id<br />    genbank Textseq-id ,<br />    embl Textseq-id ,<br />    pir Textseq-id ,<br />    swissprot Textseq-id ,<br />    patent Patent-seq-id ,<br />    other Textseq-id ,           -- for historical reasons, 'other' = 'refseq'<br />    general Dbtag ,              -- for other databases<br />    gi INTEGER ,                 -- GenInfo Integrated Database<br />    ddbj Textseq-id ,            -- DDBJ<br />    prf Textseq-id ,             -- PRF SEQDB<br />    pdb PDB-seq-id ,             -- PDB sequence<br />    tpg Textseq-id ,             -- Third Party Annot/Seq Genbank<br />    tpe Textseq-id ,             -- Third Party Annot/Seq EMBL<br />    tpd Textseq-id ,             -- Third Party Annot/Seq DDBJ<br />    gpipe Textseq-id ,           -- Internal NCBI genome pipeline processing ID<br />    named-annot-track Textseq-id -- Internal named annotation tracking ID<br />}<br /><br />Seq-id-set ::= SET OF Seq-id<br /><br /><br />Patent-seq-id ::= SEQUENCE {<br />    seqid INTEGER ,         -- number of sequence in patent<br />    cit Id-pat }           -- patent citation<br /><br />Textseq-id ::= SEQUENCE {<br />    name VisibleString OPTIONAL ,<br />    accession VisibleString OPTIONAL ,<br />    release VisibleString OPTIONAL ,<br />    version INTEGER OPTIONAL }<br /><br />Giimport-id ::= SEQUENCE {<br />    id INTEGER ,                     -- the id to use here<br />    db VisibleString OPTIONAL ,      -- dbase used in<br />    release VisibleString OPTIONAL } -- the release<br /><br />PDB-seq-id ::= SEQUENCE {<br />    mol PDB-mol-id ,           -- the molecule name<br />    chain INTEGER DEFAULT 32 , -- a single ASCII character, chain id<br />    rel Date OPTIONAL }        -- release date, month and year<br /><br />PDB-mol-id ::= VisibleString  -- name of mol, 4 chars<br />    <br />--*** Sequence locations **********************************<br />--*<br /><br />Seq-loc ::= CHOICE {<br />    null NULL ,           -- not placed<br />    empty Seq-id ,        -- to NULL one Seq-id in a collection<br />    whole Seq-id ,        -- whole sequence<br />    int Seq-interval ,    -- from to<br />    packed-int Packed-seqint ,<br />    pnt Seq-point ,<br />    packed-pnt Packed-seqpnt ,<br />    mix Seq-loc-mix ,<br />    equiv Seq-loc-equiv ,  -- equivalent sets of locations<br />    bond Seq-bond ,<br />    feat Feat-id }         -- indirect, through a Seq-feat<br />    <br /><br />Seq-interval ::= SEQUENCE {<br />    from INTEGER ,<br />    to INTEGER ,<br />    strand Na-strand OPTIONAL ,<br />    id Seq-id ,    -- WARNING: this used to be optional<br />    fuzz-from Int-fuzz OPTIONAL ,<br />    fuzz-to Int-fuzz OPTIONAL }<br /><br />Packed-seqint ::= SEQUENCE OF Seq-interval<br /><br />Seq-point ::= SEQUENCE {<br />    point INTEGER ,<br />    strand Na-strand OPTIONAL ,<br />    id Seq-id ,     -- WARNING: this used to be optional<br />    fuzz Int-fuzz OPTIONAL }<br /><br />Packed-seqpnt ::= SEQUENCE {<br />    strand Na-strand OPTIONAL ,<br />    id Seq-id ,<br />    fuzz Int-fuzz OPTIONAL ,<br />    points SEQUENCE OF INTEGER }<br /><br />Na-strand ::= ENUMERATED {          -- strand of nucleic acid<br />    unknown (0) ,<br />    plus (1) ,<br />    minus (2) ,               <br />    both (3) ,                -- in forward orientation<br />    both-rev (4) ,            -- in reverse orientation<br />    other (255) }<br /><br />Seq-bond ::= SEQUENCE {         -- bond between residues<br />    a Seq-point ,           -- connection to a least one residue<br />    b Seq-point OPTIONAL }  -- other end may not be available<br /><br />Seq-loc-mix ::= SEQUENCE OF Seq-loc   -- this will hold anything<br /><br />Seq-loc-equiv ::= SET OF Seq-loc      -- for a set of equivalent locations<br /><br />END</pre></div><div class="sec" id="ch_datamod._ASN1_Specification_s_9"><h3><span class="title">ASN.1 Specification: seqfeat.asn</span></h3><p>See also the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/seqfeat/seqfeat.asn">online-version</a> of this specification, which may be more up-to-date.</p><pre>--$Revision$<br />--**********************************************************************<br />--<br />--  NCBI Sequence Feature elements<br />--  by James Ostell, 1990<br />--  Version 3.0 - June 1994<br />--<br />--**********************************************************************<br /><br />NCBI-Seqfeat DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS Seq-feat, Feat-id, Genetic-code;<br /><br />IMPORTS Gene-ref FROM NCBI-Gene<br />        Prot-ref FROM NCBI-Protein<br />        Org-ref FROM NCBI-Organism<br />        Variation-ref FROM NCBI-Variation<br />        BioSource FROM NCBI-BioSource<br />        RNA-ref FROM NCBI-RNA<br />        Seq-loc, Giimport-id FROM NCBI-Seqloc<br />        Pubdesc, Numbering, Heterogen FROM NCBI-Sequence<br />        Rsite-ref FROM NCBI-Rsite<br />        Txinit FROM NCBI-TxInit<br />        Pub-set FROM NCBI-Pub<br />        Object-id, Dbtag, User-object FROM NCBI-General;<br /><br />--*** Feature identifiers ********************************<br />--*<br /><br />Feat-id ::= CHOICE {<br />    gibb INTEGER ,            -- geninfo backbone<br />    giim Giimport-id ,        -- geninfo import<br />    local Object-id ,         -- for local software use<br />    general Dbtag }           -- for use by various databases<br /><br />--*** Seq-feat *******************************************<br />--*  sequence feature generalization<br /><br />Seq-feat ::= SEQUENCE {<br />    id Feat-id OPTIONAL ,<br />    data SeqFeatData ,           -- the specific data<br />    partial BOOLEAN OPTIONAL ,    -- incomplete in some way?<br />    except BOOLEAN OPTIONAL ,     -- something funny about this?<br />    comment VisibleString OPTIONAL ,<br />    product Seq-loc OPTIONAL ,    -- product of process<br />    location Seq-loc ,            -- feature made from<br />    qual SEQUENCE OF Gb-qual OPTIONAL ,  -- qualifiers<br />    title VisibleString OPTIONAL ,   -- for user defined label<br />    ext User-object OPTIONAL ,    -- user defined structure extension<br />    cit Pub-set OPTIONAL ,        -- citations for this feature<br />    exp-ev ENUMERATED {           -- evidence for existence of feature<br />        experimental (1) ,        -- any reasonable experimental check<br />        not-experimental (2) } OPTIONAL , -- similarity, pattern, etc<br />    xref SET OF SeqFeatXref OPTIONAL ,   -- cite other relevant features<br />    dbxref SET OF Dbtag OPTIONAL ,  -- support for xref to other databases<br />    pseudo BOOLEAN OPTIONAL ,     -- annotated on pseudogene?<br />    except-text VisibleString OPTIONAL , -- explain if except=TRUE<br />    ids SET OF Feat-id OPTIONAL ,       -- set of Ids; will replace 'id' field<br />    exts SET OF User-object OPTIONAL }  -- set of extensions; will replace 'ext' field<br /><br />SeqFeatData ::= CHOICE {<br />    gene Gene-ref ,<br />    org Org-ref ,<br />    cdregion Cdregion ,<br />    prot Prot-ref ,<br />    rna RNA-ref ,<br />    pub Pubdesc ,              -- publication applies to this seq<br />    seq Seq-loc ,              -- to annotate origin from another seq<br />    imp Imp-feat ,<br />    region VisibleString,      -- named region (globin locus)<br />    comment NULL ,             -- just a comment<br />    bond ENUMERATED {<br />        disulfide (1) ,<br />        thiolester (2) ,<br />        xlink (3) ,<br />        thioether (4) ,<br />        other (255) } ,<br />    site ENUMERATED {<br />        active (1) ,<br />        binding (2) ,<br />        cleavage (3) ,<br />        inhibit (4) ,<br />        modified (5),<br />        glycosylation (6) ,<br />        myristoylation (7) ,<br />        mutagenized (8) ,<br />        metal-binding (9) ,<br />        phosphorylation (10) ,<br />        acetylation (11) ,<br />        amidation (12) ,<br />        methylation (13) ,<br />        hydroxylation (14) ,<br />        sulfatation (15) ,<br />        oxidative-deamination (16) ,<br />        pyrrolidone-carboxylic-acid (17) ,<br />        gamma-carboxyglutamic-acid (18) ,<br />        blocked (19) ,<br />        lipid-binding (20) ,<br />        np-binding (21) ,<br />        dna-binding (22) ,<br />        signal-peptide (23) ,<br />        transit-peptide (24) ,<br />        transmembrane-region (25) ,<br />        nitrosylation (26) ,<br />        other (255) } ,<br />    rsite Rsite-ref ,       -- restriction site  (for maps really)<br />    user User-object ,      -- user defined structure<br />    txinit Txinit ,         -- transcription initiation<br />    num Numbering ,         -- a numbering system<br />    psec-str ENUMERATED {   -- protein secondary structure<br />        helix (1) ,         -- any helix<br />        sheet (2) ,         -- beta sheet<br />        turn  (3) } ,       -- beta or gamma turn<br />    non-std-residue VisibleString ,  -- non-standard residue here in seq<br />    het Heterogen ,         -- cofactor, prosthetic grp, etc, bound to seq<br />    biosrc BioSource,<br />    clone Clone-ref,<br />    variation Variation-ref<br />}<br /><br />SeqFeatXref ::= SEQUENCE {       -- both optional because can have one or both<br />    id Feat-id OPTIONAL ,        -- the feature copied<br />    data SeqFeatData OPTIONAL }  -- the specific data<br /><br />--*** CdRegion ***********************************************<br />--*<br />--*  Instructions to translate from a nucleic acid to a peptide<br />--*    conflict means it's supposed to translate but doesn't<br />--*<br /><br /><br />Cdregion ::= SEQUENCE {<br />    orf BOOLEAN OPTIONAL ,             -- just an ORF ?<br />    frame ENUMERATED {<br />        not-set (0) ,                  -- not set, code uses one<br />        one (1) ,<br />        two (2) ,<br />        three (3) } DEFAULT not-set ,      -- reading frame<br />    conflict BOOLEAN OPTIONAL ,        -- conflict<br />    gaps INTEGER OPTIONAL ,            -- number of gaps on conflict/except<br />    mismatch INTEGER OPTIONAL ,        -- number of mismatches on above<br />    code Genetic-code OPTIONAL ,       -- genetic code used<br />    code-break SEQUENCE OF Code-break OPTIONAL ,   -- individual exceptions<br />    stops INTEGER OPTIONAL }           -- number of stop codons on above<br /><br />                    -- each code is 64 cells long, in the order where<br />                    -- T=0,C=1,A=2,G=3, TTT=0, TTC=1, TCA=4, etc<br />                    -- NOTE: this order does NOT correspond to a Seq-data<br />                    -- encoding.  It is "natural" to codon usage instead.<br />                    -- the value in each cell is the AA coded for<br />                    -- start= AA coded only if first in peptide<br />                    --   in start array, if codon is not a legitimate start<br />                    --   codon, that cell will have the "gap" symbol for<br />                    --   that alphabet.  Otherwise it will have the AA<br />                    --   encoded when that codon is used at the start.<br /><br />Genetic-code ::= SET OF CHOICE {<br />    name VisibleString ,               -- name of a code<br />    id INTEGER ,                       -- id in dbase<br />    ncbieaa VisibleString ,            -- indexed to IUPAC extended<br />    ncbi8aa OCTET STRING ,             -- indexed to NCBI8aa<br />    ncbistdaa OCTET STRING ,           -- indexed to NCBIstdaa<br />    sncbieaa VisibleString ,            -- start, indexed to IUPAC extended<br />    sncbi8aa OCTET STRING ,             -- start, indexed to NCBI8aa<br />    sncbistdaa OCTET STRING }           -- start, indexed to NCBIstdaa<br /><br />Code-break ::= SEQUENCE {              -- specific codon exceptions<br />    loc Seq-loc ,                      -- location of exception<br />    aa CHOICE {                        -- the amino acid<br />        ncbieaa INTEGER ,              -- ASCII value of NCBIeaa code<br />        ncbi8aa INTEGER ,              -- NCBI8aa code<br />        ncbistdaa INTEGER } }           -- NCBIstdaa code<br /><br />Genetic-code-table ::= SET OF Genetic-code     -- table of genetic codes<br /><br />--*** Import ***********************************************<br />--*<br />--*  Features imported from other databases<br />--*<br /><br />Imp-feat ::= SEQUENCE {<br />    key VisibleString ,<br />    loc VisibleString OPTIONAL ,         -- original location string<br />    descr VisibleString OPTIONAL }       -- text description<br /><br />Gb-qual ::= SEQUENCE {<br />    qual VisibleString ,<br />    val VisibleString }<br /><br /><br />--*** Clone-ref ***********************************************<br />--*<br />--*  Specification of clone features<br />--*<br /><br />Clone-ref ::= SEQUENCE {<br />    name VisibleString,        -- Official clone symbol<br />    library VisibleString OPTIONAL,     -- Library name<br /><br />    concordant BOOLEAN DEFAULT FALSE, -- OPTIONAL?<br />    unique BOOLEAN DEFAULT FALSE, -- OPTIONAL?<br />    placement-method INTEGER {<br />        end-seq (0),           -- Clone placed by end sequence<br />        insert-alignment (1),  -- Clone placed by insert alignment<br />        sts (2),               -- Clone placed by STS<br />        fish (3),<br />        fingerprint (4),<br />        other (255)<br />    } OPTIONAL,<br />    clone-seq Clone-seq-set OPTIONAL<br />}<br /><br />Clone-seq-set ::= SET OF Clone-seq<br /><br /><br />Clone-seq ::= SEQUENCE {<br />    type INTEGER {<br />        insert (0),<br />        end (1),<br />        other (255)<br />    },<br />    confidence INTEGER {<br />        multiple (0),     -- Multiple hits<br />        na (1),           -- Unspecified<br />        nohit-rep (2),    -- No hits, repetitive<br />        nohitnorep (3),   -- No hits, not repetitive<br />        other-chrm (4),   -- Hit on different chromosome<br />        unique (5),<br />        virtual (6),      -- Virtual (hasn't been sequenced)<br />        other (255)<br />    } OPTIONAL,<br />    location Seq-loc,     -- location on sequence<br />    seq Seq-loc OPTIONAL, -- clone sequence location<br />    align-id Dbtag OPTIONAL<br />}<br /><br />END<br /><br /><br />--*** Variation-ref ***********************************************<br />--*<br />--*  Specification of variation features<br />--*<br /><br />NCBI-Variation DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS Variation-ref, Variation-inst;<br /><br />IMPORTS Int-fuzz, User-object, Object-id, Dbtag FROM NCBI-General<br />        Seq-literal FROM NCBI-Sequence<br />        Seq-loc FROM NCBI-Seqloc<br />        Pub FROM NCBI-Pub;<br /><br />-- --------------------------------------------------------------------------<br />-- Historically, the dbSNP definitions document data structures used in the<br />-- processing and annotation of variations by the dbSNP group.  The intention<br />-- is to provide information to clients that reflect internal information<br />-- produced during the mapping of SNPs<br />-- --------------------------------------------------------------------------<br /><br />VariantProperties ::= SEQUENCE {<br />    version INTEGER,<br /><br />    -- NOTE:<br />    -- The format for each of these values is as an integer<br />    -- Unless otherwise noted, these integers represent a bitwise OR of the<br />    -- possible values, and as such, these values represent the specific bit<br />    -- flags that may be set for each of the possible attributes here.<br /><br />    resource-link INTEGER {<br />        precious         (1), -- Clinical, Pubmed, Cited, (0x01)<br />        provisional      (2), -- Provisional Third Party Annotations (0x02)<br />        has3D            (4), -- Has 3D strcture SNP3D table (0x04)<br />        submitterLinkout (8), -- SNP-&gt;SubSNP-&gt;Batch link_out (0x08)<br />        clinical        (16), -- Clinical if LSDB, OMIM, TPA, Diagnostic<br />        genotypeKit     (32)  -- Marker exists on high density genotyping kit<br />    } OPTIONAL,<br /><br />    gene-function INTEGER {<br />        no-change     (0), -- known to cause no functional changes<br />                           -- since 0 does not combine with any other bit<br />                           -- value, 'no-change' specifically implies that<br />                           -- there are no consequences<br />        in-gene       (1), -- Sequence intervals covered by a gene ID but not<br />                           -- having an aligned transcript (0x01)<br />        in-gene-5     (2), -- In Gene near 5' (0x02)<br />        in-gene-3     (4), -- In Gene near 3' (0x04)<br />        intron        (8), -- In Intron (0x08)<br />        donor        (16), -- In donor splice-site (0x10)<br />        acceptor     (32), -- In acceptor splice-site (0x20)<br />        utr-5        (64), -- In 5' UTR (0x40)<br />        utr-3       (128), -- In 3' UTR (0x80)<br />        synonymous  (256), -- one allele in the set does not change the encoded<br />                           -- amino acid (0x100)<br />        nonsense    (512), -- one allele in the set changes to STOP codon<br />                           -- (TER).  (0x200)<br />        missense   (1024), -- one allele in the set changes protein peptide<br />                           -- (0x400)<br />        frameshift (2048), -- one allele in the set changes all downstream<br />                           -- amino acids (0x800)<br /><br />        in-start-codon(4096), -- the variant is observed in a start codon (0x1000)<br />        up-regulator(8192), -- the variant causes increased transcription<br />                           -- (0x2000)<br />        down-regulator(16384) -- the variant causes decreased transcription<br />                           -- (0x4000)<br />    } OPTIONAL,<br /><br />    mapping INTEGER {<br />        has-other-snp         (1), -- Another SNP has the same mapped positions<br />                                   -- on reference assembly (0x01)<br />        has-assembly-conflict (2), -- Weight 1 or 2 SNPs that map to different<br />                                   -- chromosomes on different assemblies (0x02)<br />        is-assembly-specific  (4)  -- Only maps to 1 assembly (0x04)<br />    } OPTIONAL,<br /><br />    -- This is *NOT* a bitfield<br />    weight INTEGER {<br />        is-uniquely-placed(1),<br />        placed-twice-on-same-chrom(2),<br />        placed-twice-on-diff-chrom(3),<br />        many-placements(10)<br />    } OPTIONAL,<br /><br />    allele-freq INTEGER {<br />        is-mutation      (1), -- low frequency variation that is cited in journal<br />                              -- and other reputable sources (0x01)<br />        above-5pct-all   (2), -- &gt;5% minor allele freq in each and all<br />                              -- populations (0x02)<br />        above-5pct-1plus (4), -- &gt;5% minor allele freq in 1+ populations (0x04)<br />        validated        (8)  -- Bit is set if the variant has 2+ minor allele<br />                              -- count based on freq or genotype data<br />    } OPTIONAL,<br /><br />    genotype INTEGER {<br />        in-haplotype-set (1), -- Exists in a haplotype tagging set (0x01)<br />        has-genotypes    (2)  -- SNP has individual genotype (0x02)<br />    } OPTIONAL,<br /><br />    hapmap INTEGER {<br />        phase1-genotyped (1), -- Phase 1 genotyped; filtered, non-redundant<br />                              -- (0x01)<br />        phase2-genotyped (2), -- Phase 2 genotyped; filtered, non-redundant<br />                              -- (0x02)<br />        phase3-genotyped (4)  -- Phase 3 genotyped; filtered, non-redundant<br />                              -- (0x04)<br />    } OPTIONAL,<br /><br />    quality-check INTEGER {<br />        contig-allele-missing   (1), -- Reference sequence allele at the mapped<br />                                     -- position is not present in the SNP<br />                                     -- allele list, adjusted for orientation<br />                                     -- (0x01)<br />        withdrawn-by-submitter  (2), -- One member SS is withdrawn by submitter<br />                                     -- (0x02)<br />        non-overlapping-alleles (4), -- RS set has 2+ alleles from different<br />                                     -- submissions and these sets share no<br />                                     -- alleles in common (0x04)<br />        strain-specific         (8), -- Straing specific fixed difference (0x08)<br />        genotype-conflict      (16)  -- Has Genotype Conflict (0x10)<br />    } OPTIONAL<br />}<br /><br />Phenotype ::= SEQUENCE {<br />    source VisibleString OPTIONAL,<br />    term VisibleString OPTIONAL,<br />    xref SET OF Dbtag OPTIONAL,<br /><br />    -- does this variant have known clinical significance?<br />    clinical-significance INTEGER {<br />        unknown                 (0),<br />        untested                (1),<br />        non-pathogenic          (2),<br />        probable-non-pathogenic (3),<br />        probable-pathogenic     (4),<br />        pathogenic              (5),<br />        other                   (255)<br />    } OPTIONAL<br />}<br /><br />Population-data ::= SEQUENCE {<br />    -- assayed population (e.g. HAPMAP-CEU)<br />    population VisibleString,<br />    genotype-frequency REAL OPTIONAL,<br />    chromosomes-tested INTEGER OPTIONAL,<br />    sample-ids SET OF Object-id OPTIONAL<br />}<br /><br />Ext-loc ::= SEQUENCE {<br />    id Object-id,<br />    location Seq-loc<br />}<br /><br />Variation-ref ::= SEQUENCE {<br />    -- ids (i.e., SNP rsid / ssid, dbVar nsv/nssv)<br />    -- expected values include 'dbSNP|rs12334', 'dbSNP|ss12345', 'dbVar|nsv1'<br />    --<br />    -- we relate three kinds of IDs here:<br />    --  - our current object's id<br />    --  - the id of this object's parent, if it exists<br />    --  - the sample ID that this item originates from<br />    id        Dbtag OPTIONAL,<br />    parent-id Dbtag OPTIONAL,<br />    sample-id Object-id OPTIONAL,<br />    other-ids SET OF Dbtag OPTIONAL,<br /><br />    -- names and synonyms<br />    -- some variants have well-known canonical names and possible accepted<br />    -- synonyms<br />    name VisibleString OPTIONAL,<br />    synonyms SET OF VisibleString OPTIONAL,<br /><br />    -- tag for comment and descriptions<br />    description VisibleString OPTIONAL,<br /><br />    -- phenotype<br />    phenotype SET OF Phenotype OPTIONAL,<br /><br />    -- sequencing / acuisition method<br />    method SET OF INTEGER {<br />        unknown             (0),<br />        bac-acgh            (1),<br />        computational       (2),<br />        curated             (3),<br />        digital-array       (4),<br />        expression-array    (5),<br />        fish                (6),<br />        flanking-sequence   (7),<br />        maph                (8),<br />        mcd-analysis        (9),<br />        mlpa                (10),<br />        oea-assembly        (11),<br />        oligo-acgh          (12),<br />        paired-end          (13),<br />        pcr                 (14),<br />        qpcr                (15),<br />        read-depth          (16),<br />        roma                (17),<br />        rt-pcr              (18),<br />        sage                (19),<br />        sequence-alignment  (20),<br />        sequencing          (21),<br />        snp-array           (22),<br />        snp-genoytyping     (23),<br />        southern            (24),<br />        western             (25),<br /><br />        other               (255)<br />    } OPTIONAL,<br /><br />    -- Note about SNP representation and pretinent fields: allele-frequency,<br />    -- population, quality-codes:<br />    -- The case of multiple alleles for a SNP would be described by<br />    -- parent-feature of type Variation-set.diff-alleles, where the child<br />    -- features of type Variation-inst, all at the same location, would<br />    -- describe individual alleles.<br /><br />    -- population data<br />    population-data SET OF Population-data OPTIONAL,<br /><br />    -- variant properties bit fields<br />    variant-prop VariantProperties OPTIONAL,<br /><br />    -- has this variant been validated?<br />    validated BOOLEAN OPTIONAL,<br /><br />    -- link-outs to GeneTests database<br />    clinical-test SET OF Dbtag OPTIONAL,<br /><br />    -- origin of this allele, if known<br />    allele-origin INTEGER {<br />        unknown         (0),<br />        germline        (1),<br />        somatic         (2),<br />        inherited       (3),<br />        paternal        (4),<br />        maternal        (5),<br />        de-novo         (6),<br />        biparental      (7),<br />        uniparental     (8),<br />        not-tested      (9),<br />        tested-inconclusive (10),<br /><br />        other           (255)<br />    } OPTIONAL,<br /><br />    -- observed allele state, if known<br />    allele-state INTEGER {<br />        unknown         (0),<br />        homozygous      (1),<br />        heterozygous    (2),<br />        hemizygous      (3),<br />        nullizygous     (4),<br />        other           (255)<br />    } OPTIONAL,<br /><br />    allele-frequency REAL OPTIONAL,<br /><br />    -- is this variant the ancestral allele?<br />    is-ancestral-allele BOOLEAN OPTIONAL,<br /><br />    -- publication support.<br />    -- Note: made this pub instead of pub-equiv, since<br />    -- Pub can be pub-equiv and pub-equiv is a set of pubs, but it looks like<br />    -- Pub is more often used as top-level container<br />    pub Pub OPTIONAL,<br /><br />    data CHOICE {<br />        unknown NULL,<br />        note    VisibleString, --free-form<br />        uniparental-disomy NULL,<br /><br />        -- actual sequence-edit at feat.location<br />        instance        Variation-inst,<br /><br />        -- Set of related Variations.<br />        -- Location of the set equals to the union of member locations<br />        set SEQUENCE {<br />            type INTEGER {<br />                unknown     (0),<br />                compound    (1), -- complex change at the same location on the<br />                                 -- same molecule<br />                products    (2), -- different products arising from the same<br />                                 -- variation in a precursor, e.g. r.[13g&gt;a,<br />                                 -- 13_88del]<br />                haplotype   (3), -- changes on the same allele, e.g<br />                                 -- r.[13g&gt;a;15u&gt;c]<br />                alleles     (4), -- changes on different alleles in the same<br />                                 -- genotype, e.g. g.[476C&gt;T]+[476C&gt;T]<br />                mosaic      (5), -- different genotypes in the same individual<br />                individual  (6), -- same organism; allele relationship unknown,<br />                                 -- e.g. g.[476C&gt;T(+)183G&gt;C]<br />                population  (7), -- population<br />                other       (255)<br />            },<br />            variations SET OF Variation-ref,<br />            name  VisibleString OPTIONAL<br />        }<br />    },<br /><br />    consequence SET OF CHOICE {<br />        unknown     NULL,<br />        splicing    NULL, --some effect on splicing<br />        note        VisibleString,  --freeform<br /><br />        -- Describe resulting variation in the product, e.g. missense,<br />        -- nonsense, silent, neutral, etc in a protein, that arises from<br />        -- THIS variation.<br />        variation   Variation-ref,<br /><br />        -- see http://www.hgvs.org/mutnomen/recs-prot.html<br />        frameshift SEQUENCE {<br />            phase INTEGER OPTIONAL,<br />            x-length INTEGER OPTIONAL<br />        },<br /><br />        loss-of-heterozygosity SEQUENCE {<br />            -- In germline comparison, it will be reference genome assembly<br />            -- (default) or reference/normal population. In somatic mutation,<br />            -- it will be a name of the normal tissue.<br />            reference VisibleString OPTIONAL,<br /><br />            -- Name of the testing subject type or the testing tissue.<br />            test VisibleString OPTIONAL<br />        }<br />    } OPTIONAL,<br /><br />    -- Observed location, if different from the parent set or feature.location.<br />    location        Seq-loc OPTIONAL,<br /><br />    -- reference other locs, e.g. mapped source<br />    ext-locs SET OF Ext-loc OPTIONAL,<br /><br />    ext             User-object OPTIONAL<br /><br />}<br /><br />Delta-item ::= SEQUENCE {<br />    seq CHOICE {<br />        literal Seq-literal,<br />        loc Seq-loc,<br />        this NULL --same location as variation-ref itself<br />    },<br /><br />    -- Multiplier allows representing a tandem, e.g.  ATATAT as AT*3<br />    -- This allows describing CNV/SSR where delta=self  with a<br />    -- multiplier which specifies the count of the repeat unit.<br /><br />    multiplier          INTEGER OPTIONAL, --assumed 1 if not specified.<br />    multiplier-fuzz     Int-fuzz OPTIONAL<br />}<br /><br />-- Variation instance<br />Variation-inst ::= SEQUENCE {<br />    type INTEGER {<br />        unknown         (0),<br />        identity        (1),    -- delta = this<br />        inv             (2),    -- inversion: delta =<br />                                -- reverse-comp(feat.location)<br />        snp             (3),    -- delins where len(del) = len(ins) = 1<br />        mnp             (4),    -- delins where len(del) = len(ins) &gt; 1<br />        delins          (5),    -- delins where len(del) != len(ins)<br />        del             (6),    -- deltaseq is empty<br />        ins             (7),    -- deltaseq contains [this, ins] or [ins, this]<br />        microsatellite  (8),    -- location describes tandem sequence;<br />                                --   delta is the repeat-unit with a multiplier<br />        transposon      (9),    -- delta refers to equivalent sequence in<br />                                -- another location.<br />                                --   ext-loc describes donor sequence, if known<br />                                -- (could be location itself)<br />        cnv             (10),   -- general CNV class, indicating "local"<br />                                -- rearrangement<br /><br />        -- Below are four possible copy configurations,<br />        -- where delta is a seq-loc on the same sequence.<br />        -- If the repeat is represented on the sequence, it is<br />        -- described like a transposon; if it is a de-novo<br />        -- repeat, it is described like an insertion.<br />        direct-copy     (11),   -- delta sequence is located upstream, same<br />                                -- strand<br />        rev-direct-copy (12),   -- delta sequence is downstream, same strand<br />        inverted-copy   (13),   -- delta sequence is upstream, opposite strand<br />        everted-copy    (14),   -- delta sequence is downstream, opposite strand<br /><br />        translocation   (15),   -- feat.location is swapped with delta (i.e.<br />                                -- reciprocal transposon)<br />        prot-missense   (16),<br />        prot-nonsense   (17),<br />        prot-neutral    (18),<br />        prot-silent     (19),<br />        prot-other      (20),<br /><br />        other           (255)<br />    },<br /><br />    -- Sequence that replaces the location, in biological order.<br />    delta SEQUENCE OF Delta-item<br />}<br /><br />END<br /><br /><br />--**********************************************************************<br />--<br />--  NCBI Restriction Sites<br />--  by James Ostell, 1990<br />--  version 0.8<br />--<br />--**********************************************************************<br /><br />NCBI-Rsite DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS Rsite-ref;<br /><br />IMPORTS Dbtag FROM NCBI-General;<br /><br />Rsite-ref ::= CHOICE {<br />    str VisibleString ,     -- may be unparsable<br />    db  Dbtag }             -- pointer to a restriction site database<br /><br />END<br /><br />--**********************************************************************<br />--<br />--  NCBI RNAs<br />--  by James Ostell, 1990<br />--  version 0.8<br />--<br />--**********************************************************************<br /><br />NCBI-RNA DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS RNA-ref, Trna-ext, RNA-gen, RNA-qual, RNA-qual-set;<br /><br />IMPORTS Seq-loc FROM NCBI-Seqloc;<br /><br />--*** rnas ***********************************************<br />--*<br />--*  various rnas<br />--*<br />                         -- minimal RNA sequence<br />RNA-ref ::= SEQUENCE {<br />    type ENUMERATED {            -- type of RNA feature<br />        unknown (0) ,<br />        premsg (1) ,<br />        mRNA (2) ,<br />        tRNA (3) ,<br />        rRNA (4) ,<br />        snRNA (5) ,              -- will become ncRNA, with RNA-gen.class = snRNA<br />        scRNA (6) ,              -- will become ncRNA, with RNA-gen.class = scRNA<br />        snoRNA (7) ,             -- will become ncRNA, with RNA-gen.class = snoRNA<br />        ncRNA (8) ,              -- non-coding RNA; subsumes snRNA, scRNA, snoRNA<br />        tmRNA (9) ,<br />        miscRNA (10) ,<br />        other (255) } ,<br />    pseudo BOOLEAN OPTIONAL ,<br />    ext CHOICE {<br />        name VisibleString ,        -- for naming "other" type<br />        tRNA Trna-ext ,             -- for tRNAs<br />        gen RNA-gen } OPTIONAL      -- generic fields for ncRNA, tmRNA, miscRNA<br />    }<br /><br />Trna-ext ::= SEQUENCE {                 -- tRNA feature extensions<br />    aa CHOICE {                         -- aa this carries<br />        iupacaa INTEGER ,<br />        ncbieaa INTEGER ,<br />        ncbi8aa INTEGER ,<br />        ncbistdaa INTEGER } OPTIONAL ,<br />    codon SET OF INTEGER OPTIONAL ,     -- codon(s) as in Genetic-code<br />    anticodon Seq-loc OPTIONAL }        -- location of anticodon<br /><br />RNA-gen ::= SEQUENCE {<br />    class VisibleString OPTIONAL ,      -- for ncRNAs, the class of non-coding RNA:<br />                                        -- examples: antisense_RNA, guide_RNA, snRNA<br />    product VisibleString OPTIONAL ,<br />    quals RNA-qual-set OPTIONAL         -- e.g., tag_peptide qualifier for tmRNAs<br />}<br /><br />RNA-qual ::= SEQUENCE {                 -- Additional data values for RNA-gen,<br />    qual VisibleString ,                -- in a tag (qual), value (val) format<br />    val VisibleString }<br /><br />RNA-qual-set ::= SEQUENCE OF RNA-qual<br /><br />END<br /><br />--**********************************************************************<br />--<br />--  NCBI Genes<br />--  by James Ostell, 1990<br />--  version 0.8<br />--<br />--**********************************************************************<br /><br />NCBI-Gene DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS Gene-ref, Gene-nomenclature;<br /><br />IMPORTS Dbtag FROM NCBI-General;<br /><br />--*** Gene ***********************************************<br />--*<br />--*  reference to a gene<br />--*<br /><br />Gene-ref ::= SEQUENCE {<br />    locus VisibleString OPTIONAL ,        -- Official gene symbol<br />    allele VisibleString OPTIONAL ,       -- Official allele designation<br />    desc VisibleString OPTIONAL ,         -- descriptive name<br />    maploc VisibleString OPTIONAL ,       -- descriptive map location<br />    pseudo BOOLEAN DEFAULT FALSE ,        -- pseudogene<br />    db SET OF Dbtag OPTIONAL ,            -- ids in other dbases<br />    syn SET OF VisibleString OPTIONAL ,   -- synonyms for locus<br />    locus-tag VisibleString OPTIONAL ,    -- systematic gene name (e.g., MI0001, ORF0069)<br />    formal-name Gene-nomenclature OPTIONAL<br />}<br /><br />Gene-nomenclature ::= SEQUENCE {<br />    status ENUMERATED {<br />        unknown (0) ,<br />        official (1) ,<br />        interim (2)<br />    } ,<br />    symbol VisibleString OPTIONAL ,<br />    name VisibleString OPTIONAL ,<br />    source Dbtag OPTIONAL<br />}<br /><br />END<br /><br /><br />--**********************************************************************<br />--<br />--  NCBI Organism<br />--  by James Ostell, 1994<br />--  version 3.0<br />--<br />--**********************************************************************<br /><br />NCBI-Organism DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS Org-ref;<br /><br />IMPORTS Dbtag FROM NCBI-General;<br /><br />--*** Org-ref ***********************************************<br />--*<br />--*  Reference to an organism<br />--*     defines only the organism.. lower levels of detail for biological<br />--*     molecules are provided by the Source object<br />--*<br /><br />Org-ref ::= SEQUENCE {<br />    taxname VisibleString OPTIONAL ,   -- preferred formal name<br />    common VisibleString OPTIONAL ,    -- common name<br />    mod SET OF VisibleString OPTIONAL , -- unstructured modifiers<br />    db SET OF Dbtag OPTIONAL ,         -- ids in taxonomic or culture dbases<br />    syn SET OF VisibleString OPTIONAL ,  -- synonyms for taxname or common<br />    orgname OrgName OPTIONAL }<br /><br /><br />OrgName ::= SEQUENCE {<br />    name CHOICE {<br />        binomial BinomialOrgName ,         -- genus/species type name<br />        virus VisibleString ,              -- virus names are different<br />        hybrid MultiOrgName ,              -- hybrid between organisms<br />        namedhybrid BinomialOrgName ,      -- some hybrids have genus x species name<br />        partial PartialOrgName } OPTIONAL , -- when genus not known<br />    attrib VisibleString OPTIONAL ,        -- attribution of name<br />    mod SEQUENCE OF OrgMod OPTIONAL ,<br />    lineage VisibleString OPTIONAL ,       -- lineage with semicolon separators<br />    gcode INTEGER OPTIONAL ,               -- genetic code (see CdRegion)<br />    mgcode INTEGER OPTIONAL ,              -- mitochondrial genetic code<br />    div VisibleString OPTIONAL }           -- GenBank division code<br /><br /><br />OrgMod ::= SEQUENCE {<br />    subtype INTEGER {<br />        strain (2) ,<br />        substrain (3) ,<br />        type (4) ,<br />        subtype (5) ,<br />        variety (6) ,<br />        serotype (7) ,<br />        serogroup (8) ,<br />        serovar (9) ,<br />        cultivar (10) ,<br />        pathovar (11) ,<br />        chemovar (12) ,<br />        biovar (13) ,<br />        biotype (14) ,<br />        group (15) ,<br />        subgroup (16) ,<br />        isolate (17) ,<br />        common (18) ,<br />        acronym (19) ,<br />        dosage (20) ,          -- chromosome dosage of hybrid<br />        nat-host (21) ,        -- natural host of this specimen<br />        sub-species (22) ,<br />        specimen-voucher (23) ,<br />        authority (24) ,<br />        forma (25) ,<br />        forma-specialis (26) ,<br />        ecotype (27) ,<br />        synonym (28) ,<br />        anamorph (29) ,<br />        teleomorph (30) ,<br />        breed (31) ,<br />        gb-acronym (32) ,       -- used by taxonomy database<br />        gb-anamorph (33) ,      -- used by taxonomy database<br />        gb-synonym (34) ,       -- used by taxonomy database<br />        culture-collection (35) ,<br />        bio-material (36) ,<br />        metagenome-source (37) ,<br />        old-lineage (253) ,<br />        old-name (254) ,<br />        other (255) } ,         -- ASN5: old-name (254) will be added to next spec<br />    subname VisibleString ,<br />    attrib VisibleString OPTIONAL }  -- attribution/source of name<br /><br />BinomialOrgName ::= SEQUENCE {<br />    genus VisibleString ,               -- required<br />    species VisibleString OPTIONAL ,    -- species required if subspecies used<br />    subspecies VisibleString OPTIONAL }<br /><br />MultiOrgName ::= SEQUENCE OF OrgName   -- the first will be used to assign division<br /><br />PartialOrgName ::= SEQUENCE OF TaxElement  -- when we don't know the genus<br /><br />TaxElement ::= SEQUENCE {<br />    fixed-level INTEGER {<br />       other (0) ,                     -- level must be set in string<br />       family (1) ,<br />       order (2) ,<br />       class (3) } ,<br />    level VisibleString OPTIONAL ,<br />    name VisibleString }<br /><br />END<br /><br /><br />--**********************************************************************<br />--<br />--  NCBI BioSource<br />--  by James Ostell, 1994<br />--  version 3.0<br />--<br />--**********************************************************************<br /><br />NCBI-BioSource DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS BioSource;<br /><br />IMPORTS Org-ref FROM NCBI-Organism;<br /><br />--********************************************************************<br />--<br />-- BioSource gives the source of the biological material<br />--   for sequences<br />--<br />--********************************************************************<br /><br />BioSource ::= SEQUENCE {<br />    genome INTEGER {         -- biological context<br />        unknown (0) ,<br />        genomic (1) ,<br />        chloroplast (2) ,<br />        chromoplast (3) ,<br />        kinetoplast (4) ,<br />        mitochondrion (5) ,<br />        plastid (6) ,<br />        macronuclear (7) ,<br />        extrachrom (8) ,<br />        plasmid (9) ,<br />        transposon (10) ,<br />        insertion-seq (11) ,<br />        cyanelle (12) ,<br />        proviral (13) ,<br />        virion (14) ,<br />        nucleomorph (15) ,<br />        apicoplast (16) ,<br />        leucoplast (17) ,<br />        proplastid (18) ,<br />        endogenous-virus (19) ,<br />        hydrogenosome (20) ,<br />        chromosome (21) ,<br />        chromatophore (22)<br />      } DEFAULT unknown ,<br />    origin INTEGER {<br />      unknown (0) ,<br />      natural (1) ,                    -- normal biological entity<br />      natmut (2) ,                     -- naturally occurring mutant<br />      mut (3) ,                        -- artificially mutagenized<br />      artificial (4) ,                 -- artificially engineered<br />      synthetic (5) ,                  -- purely synthetic<br />      other (255)<br />    } DEFAULT unknown ,<br />    org Org-ref ,<br />    subtype SEQUENCE OF SubSource OPTIONAL ,<br />    is-focus NULL OPTIONAL ,           -- to distinguish biological focus<br />    pcr-primers PCRReactionSet OPTIONAL }<br /><br />PCRReactionSet ::= SET OF PCRReaction<br /><br />PCRReaction ::= SEQUENCE {<br />    forward PCRPrimerSet OPTIONAL ,<br />    reverse PCRPrimerSet OPTIONAL }<br /><br />PCRPrimerSet ::= SET OF PCRPrimer<br /><br />PCRPrimer ::= SEQUENCE {<br />    seq PCRPrimerSeq OPTIONAL ,<br />    name PCRPrimerName OPTIONAL }<br /><br />PCRPrimerSeq ::= VisibleString<br /><br />PCRPrimerName ::= VisibleString<br /><br />SubSource ::= SEQUENCE {<br />    subtype INTEGER {<br />        chromosome (1) ,<br />        map (2) ,<br />        clone (3) ,<br />        subclone (4) ,<br />        haplotype (5) ,<br />        genotype (6) ,<br />        sex (7) ,<br />        cell-line (8) ,<br />        cell-type (9) ,<br />        tissue-type (10) ,<br />        clone-lib (11) ,<br />        dev-stage (12) ,<br />        frequency (13) ,<br />        germline (14) ,<br />        rearranged (15) ,<br />        lab-host (16) ,<br />        pop-variant (17) ,<br />        tissue-lib (18) ,<br />        plasmid-name (19) ,<br />        transposon-name (20) ,<br />        insertion-seq-name (21) ,<br />        plastid-name (22) ,<br />        country (23) ,<br />        segment (24) ,<br />        endogenous-virus-name (25) ,<br />        transgenic (26) ,<br />        environmental-sample (27) ,<br />        isolation-source (28) ,<br />        lat-lon (29) ,          -- +/- decimal degrees<br />        collection-date (30) ,  -- DD-MMM-YYYY format<br />        collected-by (31) ,     -- name of person who collected the sample<br />        identified-by (32) ,    -- name of person who identified the sample<br />        fwd-primer-seq (33) ,   -- sequence (possibly more than one; semicolon-separated)<br />        rev-primer-seq (34) ,   -- sequence (possibly more than one; semicolon-separated)<br />        fwd-primer-name (35) ,<br />        rev-primer-name (36) ,<br />        metagenomic (37) ,<br />        mating-type (38) ,<br />        linkage-group (39) ,<br />        haplogroup (40) ,<br />        other (255) } ,<br />    name VisibleString ,<br />    attrib VisibleString OPTIONAL }    -- attribution/source of this name<br /><br />END<br /><br />--**********************************************************************<br />--<br />--  NCBI Protein<br />--  by James Ostell, 1990<br />--  version 0.8<br />--<br />--**********************************************************************<br /><br />NCBI-Protein DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS Prot-ref;<br /><br />IMPORTS Dbtag FROM NCBI-General;<br /><br />--*** Prot-ref ***********************************************<br />--*<br />--*  Reference to a protein name<br />--*<br /><br />Prot-ref ::= SEQUENCE {<br />    name SET OF VisibleString OPTIONAL ,      -- protein name<br />    desc VisibleString OPTIONAL ,      -- description (instead of name)<br />    ec SET OF VisibleString OPTIONAL , -- E.C. number(s)<br />    activity SET OF VisibleString OPTIONAL ,  -- activities<br />    db SET OF Dbtag OPTIONAL ,         -- ids in other dbases<br />    processed ENUMERATED {             -- processing status<br />       not-set (0) ,<br />       preprotein (1) ,<br />       mature (2) ,<br />       signal-peptide (3) ,<br />       transit-peptide (4) } DEFAULT not-set }<br /><br />END<br />--********************************************************************<br />--<br />--  Transcription Initiation Site Feature Data Block<br />--  James Ostell, 1991<br />--  Philip Bucher, David Ghosh<br />--  version 1.1<br />--<br />--<br />--<br />--********************************************************************<br /><br />NCBI-TxInit DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS Txinit;<br /><br />IMPORTS Gene-ref FROM NCBI-Gene<br />        Prot-ref FROM NCBI-Protein<br />        Org-ref FROM NCBI-Organism;<br /><br />Txinit ::= SEQUENCE {<br />    name VisibleString ,    -- descriptive name of initiation site<br />    syn SEQUENCE OF VisibleString OPTIONAL ,   -- synonyms<br />    gene SEQUENCE OF Gene-ref OPTIONAL ,  -- gene(s) transcribed<br />    protein SEQUENCE OF Prot-ref OPTIONAL ,   -- protein(s) produced<br />    rna SEQUENCE OF VisibleString OPTIONAL ,  -- rna(s) produced<br />    expression VisibleString OPTIONAL ,  -- tissue/time of expression<br />    txsystem ENUMERATED {       -- transcription apparatus used at this site<br />        unknown (0) ,<br />        pol1 (1) ,      -- eukaryotic Pol I<br />        pol2 (2) ,      -- eukaryotic Pol II<br />        pol3 (3) ,      -- eukaryotic Pol III<br />        bacterial (4) ,<br />        viral (5) ,<br />        rna (6) ,       -- RNA replicase<br />        organelle (7) ,<br />        other (255) } ,<br />    txdescr VisibleString OPTIONAL ,   -- modifiers on txsystem<br />    txorg Org-ref OPTIONAL ,  -- organism supplying transcription apparatus<br />    mapping-precise BOOLEAN DEFAULT FALSE ,  -- mapping precise or approx<br />    location-accurate BOOLEAN DEFAULT FALSE , -- does Seq-loc reflect mapping<br />    inittype ENUMERATED {<br />        unknown (0) ,<br />        single (1) ,<br />        multiple (2) ,<br />        region (3) } OPTIONAL ,<br />    evidence SET OF Tx-evidence OPTIONAL }<br /><br />Tx-evidence ::= SEQUENCE {<br />    exp-code ENUMERATED {<br />        unknown (0) ,<br />        rna-seq (1) ,   -- direct RNA sequencing<br />        rna-size (2) ,  -- RNA length measurement<br />        np-map (3) ,    -- nuclease protection mapping with homologous sequence ladder<br />        np-size (4) ,   -- nuclease protected fragment length measurement<br />        pe-seq (5) ,    -- dideoxy RNA sequencing<br />        cDNA-seq (6) ,  -- full-length cDNA sequencing<br />        pe-map (7) ,    -- primer extension mapping with homologous sequence ladder<br />        pe-size (8) ,   -- primer extension product length measurement<br />        pseudo-seq (9) , -- full-length processed pseudogene sequencing<br />        rev-pe-map (10) ,   -- see NOTE (1) below<br />        other (255) } ,<br />    expression-system ENUMERATED {<br />        unknown (0) ,<br />        physiological (1) ,<br />        in-vitro (2) ,<br />        oocyte (3) ,<br />        transfection (4) ,<br />        transgenic (5) ,<br />        other (255) } DEFAULT physiological ,<br />    low-prec-data BOOLEAN DEFAULT FALSE ,<br />    from-homolog BOOLEAN DEFAULT FALSE }     -- experiment actually done on<br />                                             --  close homolog<br /><br />    -- NOTE (1) length measurement of a reverse direction primer-extension<br />    --          product (blocked  by  RNA  5'end)  by  comparison with<br />    --          homologous sequence ladder (J. Mol. Biol. 199, 587)<br /><br />END</pre></div><div class="sec" id="ch_datamod._ASN1_Specification_s_10"><h3><span class="title">ASN.1 Specification: seqalign.asn</span></h3><p>See also the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/seqalign/seqalign.asn">online-version</a> of this specification, which may be more up-to-date.</p><pre>--$Revision$<br />--**********************************************************************<br />--<br />--  NCBI Sequence Alignment elements<br />--  by James Ostell, 1990<br />--<br />--**********************************************************************<br /><br />NCBI-Seqalign DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS Seq-align, Score, Score-set, Seq-align-set;<br /><br />IMPORTS Seq-id, Seq-loc , Na-strand FROM NCBI-Seqloc<br />        User-object, Object-id FROM NCBI-General;<br /><br />--*** Sequence Alignment ********************************<br />--*<br /><br />Seq-align-set ::= SET OF Seq-align<br /><br />Seq-align ::= SEQUENCE {<br />    type ENUMERATED {<br />        not-set (0) ,<br />        global (1) ,<br />        diags (2) ,     -- unbroken, but not ordered, diagonals<br />        partial (3) ,   -- mapping pieces together<br />        disc (4) ,      -- discontinuous alignment<br />        other (255) } ,<br />    dim INTEGER OPTIONAL ,     -- dimensionality<br />    score SET OF Score OPTIONAL ,   -- for whole alignment<br />    segs CHOICE {                   -- alignment data<br />        dendiag SEQUENCE OF Dense-diag ,<br />        denseg              Dense-seg ,<br />        std     SEQUENCE OF Std-seg ,<br />        packed              Packed-seg ,<br />        disc                Seq-align-set,<br />        spliced             Spliced-seg,<br />        sparse              Sparse-seg<br />    } ,<br />    <br />    -- regions of sequence over which align<br />    --  was computed<br />    bounds SET OF Seq-loc OPTIONAL,<br /><br />    -- alignment id<br />    id SEQUENCE OF Object-id OPTIONAL,<br /><br />    --extra info<br />    ext SEQUENCE OF User-object OPTIONAL<br />}<br /><br />Dense-diag ::= SEQUENCE {         -- for (multiway) diagonals<br />    dim INTEGER DEFAULT 2 ,    -- dimensionality<br />    ids SEQUENCE OF Seq-id ,   -- sequences in order<br />    starts SEQUENCE OF INTEGER ,  -- start OFFSETS in ids order<br />    len INTEGER ,                 -- len of aligned segments<br />    strands SEQUENCE OF Na-strand OPTIONAL ,<br />    scores SET OF Score OPTIONAL }<br /><br />    -- Dense-seg: the densist packing for sequence alignments only.<br />    --            a start of -1 indicates a gap for that sequence of<br />    --            length lens.<br />    --<br />    -- id=100  AAGGCCTTTTAGAGATGATGATGATGATGA<br />    -- id=200  AAGGCCTTTTAG.......GATGATGATGA<br />    -- id=300  ....CCTTTTAGAGATGATGAT....ATGA<br />    --<br />    -- dim = 3, numseg = 6, ids = { 100, 200, 300 }<br />    -- starts = { 0,0,-1, 4,4,0, 12,-1,8, 19,12,15, 22,15,-1, 26,19,18 }<br />    -- lens = { 4, 8, 7, 3, 4, 4 }<br />    --<br /><br />Dense-seg ::= SEQUENCE {          -- for (multiway) global or partial alignments<br />    dim INTEGER DEFAULT 2 ,       -- dimensionality<br />    numseg INTEGER ,              -- number of segments here<br />    ids SEQUENCE OF Seq-id ,      -- sequences in order<br />    starts SEQUENCE OF INTEGER ,  -- start OFFSETS in ids order within segs<br />    lens SEQUENCE OF INTEGER ,    -- lengths in ids order within segs<br />    strands SEQUENCE OF Na-strand OPTIONAL ,<br />    scores SEQUENCE OF Score OPTIONAL }  -- score for each seg<br /><br />Packed-seg ::= SEQUENCE {         -- for (multiway) global or partial alignments<br />    dim INTEGER DEFAULT 2 ,       -- dimensionality<br />    numseg INTEGER ,              -- number of segments here<br />    ids SEQUENCE OF Seq-id ,      -- sequences in order<br />    starts SEQUENCE OF INTEGER ,  -- start OFFSETS in ids order for whole alignment<br />    present OCTET STRING ,        -- Boolean if each sequence present or absent in<br />                                  --   each segment<br />    lens SEQUENCE OF INTEGER ,    -- length of each segment<br />    strands SEQUENCE OF Na-strand OPTIONAL ,<br />    scores SEQUENCE OF Score OPTIONAL }  -- score for each segment<br /><br />Std-seg ::= SEQUENCE {<br />    dim INTEGER DEFAULT 2 ,       -- dimensionality<br />    ids SEQUENCE OF Seq-id OPTIONAL ,<br />    loc SEQUENCE OF Seq-loc ,<br />    scores SET OF Score OPTIONAL }<br /><br /><br />Spliced-seg ::= SEQUENCE {<br />    -- product is either protein or transcript (cDNA)<br />    product-id Seq-id OPTIONAL,<br />    genomic-id Seq-id OPTIONAL,<br /><br />    -- should be 'plus' or 'minus'<br />    product-strand Na-strand OPTIONAL ,<br />    genomic-strand Na-strand OPTIONAL ,<br />    <br />    product-type ENUMERATED {<br />        transcript(0),<br />        protein(1)<br />    },<br /><br />    -- set of segments involved<br />    -- each segment corresponds to one exon<br />    -- exons are always in biological order<br />    exons SEQUENCE OF Spliced-exon ,<br /><br />    -- start of poly(A) tail on the transcript<br />    -- For sense transcripts:<br />    --   aligned product positions &lt; poly-a &lt;= product-length<br />    --   poly-a == product-length indicates inferred poly(A) tail at transcript's end<br />    -- For antisense transcripts:<br />    --   -1 &lt;= poly-a &lt; aligned product positions<br />    --   poly-a == -1 indicates inferred poly(A) tail at transcript's start<br />    poly-a INTEGER OPTIONAL,<br /><br />    -- length of the product, in bases/residues<br />    -- from this (or from poly-a if present), a 3' unaligned length can be extracted<br />    product-length INTEGER OPTIONAL,<br /><br />    -- alignment descriptors / modifiers<br />    -- this provides us a set for extension<br />    modifiers SET OF Spliced-seg-modifier OPTIONAL<br />}<br /><br />Spliced-seg-modifier ::= CHOICE {<br />    -- protein aligns from the start and the first codon <br />    -- on both product and genomic is start codon<br />    start-codon-found BOOLEAN,<br />    <br />    -- protein aligns to it's end and there is stop codon <br />    -- on the genomic right after the alignment<br />    stop-codon-found BOOLEAN<br />}<br /><br /><br />-- complete or partial exon<br />-- two consecutive Spliced-exons may belong to one exon<br />Spliced-exon ::= SEQUENCE {<br />    -- product-end &gt;= product-start<br />    product-start Product-pos ,<br />    product-end Product-pos ,<br /><br />    -- genomic-end &gt;= genomic-start<br />    genomic-start INTEGER ,<br />    genomic-end INTEGER ,<br /><br />    -- product is either protein or transcript (cDNA)<br />    product-id Seq-id OPTIONAL ,<br />    genomic-id Seq-id OPTIONAL ,<br /><br />    -- should be 'plus' or 'minus'<br />    product-strand Na-strand OPTIONAL ,<br />    <br />    -- genomic-strand represents the strand of translation<br />    genomic-strand Na-strand OPTIONAL ,<br /><br />    -- basic seqments always are in biologic order<br />    parts SEQUENCE OF Spliced-exon-chunk OPTIONAL ,<br /><br />    -- scores for this exon<br />    scores Score-set OPTIONAL ,<br /><br />    -- splice sites<br />    acceptor-before-exon Splice-site OPTIONAL,<br />    donor-after-exon Splice-site OPTIONAL,<br />    <br />    -- flag: is this exon complete or partial?<br />    partial BOOLEAN OPTIONAL,<br /><br />    --extra info<br />    ext SEQUENCE OF User-object OPTIONAL<br />}<br /><br /><br />Product-pos ::= CHOICE {<br />    nucpos INTEGER,<br />    protpos Prot-pos<br />}<br /><br /><br />-- codon based position on protein (1/3 of aminoacid)<br />Prot-pos ::= SEQUENCE {<br />    -- standard protein position<br />    amin INTEGER ,<br /><br />    -- 0, 1, 2, or 3 as for Cdregion<br />    -- 0 = not set<br />    -- 1, 2, 3 = actual frame<br />    frame INTEGER DEFAULT 0<br />}<br /><br /><br />-- Spliced-exon-chunk: piece of an exon<br />-- lengths are given in nucleotide bases (1/3 of aminoacid when product is a<br />-- protein)<br />Spliced-exon-chunk ::= CHOICE {<br />    -- both sequences represented, product and genomic sequences match<br />    match INTEGER ,<br /><br />    -- both sequences represented, product and genomic sequences do not match<br />    mismatch INTEGER ,<br /><br />    -- both sequences are represented, there is sufficient similarity <br />    -- between product and genomic sequences. Can be used to replace stretches<br />    -- of matches and mismatches, mostly for protein to genomic where <br />    -- definition of match or mismatch depends on translation table<br />    diag INTEGER ,<br /><br />     -- insertion in product sequence (i.e. gap in the genomic sequence)<br />    product-ins INTEGER ,<br /><br />     -- insertion in genomic sequence (i.e. gap in the product sequence)<br />    genomic-ins INTEGER<br />}<br /><br /><br />-- site involved in splice<br />Splice-site ::= SEQUENCE {<br />    -- typically two bases in the intronic region, always<br />    -- in IUPAC format<br />    bases VisibleString<br />}<br /><br /><br />-- ==========================================================================<br />--<br />-- Sparse-seg follows the semantics of dense-seg and is more optimal for<br />-- representing sparse multiple alignments<br />--<br />-- ==========================================================================<br /><br /><br />Sparse-seg ::= SEQUENCE {<br />    master-id Seq-id OPTIONAL,<br /><br />    -- pairwise alignments constituting this multiple alignment<br />    rows SET OF Sparse-align,<br /><br />    -- per-row scores<br />    row-scores SET OF Score OPTIONAL,<br /><br />    -- index of extra items<br />    ext  SET OF Sparse-seg-ext OPTIONAL<br />}<br /><br />Sparse-align ::= SEQUENCE {<br />    first-id Seq-id,<br />    second-id Seq-id,<br /><br />    numseg INTEGER,                      --number of segments<br />    first-starts SEQUENCE OF INTEGER ,   --starts on the first sequence [numseg]<br />    second-starts SEQUENCE OF INTEGER ,  --starts on the second sequence [numseg]<br />    lens SEQUENCE OF INTEGER ,           --lengths of segments [numseg]<br />    second-strands SEQUENCE OF Na-strand OPTIONAL ,<br /><br />    -- per-segment scores<br />    seg-scores SET OF Score OPTIONAL<br />}<br /><br />Sparse-seg-ext ::= SEQUENCE {<br />    --seg-ext SET OF {<br />    --    index INTEGER,<br />    --    data User-field<br />    -- }<br />    index INTEGER<br />}<br /><br /><br /><br />-- use of Score is discouraged for external ASN.1 specifications<br />Score ::= SEQUENCE {<br />    id Object-id OPTIONAL ,<br />    value CHOICE {<br />        real REAL ,<br />        int INTEGER<br />    }<br />}<br /><br />-- use of Score-set is encouraged for external ASN.1 specifications<br />Score-set ::= SET OF Score<br /><br />END</pre></div><div class="sec" id="ch_datamod._ASN1_Specification_s_11"><h3><span class="title">ASN.1 Specification: seqres.asn</span></h3><p>See also the <a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/source/src/objects/seqres/seqres.asn">online-version</a> of this specification, which may be more up-to-date.</p><pre>--$Revision$<br />--**********************************************************************<br />--<br />--  NCBI Sequence Analysis Results (other than alignments)<br />--  by James Ostell, 1990<br />--<br />--**********************************************************************<br /><br />NCBI-Seqres DEFINITIONS ::=<br />BEGIN<br /><br />EXPORTS Seq-graph;<br /><br />IMPORTS Seq-loc FROM NCBI-Seqloc;<br /><br />--*** Sequence Graph ********************************<br />--*<br />--*   for values mapped by residue or range to sequence<br />--*<br /><br />Seq-graph ::= SEQUENCE {<br />    title VisibleString OPTIONAL ,<br />    comment VisibleString OPTIONAL ,<br />    loc Seq-loc ,                       -- region this applies to<br />    title-x VisibleString OPTIONAL ,    -- title for x-axis<br />    title-y VisibleString OPTIONAL ,<br />    comp INTEGER OPTIONAL ,             -- compression (residues/value)<br />    a REAL OPTIONAL ,                   -- for scaling values<br />    b REAL OPTIONAL ,                   -- display = (a x value) + b<br />    numval INTEGER ,                    -- number of values in graph<br />    graph CHOICE {<br />        real Real-graph ,<br />        int Int-graph ,<br />        byte Byte-graph } }<br /><br />Real-graph ::= SEQUENCE {<br />    max REAL ,                          -- top of graph<br />    min REAL ,                          -- bottom of graph<br />    axis REAL ,                         -- value to draw axis on<br />    values SEQUENCE OF REAL }<br /><br />Int-graph ::= SEQUENCE {<br />    max INTEGER ,<br />    min INTEGER ,<br />    axis INTEGER ,<br />    values SEQUENCE OF INTEGER } <br /><br />Byte-graph ::= SEQUENCE {              -- integer from 0-255<br />    max INTEGER ,<br />    min INTEGER ,<br />    axis INTEGER ,<br />    values OCTET STRING }<br /><br />END</pre></div></div></div></div><div id="tkb_internal" class="col four_col last"><div class="portlet"><div class="portlet_head"><div class="portlet_title"><h3>In this page</h3></div></div><div class="portlet_content"><ul><li><a href="#ch_datamod.datamodel.data_model">Data Model</a></li><li><a href="#ch_datamod.datamodel.general">General Use Objects</a></li><li><a href="#ch_datamod.datamodel.biblio">Bibliographic References</a></li><li><a href="#ch_datamod.datamodel.medline">MEDLINE Data</a></li><li><a href="#ch_datamod._Biological_Sequences_1">Biological Sequences</a></li><li><a href="#ch_datamod.datamodel.seqset">Collections of Sequences</a></li><li><a href="#ch_datamod.datamodel.seqloc">Sequence Locations and Identifiers</a></li><li><a href="#ch_datamod.datamodel.seqfeat">Sequence Features</a></li><li><a href="#ch_datamod._Sequence_Alignments_1">Sequence Alignments</a></li><li><a href="#ch_datamod.datamodel.seqres">Sequence Graphs</a></li><li><a href="#ch_datamod.Common_ASN1_Specifications">Common ASN.1 Specifications</a></li></ul></div></div><div class="portlet"><div class="portlet_head"><div class="portlet_title"><h3>Download</h3></div></div><div class="portlet_content"><ul><li><a href="pdf/ch_datamod.pdf">PDF version of this page</a></li></ul></div></div><div class="portlet"><div class="portlet_head"><div class="portlet_title"><h3>Search</h3></div></div><div class="portlet_content"><form name="frmSymbolSearch" onsubmit="return SymbolSearch('toolkit')" action="/" id="frmSymbolSearch"><table><tbody><tr align="center" valign="middle"><td colspan="2" nowrap="nowrap"><input id="search_box" name="__symbol" style="vertical-align:                                        middle; line-height:normal " onkeypress="SymbolSearchKeyPress('toolkit',event)" type="text" />Â Â 					<label for="search_box" class="offscreen_noflow">Search term</label><button type="submit" value="Search" style="vertical-align:                                        middle; line-height:normal;" onclick="javasrcipt:SymbolSearch('toolkit');">Search</button></td></tr><tr class="internal-only"><th style="text-align:left">Public</th><th style="text-align:left">Internal</th></tr><tr><td><input id="pToolkitAll" name="__symboloc" type="radio" checked="checked" /><label for="pToolkitAll" title="Search in the C/C++ source code and in this Book">All</label></td><td class="internal-only"><input id="iToolkitAll" name="__symboloc" type="radio" /><label for="iToolkitAll" title="Search in the C/C++ source code,  this Book, and Wiki">All</label></td></tr><tr><td><input id="pLXR" name="__symboloc" type="radio" /><label for="pLXR" title="Search the symbol in the source code using LINUX Cross-Reference browser">LXR</label></td><td class="internal-only"><input id="iLXR" name="__symboloc" type="radio" /><label for="iLXR" title="Search the symbol in the source code using LINUX Cross-Reference browser">LXR</label></td></tr><tr><td><input id="pLib" name="__symboloc" type="radio" /><label for="pLib" title="Locate the Toolkit library(es) where the symbol is defined">Library</label></td><td class="internal-only"><input id="iLib" name="__symboloc" type="radio" /><label for="iLib" title="Locate the Toolkit library(es) where the symbol is defined">Library</label></td></tr></tbody></table></form></div></div><div class="portlet"><div class="portlet_head"><div class="portlet_title"><h3>Source Browsers</h3></div></div><div class="portlet_content"><ul><li class="internal-only"><span class="bkp_prtlt_txt"> LXR: </span><a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/ident" ref="pagearea=source-application&amp;targetsite=external&amp;targetcat=link&amp;targettype=uri">public</a><span class="bkp_prtlt_txt"> / </span><a href="http://intranet.ncbi.nlm.nih.gov/ieb/ToolBox/CPP_DOC/lxr/ident" ref="pagearea=source-application&amp;targetsite=external&amp;targetcat=link&amp;targettype=uri">in-house</a></li><li class="internal-only"><span class="bkp_prtlt_txt"> Doxygen: </span><a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/doxyhtml" ref="pagearea=source-application&amp;targetsite=external&amp;targetcat=link&amp;targettype=uri">public</a><span class="bkp_prtlt_txt"> / </span><a href="http://intranet.ncbi.nlm.nih.gov/ieb/ToolBox/CPP_DOC/doxyhtml" ref="pagearea=source-application&amp;targetsite=external&amp;targetcat=link&amp;targettype=uri">in-house</a></li></ul></div></div><div class="portlet"><div class="portlet_head"><div class="portlet_title"><h3>SVN Source Repository</h3></div></div><div class="portlet_content"><ul><li class="internal-only"><span class="bkp_prtlt_txt"> Documentation: </span><a href="/books/NBK7170/#ch_getcode_svn.code_retrieval">in-house</a><span class="bkp_prtlt_txt"> / </span><a href="/books/NBK7170/#ch_getcode_svn.external">public</a></li><li class="internal-only"><span class="bkp_prtlt_txt"> Web (dev): </span><a href="https://svn.ncbi.nlm.nih.gov/viewvc/toolkit/trunk/c++" ref="pagearea=source-application&amp;targetsite=external&amp;targetcat=link&amp;targettype=uri">in-house</a><span class="bkp_prtlt_txt"> / </span><a href="http://www.ncbi.nlm.nih.gov/viewvc/v1/trunk/c++/" ref="pagearea=source-application&amp;targetsite=external&amp;targetcat=link&amp;targettype=uri">public</a></li><li class="internal-only"><span class="bkp_prtlt_txt"> Web (extra): </span><a href="https://svn.ncbi.nlm.nih.gov/viewvc/toolkit/trunk/internal/c++" ref="pagearea=source-application&amp;targetsite=external&amp;targetcat=link&amp;targettype=uri">in-house</a></li><li class="internal-only"><span class="bkp_prtlt_txt"> Web (prod): </span><a href="https://svn.ncbi.nlm.nih.gov/viewvc/toolkit/production/components" ref="pagearea=source-application&amp;targetsite=external&amp;targetcat=link&amp;targettype=uri">in-house</a></li></ul></div></div><div class="portlet"><div class="portlet_head"><div class="portlet_title"><h3>Resources</h3></div></div><div class="portlet_content"><ul><li class="internal-only"><a href="http://intranet.ncbi.nlm.nih.gov/ieb/ToolBox/CPP_DOC/lib_search/libsearch.cgi" ref="pagearea=source-application&amp;targetsite=external&amp;targetcat=link&amp;targettype=uri">Library Search Tool</a></li><li class="internal-only"><a href="http://intranet.ncbi.nlm.nih.gov/ieb/ToolBox/CPP_DOC/depgraphs/dglistdeps.cgi" ref="pagearea=source-application&amp;targetsite=external&amp;targetcat=link&amp;targettype=uri">Library Dependencies Tool</a></li><li class="internal-only"><a href="http://intranet.ncbi.nlm.nih.gov/wiki-private/CxxToolkit" ref="pagearea=source-application&amp;targetsite=external&amp;targetcat=link&amp;targettype=uri">Wiki</a></li><li class="internal-only"><a href="http://jira/browse/CXX" ref="pagearea=source-application&amp;targetsite=external&amp;targetcat=link&amp;targettype=uri">JIRA</a></li><li class="internal-only"><a href="http://intranet/ieb/ToolBox/STAT/test_stat/test_stat_ext.cgi" ref="pagearea=source-application&amp;targetsite=external&amp;targetcat=link&amp;targettype=uri"><span title="View results of testsuite runs on the automatic C++ Toolkit builds">Testsuite</span></a></li><li><a href="/books/NBK7156/">Release Notes</a></li><li><a href="/books/NBK7170/#ch_getcode_svn.ftp_download">Download</a></li><li><a href="/books/NBK7160/pdf/TOC.pdf">PDF of the book</a></li><li><a href="/books/NBK7147/">Coding Style</a></li><li><a href="/books/NBK7177/#ch_faq.mailing_lists">Mailing Lists</a></li><li><a href="mailto:CPP-CORE@NCBI.NLM.NIH.GOV" ref="pagearea=source-application&amp;targetsite=external&amp;targetcat=link&amp;targettype=uri"><span title="Contact C++ Toolkit group">Help and Support</span></a></li></ul></div></div></div><div id="tkb_public" class="col four_col last"><div class="portlet"><div class="portlet_head"><div class="portlet_title"><h3>In this page</h3></div></div><div class="portlet_content"><ul><li><a href="#ch_datamod.datamodel.data_model">Data Model</a></li><li><a href="#ch_datamod.datamodel.general">General Use Objects</a></li><li><a href="#ch_datamod.datamodel.biblio">Bibliographic References</a></li><li><a href="#ch_datamod.datamodel.medline">MEDLINE Data</a></li><li><a href="#ch_datamod._Biological_Sequences_1">Biological Sequences</a></li><li><a href="#ch_datamod.datamodel.seqset">Collections of Sequences</a></li><li><a href="#ch_datamod.datamodel.seqloc">Sequence Locations and Identifiers</a></li><li><a href="#ch_datamod.datamodel.seqfeat">Sequence Features</a></li><li><a href="#ch_datamod._Sequence_Alignments_1">Sequence Alignments</a></li><li><a href="#ch_datamod.datamodel.seqres">Sequence Graphs</a></li><li><a href="#ch_datamod.Common_ASN1_Specifications">Common ASN.1 Specifications</a></li></ul></div></div><div class="portlet"><div class="portlet_head"><div class="portlet_title"><h3>Download</h3></div></div><div class="portlet_content"><ul><li><a href="pdf/ch_datamod.pdf">PDF version of this page</a></li></ul></div></div><div class="portlet"><div class="portlet_head"><div class="portlet_title"><h3>Search</h3></div></div><div class="portlet_content"><form name="frmSymbolSearch" onsubmit="return SymbolSearch('toolkit')" action="/" id="frmSymbolSearch"><table><tbody><tr align="center" valign="middle"><td colspan="2" nowrap="nowrap"><input id="search_box" name="__symbol" style="vertical-align:                                        middle; line-height:normal " onkeypress="SymbolSearchKeyPress('toolkit',event)" type="text" />Â Â 					<label for="search_box" class="offscreen_noflow">Search term</label><button type="submit" value="Search" style="vertical-align:                                        middle; line-height:normal;" onclick="javasrcipt:SymbolSearch('toolkit');">Search</button></td></tr><tr><td colspan="2"><input id="pToolkitAll" name="__symboloc" type="radio" checked="checked" /><label for="pToolkitAll" title="Search in the C/C++ source code and in this Book">All</label></td></tr><tr><td colspan="2"><input id="pLXR" name="__symboloc" type="radio" /><label for="pLXR" title="Search the symbol in the source code using LINUX Cross-Reference browser">LXR</label></td></tr><tr><td colspan="2"><input id="pLib" name="__symboloc" type="radio" /><label for="pLib" title="Locate the Toolkit library(es) where the symbol is defined">Library</label></td></tr></tbody></table></form></div></div><div class="portlet"><div class="portlet_head"><div class="portlet_title"><h3>Source Browsers</h3></div></div><div class="portlet_content"><ul><li class="external-only"><a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/ident">LXR</a></li><li class="external-only"><a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lxr/ident">Doxygen</a></li></ul></div></div><div class="portlet"><div class="portlet_head"><div class="portlet_title"><h3>SVN Source Repository</h3></div></div><div class="portlet_content"><ul><li class="external-only"><a href="/books/NBK7170/#ch_getcode_svn.external">Documentation</a></li><li class="external-only"><a href="http://www.ncbi.nlm.nih.gov/viewvc/v1/trunk/c++/" ref="pagearea=source-application&amp;targetsite=external&amp;targetcat=link&amp;targettype=uri">Web (dev)</a></li></ul></div></div><div class="portlet"><div class="portlet_head"><div class="portlet_title"><h3>Resources</h3></div></div><div class="portlet_content"><ul><li class="external-only"><a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/lib_search/libsearch.cgi" ref="pagearea=source-application&amp;targetsite=external&amp;targetcat=link&amp;targettype=uri">Library Search Tool</a></li><li class="external-only"><a href="http://www.ncbi.nlm.nih.gov/IEB/ToolBox/CPP_DOC/depgraphs/dglistdeps.cgi" ref="pagearea=source-application&amp;targetsite=external&amp;targetcat=link&amp;targettype=uri">Library Dependencies Tool</a></li><li><a href="/books/NBK7156/">Release Notes</a></li><li><a href="/books/NBK7170/#ch_getcode_svn.ftp_download">Download</a></li><li><a href="/books/NBK7160/pdf/TOC.pdf">PDF of the book</a></li><li><a href="/books/NBK7147/">Coding Style</a></li><li><a href="/books/NBK7177/#ch_faq.mailing_lists">Mailing Lists</a></li><li><a href="mailto:CPP-CORE@NCBI.NLM.NIH.GOV" ref="pagearea=source-application&amp;targetsite=external&amp;targetcat=link&amp;targettype=uri"><span title="Contact C++ Toolkit group">Help and Support</span></a></li></ul></div></div></div></div></div></div></body></html>
