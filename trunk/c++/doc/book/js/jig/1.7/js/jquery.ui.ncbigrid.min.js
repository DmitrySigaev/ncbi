jQuery.widget("ui.ncbigrid",{options:{isPageable:false,pageSize:5,currentPage:1,isPageToolbarHideable:true,isSortable:false,columnTypes:[],sortRowIndex:0,isPresorted:false,sortColumn:-1,sortColumnDir:1,titleAscending:"sort ascending",titleDescending:"sort descending",isScrollable:false,width:null,height:"10em",usesPercentage:true,hasFilterControl:false,filterIsCaseInsensitive:false,filterColumnIndex:null,filterIsInverse:null,filterAsUserTypes:false,isLoadingMessageShown:false,loadingText:"Loading",
isZebra:true},_init:function(){},_create:function(){this._cleanUpLegacyMarkUp();if(this.options.isPageable){this.options.currentPage-=1;this.createPagingElements();this.addPagingEvents();this.addPagingListeners();this._gotoPage(this._getCurrentPage())}if(this.options.isSortable){this.applySortClasses();this.createHeaderLinks();this.addHeaderEvents();this.sortDefaults()}jQuery(this.element).addClass("ui-ncbigrid");this.options.isScrollable=this.options.isScrollable||jQuery(this.element).hasClass("jig-ncbigrid-scroll")||
this.element.parent().hasClass("jig-ncbigrid-scroll");if(this.options.isScrollable){this._setupScrollMarkup();if(jQuery.browser.mozilla)this._setupScrollFirefox();else if(jQuery.browser.safari)this._setupScrollSafariChrome();else if(jQuery.browser.msie&&parseInt(jQuery.browser.version)>=8||jQuery.browser.opera)this._setupScrollIE8();else jQuery.browser.msie&&parseInt(jQuery.browser.version)<8&&this._setupScrollIE6_7();this._addResetScrollListener();this.options.isPageable&&this.setPagingElementsWidth();
if(!jQuery.browser.mozilla){var a=this;jQuery.ui.jig.registerPageHeightWatcher();jQuery(document.body).bind("ncbijigpageheightchanged",function(){a.forceRedraw()})}}else jQuery(this.element).addClass("ui-ncbigrid-nonscroll");this.options.hasFilterControl&&this._addFilterControl();this._addLoadingBar();this._makeZebraStripped();this._addZebraWatcher();this._addCaptionCurves();this._addRowClickWatcher();this.element.trigger("ncbigridpreready")},destroy:function(){if(this.options.isPageable){this.removePagingEvents();
this.removePagingElements();this.removePagingListeners()}if(this.options.isSortable){this.removeSortClasses();this.removeHeaderEvents();this.removeHeaderLinks()}if(this.options.isScrollable){if(jQuery.browser.mozilla)this._destroyScrollFirefox();else if(jQuery.browser.safari||jQuery.browser.opera)this._destroyScrollSafariChrome();else if(jQuery.browser.msie&&parseInt(jQuery.browser.version)>=8)this._destroyScrollIE8();else jQuery.browser.msie&&parseInt(jQuery.browser.version)<8&&this._destroyScrollIE6_7();
this._removeResetScrollListener();this._destroyScrollMarkup()}this.options.hasFilterControl&&this._destroyFilterControl();jQuery.Widget.prototype.destroy.apply(this,arguments)},_cleanUpLegacyMarkUp:function(){var a=this.element.parent();if(a.hasClass("ui-ncbigrid-inner-div")){a.parent();a.children().clone(true);this.element=a.children().eq(0).unwrap()}a=this.element.parent();if(a.hasClass("jig-ncbigrid-scroll")||this.element.hasClass("jig-ncbigrid-scroll"))this.element.addClass("ui-ncbigrid-scroll");
a.hasClass("jig-ncbigrid")&&this.element.addClass("ui-ncbigrid");if(this.options.isPagable)this.options.isPageable=this.options.isPagable},controlsHTML:'                                         <div class="ui-ncbigrid-paged-toolbar">                                                <div class="ui-ncbigrid-paged-gotoControl">                        Go To Page <input type="text" value="1" size="2"/>                        </div>                                                <div class="ui-ncbigrid-paged-countItems">                        Items <span class="ui-ncbigrid-paged-startRow">1</span> - <span class="ui-ncbigrid-paged-endRow">10</span>                        </div>                                                <div class="ui-ncbigrid-paged-pageControl">                        <button>previous</button>                        Page <span class="ui-ncbigrid-paged-startPage">1</span> of <span class="ui-ncbigrid-paged-endPage">2</span>                        <button>next</button>                        </div>                                            </div>',
createPagingElements:function(){this.controlBar=jQuery(this.controlsHTML).insertAfter(this.element);this._showHidePageToolbar();this._addResizeListener();this.setPagingElementsWidth()},_showHidePageToolbar:function(){if(this.options.isPageToolbarHideable)this.getRowCount()<=this.options.pageSize?this.controlBar.hide():this.controlBar.show()},_addResizeListener:function(){var a=this;jQuery(window).resize(function(){a.setPagingElementsWidth()});if(jQuery.browser.mozilla){jQuery(window).bind("DOMMouseScroll",
function(c){c.ctrlKey&&window.setTimeout(function(){a.setPagingElementsWidth()},5)});jQuery(document).keypress(function(c){if(c.ctrlKey&&(c.which===48||c.which===96))window.setTimeout(function(){a.setPagingElementsWidth()},5)})}var b=function(){window.setTimeout(function(){a.setPagingElementsWidth()},10);window.setTimeout(function(){a.setPagingElementsWidth()},500)};this.element.bind("ncbigridpreready",b).bind("ncbigridupdated",b).bind("ncbigridupdated",function(){a._showHidePageToolbar()})},setPagingElementsWidth:function(){if(this.options.isPageable){if(jQuery.browser.msie&&
parseFloat(jQuery.browser.version)<7)newWidth=this.options.isScrollable?this.element.parent().outerWidth():this.element.outerWidth();else{if(!jQuery.browser.mozilla&&this.element.parent().hasClass("ui-ncbigrid-scroll"))var a=this.element.parent().outerWidth(),b=this.element.parent().width();else{a=this.element.outerWidth();b=this.element.width()}a=a-b;a=this.controlBar.outerWidth()-this.controlBar.width()-a;newWidth=b-a}this.controlBar.width(newWidth)}},removePagingElements:function(){this.controlBar.remove();
this.controlBar=null},addPagingEvents:function(){var a=this,b=this.controlBar.find("div.ui-ncbigrid-paged-pageControl button");b.eq(0).click(function(c){a.gotoPrevPage();c.preventDefault()});b.eq(1).click(function(c){a.gotoNextPage();c.preventDefault()});this.element.parent().find("div.ui-ncbigrid-paged-gotoControl input").keypress(function(c){if(c.keyCode===13){a.gotoPage(this.value);c.preventDefault()}})},removePagingEvents:function(){this.controlBar.find("div.ui-ncbigrid-paged-pageControl button").unbind("click");
this.controlBar.find("div.ui-ncbigrid-paged-gotoControl input").unbind("keypress")},addPagingListeners:function(){var a=this;this.element.bind("ncbigridcolumnsorted",function(){a.gotoPage(1)})},removePagingListeners:function(){this.element.unbind("ncbigridcolumnsorted")},setPage:function(){var a=this._getCurrentPage(),b=this.getMaxPage();this.updateRows(a,b);this._updatePagingMargin();this.updateButtons(a,b);this.updatePagingText(a,b);this.updateGoto(a,b);this.updateItemRange(a,b);this._notifyGridUpdated()},
updateRows:function(a){this.element.trigger("ncbigridresetscroll");var b=this.options.pageSize,c=this.getRowCount();a=a*b;var d=a+b;b="";if(d<c)b+=":lt("+d+")";if(a>0)b+=":gt("+(a-1)+")";a=c=jQuery("tbody tr:not(.ncbigrid-row-filtered)",this.element);if(b.length>0){c.not(".ui-ncbigrid-rowHidden").addClass("ui-ncbigrid-rowHidden");a=c.filter(b)}a.removeClass("ui-ncbigrid-rowHidden");this._notifyGridUpdated()},updateButtons:function(a,b){var c=a===0;a=a===b-1;b=this.controlBar.find("div.ui-ncbigrid-paged-pageControl button");
b.eq(0).attr("disabled",c);b.eq(1).attr("disabled",a)},updatePagingText:function(a,b){var c=this.controlBar.find("div.ui-ncbigrid-paged-pageControl");c.find("span.ui-ncbigrid-paged-startPage").html(a+1);c.find("span.ui-ncbigrid-paged-endPage").html(b)},updateGoto:function(a){this.controlBar.find("div.ui-ncbigrid-paged-gotoControl input").val(a+1)},updateItemRange:function(a){var b=this.options.pageSize,c=this.getRowCount();a=a*b;b=a+b;if(b>c)b=c;c=this.controlBar.find("div.ui-ncbigrid-paged-countItems");
c.find("span.ui-ncbigrid-paged-startRow").html(a+1);c.find("span.ui-ncbigrid-paged-endRow").html(b)},_getCurrentPage:function(){return this.options.currentPage},getCurrentPage:function(){return this._getCurrentPage()+1},getMaxPage:function(){return Math.ceil(this.getRowCount()/this.options.pageSize)},getRowCount:function(){return jQuery(this.element).find("tbody tr:not(.ncbigrid-row-filtered)").length},gotoFirstPage:function(){this._gotoPage(0)},gotoLastPage:function(){this._gotoPage(this.getMaxPage())},
gotoNextPage:function(){this._gotoPage(this._getCurrentPage()+1)},gotoPrevPage:function(){this._gotoPage(this._getCurrentPage()-1)},gotoPage:function(a){this._gotoPage(parseInt(a,10)-1)},_gotoPage:function(a){if(isNaN(a)||a<0)a=0;else if(a>=this.getMaxPage())a=this.getMaxPage()-1;this.options.currentPage=a;this.setPage()},_stndHeightTbody:null,_hasSpacerSet:false,_updatePagingMargin:function(){if(this._stndHeightTbody===null){this._stndHeightTable=this.element.outerHeight();this._stndHeightTbody=
this.element.find("tbody:eq(0)").outerHeight();this._stndScrollHeight=this.element.find("tbody:eq(0)")[0].scrollHeight}if(jQuery.browser.mozilla)this.options.isScrollable?this._updatePagingMarginFirefox_Scroll():this._updatePagingMarginFirefox_NonScroll();else this.options.isScrollable?this._updatePagingMarginIE6_7_Scroll():this._updatePagingMarginIE6_7_NonScroll()},_updatePagingMarginFirefox_Scroll:function(){var a=this.element.find("tbody:eq(0)"),b=a.find("tr.ui-ncbigrid-spacerElement"),c=a.height(),
d=this._stndHeightTbody-c;if(c===a[0].scrollHeight&&this.getMaxPage()==this._getCurrentPage()+1&&this._getCurrentPage()!==0){if(b.length===0){b="<td>&nbsp;</td>";for(c=this.getColumnCount(true);c>1;c--)b+="<td>&nbsp;</td>";b=jQuery("<tr class='ui-ncbigrid-spacerElement'>"+b+"</tr>");a.append(b)}else b.show();b.height(d);a.css("overflow-y","hidden")}else if(b.length===1){a.css("overflow-y","scroll");b.hide().remove()}},_updatePagingMarginFirefox_NonScroll:function(){if(!this.options.isScrollable)if(this._stndHeightTbody){var a=
this.element;a.find("tbody:eq(0)");a.find("tfoot th:eq(0)").outerHeight();a.outerHeight()}},_updatePagingMarginIE6_7_Scroll:function(){var a=this.element.find("tbody:eq(0)"),b=a.find("tr.ui-ncbigrid-spacerElement"),c=a.height(),d=this.element.parent().outerHeight();this.element.parent();var e=this.element.find("thead:eq(0)").outerHeight()||0,f=this.element.find("thead:eq(0)").outerHeight()||0,j=this.element.find("caption:eq(0)").outerHeight()||0;c=d-c-e-f-j-8;if(c>0&&this.getMaxPage()==this._getCurrentPage()+
1&&this._getCurrentPage()!==0){if(b.length===0){b="<td>&nbsp;</td>";for(d=this.getColumnCount(true);d>1;d--)b+="<td>&nbsp;</td>";b=jQuery("<tr class='ui-ncbigrid-spacerElement'>"+b+"</tr>");a.append(b)}else b.show();b.height(c);a.css("overflow-y","hidden")}else if(b.length===1){a.css("overflow-y","scroll");b.hide().remove()}},_updatePagingMarginIE6_7_NonScroll:function(){if(!this.options.isScrollable){var a=this._stndHeightTbody;if(a){var b=this.element,c=b.find("tbody:eq(0)"),d=c.outerHeight(),e=
b.find("thead:eq(0)").outerHeight()||0,f=b.find("caption:eq(0)").outerHeight()||0,j=0;if(parseFloat(jQuery.browser.version)<7)j=c.find("tr:has(td:visible)").height()||0;a=a-d-e-f-3+j;c=this._hasSpacerSet;if(a>0&&!c&&this.getMaxPage()==this._getCurrentPage()+1&&this._getCurrentPage()!==0){b.css("margin-bottom",a);this._hasSpacerSet=true}else if(c){b.css("margin-bottom",0);this._hasSpacerSet=false}else this._stndHeightTbody=d}}},applySortClasses:function(){var a=this.options.columnTypes;if(a.length===
0)jQuery("th",this.element).addClass("sortNone");else{var b=function(c){a[c]!=="none"&&jQuery(this).addClass("sortNone")};jQuery("thead th",this.element).each(b);jQuery("tfoot th",this.element).each(b)}},removeSortClasses:function(){jQuery("th",this.table).removeClass("sortNone sortAsc sortDsc")},createHeaderLinks:function(){var a=this.options.titleAscending,b=this.options.columnTypes,c=b.length>0,d=function(e){if(!c||b[e]!=="none"){var f=jQuery(this);f.data("colIndex",e);e=f.html()||f.text();f.html("<a href='#'>"+
e+"</a>").find("a").attr("title",a)}};jQuery(this.element).find("thead tr").eq(this.options.sortRowIndex).find("th").each(d);jQuery(this.element).find("tfoot tr").eq(this.options.sortRowIndex).find("th").each(d)},removeHeaderLinks:function(){jQuery("th").each(function(){var a=jQuery(this);a.removeData("colIndex");var b=a.find("a");b=b.html()||b.text();a.html(b)})},addHeaderEvents:function(){var a=this;jQuery("th a",this.element).mousedown(function(){a._sort(jQuery(this).parent().data("colIndex"));
return false}).click(function(){return false})},removeHeaderEvents:function(){jQuery("th a",this.element).die("click")},sort:function(a,b){a--;this._sort(a,b)},_sort:function(a,b){this.element.trigger("ncbigridshowloadingbar");this._killActiveSort();this.isPageable||this.element.trigger("ncbigridresetscroll");var c=this.element.find("tbody tr.ui-ncbigrid-spacerElement");c.lenght===1&&c.remove();if(typeof a==="object")a=a.data("colIndex");else{jQuery("thead th").eq(a);a=a}this._setColumnDirection(a,
b);this._sortData()},_killActiveSort:function(){this._killSort=true;this._sortTimer&&window.clearTimeout(this._sortTimer);this._sortTimer=null},_setColumnDirection:function(a,b){var c=typeof b!=="undefined"&&b!==null;b=c?b:1;var d=this.options.sortColumn;if(d===a)c||(b=this.options.sortColumnDir*-1);else if(d!==-1){c=jQuery(this.element).find("thead:not(.cloned):not([cloned]) tr").eq(this.options.sortRowIndex).find("th").eq(d);var e=jQuery(this.element).find("tfoot tr").eq(this.options.sortRowIndex).find("th").eq(d);
c.add(e).addClass("sortNone").removeClass("sortAsc sortDsc").find("a").attr("title",this.options.titleAscending);jQuery(this.element).find("tbody tr:not(.ui-ncbigrid-spacerElement) td:nth-child("+(d+1)+")").removeClass("sorted")}this.options.sortColumn=a;this.options.sortColumnDir=b;d=b===1?"sortAsc":"sortDsc";b=b===1?this.options.titleDescending:this.options.titleAscending;c=jQuery(this.element).find("thead:not(.cloned):not([cloned]) tr").eq(this.options.sortRowIndex).find("th").eq(a);e=jQuery(this.element).find("tfoot tr").eq(this.options.sortRowIndex).find("th").eq(a);
c.add(e).removeClass("sortAsc sortDsc sortNone").addClass(d).find("a").attr("title",b);jQuery(this.element).find("tbody tr:not(.ui-ncbigrid-spacerElement) td:nth-child("+(a+1)+")").addClass("sorted")},_killSort:true,_sortData:function(){this._killSort=false;var a=jQuery("tbody",this.element),b=this.options.sortColumn,c=this.options.sortColumnDir,d=this.getColumnType(b+1),e=this,f=[];jQuery("tr",a).each(function(){var g=jQuery(this),i=e._columnTypeConversion(g.find("td").eq(b),d);f.push({data:i,row:g.clone()})});
f=typeof d==="function"?f.sort(function(g,i){return d.call(e,g,i,c)}):f.sort(function(g,i){return e._defaultSortFnc(g,i,c)});var j=a.clone().children().remove().end(),h=function(){for(var g=0;f.length>0&&g<10;){if(e._killSort)break;var i=f.shift();j.append(i.row);g++}if(e._killSort)e._killSort=false;else if(f.length>0)e._sortTimer=window.setTimeout(function(){h()},0);else{a.after(j);a.remove();e.element.trigger("ncbigridcolumnsorted",[e.options.sortColumn+1,e.options.sortColumnDir]).trigger("ncbigridhideloadingbar");
e.options.isPageable||e._notifyGridUpdated()}};h()},_defaultSortFnc:function(a,b,c){return a.data>b.data?c:a.data<b.data?-c:0},_columnTypeConversion:function(a,b,c){var d="";d=c?a.html():a.text();d=jQuery.trim(d);switch(b){case "int":aCell=parseInt(d,10);break;case "float":case "num":aCell=parseFloat(d);break;case "date":aCell=new Date(d);break;case "str-sensitive":aCell=d;break;case "str-insensitive":aCell=d.toLowserCase();break;default:aCell=d.toLowerCase();break}return aCell},getColumnType:function(a){return this.options.columnTypes[a]||
"str"},sortDefaults:function(){if(this.options.sortColumn!==-1){var a=this;this.element.bind("ncbigridpreready",function(){a.sort(a.options.sortColumn,a.options.sortColumnDir)})}},_setupScrollMarkup:function(){var a=jQuery(this.element);if(a.parent().hasClass("jig-ncbigrid-scroll"))a.parent().addClass("ui-ncbigrid-scroll");else{a.wrap("<div class='ui-ncbigrid-scroll'></div>");a.data("addedWrapper",true)}var b=a.attr("cellpadding")||"",c=a.attr("cellspacing")||"";if(b.length===0||c.length===0){a.data("addedCellPadding",
true);a.attr("cellpadding","0")}if(c.length===0){a.data("addedCellSpacing",true);a.attr("cellspacing","0")}if(!this.options.usesPercentage||jQuery.browser.msie)if(b=this.options.width||typeof a[0].currentStyle!=="undefined"?a[0].currentStyle.width:jQuery(parseFloat(a[0].style.width||a.css("width"),10)).toEm()){a.css("width","100%").data("ncbigrid_orgWidth",b);a.parent().css("width",b)}if(this.options.scrollHeight)this.options.height=this.options.scrollHeight;b=this.options.height;if(jQuery.browser.mozilla){b=
jQuery("tbody",a);c=jQuery("caption",a).height()||0;var d=jQuery("thead",a).height()||0;a=jQuery("tfoot",a).height()||0;c=c+d+a;a=parseFloat(this.options.height);if(this.options.height&&this.options.height.toString().indexOf("em")>0){c=parseFloat(jQuery(c).toEm());a=a-c+"em"}else a=a+"px";b.css("max-height",a);b.css("height",a)}else{a.css("height","auto");a.parent().css("height",b)}},_setupScrollFirefox:function(){var a=jQuery(this.element);a.parent().addClass("firefox");jQuery("thead tr th:last-child",
a).css("border-right","0px")},_setupScrollSafariChrome:function(){function a(){var n=jQuery(c).find("thead");if(n.length==2&&n.eq(0).position().top!==n.eq(1).position().top)t();else if(n.eq(0).position().top==0&&u<10){window.setTimeout(a,10);u++}}function b(){c.find("tbody td").length===0?window.setTimeout(b,5):t()}var c=jQuery(this.element),d=c.parent();d.addClass("sa_ch");var e=jQuery("thead",c),f=jQuery("th",e),j=jQuery("caption",c);e=jQuery("thead",c);f=jQuery("th",e);var h=jQuery("tfoot",c),
g=jQuery("th",h),i=jQuery("tbody",c);jQuery("td",i);var k=e.clone().prependTo(c).attr("cloned","true"),l=h.clone().appendTo(c).attr("cloned","true");j.position();e.position();e.height();var o=e.height();jQuery("col",c);d.position();d.height();var m=e.position();m=m&&m.left?m.left:0;e.css("position","absolute").css("top",k.position().top+0+"px").css("left",m+"px").height(0);var q=false;if(h.length>0){h.css("position","absolute").css("top",d.height()-1+"px").css("left",m+"px").height(o);q=true}jQuery("tr:eq(0) td",
i);var v=jQuery("th",k),y=v.length;i=k.find("th");parseInt(i.eq(0).css("padding-top"),10);var r=null,t=function(){f.each(function(s){var w=s+1===y?0:1;w=v.eq(s).width()+w;jQuery(this).width(w);q&&g.eq(s).width(w)});var n=d.width()-c.outerWidth();if(n!==16&&n!==15){d.css("min-width",c.outerWidth()+16);k.css("min-width",c.outerWidth()+16);q&&l.css("min-width",c.outerWidth()+16)}n=d.position().top;var x=k.position().left;if(q){var p=n+d.height()-v.eq(0).outerHeight()+1;h.css("top",p+"px")}e.css("position",
"absolute").css("top",n+j.height()+"px").css("left",x+"px");r&&jQuery("tbody tr td.lastRowGrid",c).removeClass("lastRowGrid").css("border-bottom-color",r);n=jQuery("tbody tr:has(td:visible):last-child td",c);r=n.css("border-bottom-color");n.css("border-bottom-color",n.css("background-color")).addClass("lastRowGrid")};this.forceRedraw=this._resizeListener=function(){t()};this.renderingWatcher();jQuery(window).resize(this._resizeListener);jQuery(this.element).bind("ncbigridupdated",this._resizeListener);
var u=0;jQuery(window).load(a);b()},forceRedraw:function(){},renderingWatcher:function(){var a=false,b=this,c=false,d=jQuery.browser.safari,e=function(){function f(){if(h<j.height()){h=j.height();b.forceRedraw()}if(g<100)a=window.setTimeout(f,100);if(d)if(g===1){var i=b.element.find("thead");if(i.length==2)if(i.eq(0).find("tr").width()!==i.eq(1).find("tr").width()){i.hide();c=true}}else{if(g===2&&c){b.element.find("thead").show();b.forceRedraw();c=false}}else if(g===13){b.element.hide();window.setTimeout(function(){b.element.show()},
2);g=100}g++}a&&window.clearTimeout(a);var j=jQuery(document.body),h=j.height(),g=0;f()};jQuery(window).resize(e);e()},_setupScrollIE8:function(){function a(e){var f=jQuery(b.element),j=jQuery("caption:visible",f).not(c),h=f.parent(),g=jQuery("thead.orginal",f);g.css("display","none");if(g.length!==0){var i=jQuery("tfoot",f),k=jQuery("tbody",f),l=k.find("tr:not(.ui-ncbigrid-rowHidden):has(td:visible):eq(0) td"),o=k.find("tr:not(.ui-ncbigrid-rowHidden):has(td:visible):last td"),m=jQuery("th",g),q=
jQuery("th",i);b.ie8Reset=function(){var p=jQuery(this.element).find("tbody");p.find("td[addedTopPadding=true]").attr("addedTopPadding","false").eq(0).attr("orgPaddingTop");p=p.find("td[addedBotPadding=true]").attr("addedBotPadding","false");var s=p.eq(0).attr("orgPaddingBot");p.css("padding-bottom",s)};e&&b.ie8Reset();var v=g.outerHeight();m.eq(0).attr("orgHeight",m.eq(0).height());q.eq(0).attr("orgHeight",q.eq(0).height());e=b.element.find("thead.clone");var y=e.find("th"),r=e.position(),t=b.element.find("tbody").position();
b.element.position();e=r&&r.left?r.left:0;var u=r&&r.top?r.top:0;if(r.top>t.top){e=t.left;u=t.top-m.eq(0).height()-1}if(r.top===0){g.css("display","none");var n=function(){if(b.element.position().top===0)b.genFix=window.setTimeout(n,1);else a()};n()}m=0;if(u>0){m=b.options.isSortable?0:1;g.css("position","absolute").css("left",e+"px").css("top",u-m+"px")}g.find("th").each(function(p){var s=0;if(p===0)s=b.element.width%2===0?1:0.5;p=y.eq(p);jQuery(this).width(p.outerWidth()-0.6+s-parseFloat(p.css("padding-left"))).height(p.height()+
4)});m=b.options.isPageable?2:3;i.outerHeight();i.css("position","absolute").css("left",e-1+"px").css("top",u+h.outerHeight()-g.outerHeight()-i.outerHeight()+m);var x=function(){return 0};x=function(p,s){return l.eq(s).outerWidth()-1};q.each(function(p){jQuery(this).width(x(this,p)).height(v)});q=(q=o.eq(0).css("padding-bottom"))||0;o.eq(0).attr("orgPaddingBot",q);q=parseInt(q)-1;if(i.length>0&&h.height()<k.height()+i.height()){i=i.height()+parseInt(q,10)+"px";o.css("padding-bottom",i).attr("addedBotPadding",
"true")}if(c.length>0){c.css("top",h.position().top+"px").css("left",h.position().left+"px").attr("cloned","true");(j=j.width())&&c.width(j)}g.css("display","block");f.trigger("ncbigridieresize")}}var b=this,c=jQuery("caption:visible",this.element).clone().prependTo(this.element).css("position","absolute");jQuery(this.element).parent().addClass("ie8");a();var d=this.element.find("thead");d.clone().addClass("clone").appendTo(this.element);d.addClass("orginal").hide();this.resetScroll=a;this._resizeListener=
function(){a(true)};jQuery(window).resize(function(){b._resizeListener();window.setTimeout(b._resizeListener,20)});jQuery(this.element).bind("ncbigridcolumnsorted",this._resizeListener).bind("ncbigridupdated",this._resizeListener).bind("ncbigridpreready",this._resizeListener);this.forceRedraw=this._resizeListener;this.renderingWatcher()},_setupScrollIE6_7:function(){function a(){c[0].style.width="100%";c.width(c.outerWidth()-6);var l=h.find("th"),o=j.find("th");o.each(function(){jQuery(this).css("width",
"auto")});o.each(function(m){jQuery(this).width(l.eq(m).width())});i.element.trigger("ncbigridieresize")}function b(l){if(d[0].scrollTop>0){i.element.find("thead").hide();window.setTimeout(function(){i.element.find("thead").show()},2);l&&window.setTimeout(b,130)}}var c=jQuery(this.element),d=c.parent();d.addClass("ie6_7");parseFloat(jQuery.browser.version)<7&&document.all[0].text.indexOf("<?xml")!==-1&&d.addClass("ie6_docIgnored");var e=jQuery("caption",c),f=e.html();e.css("height",e.outerHeight());
e.html("<div class='ui-ncbigrid-scroll-caption'>"+f+"</div>");var j=c.find("thead"),h=j.clone(true).addClass("orginal").appendTo(c);j.addClass("cloned");var g=j.find("th");h.find("th").each(function(l){l=g.eq(l).data("colIndex");l!==null&&jQuery(this).data("colIndex",l)});if(jQuery.browser.version>=7){c.width(c.width()-14);f=jQuery("thead.orginal tr th:last-child, tfoot tr th:last-child");f.css("border-right-color",f.css("background-color"));e.length===0&&j.children().height(f.height()+1).css("top",
"-1px")}else{e=jQuery("thead.orginal tr th:first-child",c);e.css("padding-left",(parseInt(e.css("padding-left"),10)||0)+1+"px")}var i=this,k=function(l){window._scrollredrawIssueHeight=l;i.element.hide();i.element.show()};this.element.bind("ncbigridfilterapplied",function(){k(-1)}).bind("ncbigridfilterremoved",function(){k(0)});this.forceRedraw=function(){k(0);setTimeout(b,100)};if(this.options.usesPercentage){jQuery(window).resize(a);this.renderingWatcher()}i.element.bind("ncbigridcolumnsorted",
b);i.renderingWatcher();parseFloat(jQuery.browser.version)==7&&a()},_destroyScrollMarkup:function(){var a=jQuery(this.element);if(a.data("addedWrapper")){var b=a.data("ncbigrid_orgWidth");b&&a.css("width",b);a.unwrap()}a.data("addedCellPadding")&&a.removeAttr("cellpadding");a.data("addedCellSpacing")&&a.removeAttr("cellspacing");this.element.removeData("addedWrapper").removeData("ncbigrid_orgWidth").removeData("addedCellPadding").removeData("addedCellSpacing")},_destroyScrollFirefox:function(){var a=
jQuery(this.element);a.parent().addClass("firefox");jQuery("thead tr th:last-child",a).css("border-right","1px")},_destroyScrollSafariChrome:function(){var a=jQuery(this.element);a.parent().addClass("sa_ch");jQuery("caption",a).css("position","").css("top","").width("").height("");jQuery("thead",a).not("[cloned=true]").remove().end().removeAttr("cloned");jQuery("tfoot",a).not("[cloned=true]").remove().end().removeAttr("cloned");if(this._resizeListener){jQuery(window).unbind("resize",this._resizeListener);
this._resizeListener=null}},_destroyScrollIE8:function(){jQuery(this.element).parent().addClass("ie8");jQuery("caption[cloned=true]").remove();if(this._resizeListener){jQuery(window).unbind("resize",this._resizeListener);this._resizeListener=null}this.ie8Reset()},_destroyScrollIE6_7:function(){jQuery(this.element).parent().removeClass("ie6_7")},_addResetScrollListener:function(){var a=this;this.element.bind("ncbigridresetscroll",function(){a.resetScrollPosition()})},_removeResetScrollListener:function(){this.element.unbind("ncbigridresetscroll")},
resetScrollPosition:function(){(jQuery.browser.mozilla?jQuery(this.element).find("tbody")[0]:jQuery(this.element).parent()[0]).scrollTop=0},_filterControlMarkUp:'<div class="filter"><label for="filter-list">Filter:</label><input id="filter-list" type="text" /><button>Search</button></div>',_addFilterControl:function(){var a=this.element.parent(),b=this.element;if(a.length>0&&(a.hasClass("ui-ncbigrid-scroll")||a.hasClass("ui-ncbigrid")))b=a;this._filterControl=jQuery(this._filterControlMarkUp).insertBefore(b);
var c=this;this._filterControl.find("button").click(function(){c._runFilter()});this.options.filterAsUserTypes?this._filterControl.find("input").keyup(function(){c._runFilter()}):this._filterControl.find("input").keyup(function(d){d.keyCode===13&&c._runFilter()})},_destroyFilterControl:function(){this._filterControl&&this._filterControl.find("button").unbind("click").end().find("input").unbind("keyup").end().remove()},_runFilter:function(){var a=this._filterControl.find("input").val(),b=this.options.filterIsCaseInsensitive||
null,c=this.options.filterColumnIndex||null,d=this.options.filterIsInverse||null;this.removeFilterRows();a.length>0&&this.filterRows(a,b,c,d)},_addCaptionCurves:function(){jQuery(this.element).find("caption").addClass("ui-corner-top");jQuery.browser.safari&&this.element.find("caption").css("margin-right","-1px")},_makeZebraStripped:function(){if(this.options.isZebra){var a=jQuery(this.element).find("tbody tr:has(td:visible):not(.ui-ncbigrid-spacerElement)");a.filter(":even").addClass("ui-ncbigrid-row-even").removeClass("ui-ncbigrid-row-odd");
a.filter(":odd").addClass("ui-ncbigrid-row-odd").removeClass("ui-ncbigrid-row-even")}},_addZebraWatcher:function(){var a=this;this.element.bind("ncbigridupdated",function(){a._makeZebraStripped()})},_removeZebraWatcher:function(){},_addRowClickWatcher:function(){var a=this;jQuery(this.element).find("tbody").click(function(b){b=jQuery(b.originalTarget).closest("td");var c=b.closest("tr");a.element.trigger("ncbigridrowclick",[{row:c,cell:b}])})},_removeRowClickWatcher:function(){},_notifyGridUpdated:function(){this.element.trigger("ncbigridupdated")},
_deleteRowHelper:function(a){a=a||"";jQuery("tbody tr"+a,this.element).remove()},_getCellDataHelper:function(a,b){if(a<=0||a>this.getRowCount()||b<0||b>this.getColumnCount())return null;if(a=jQuery("tbody tr:nth-child("+a+") td:nth-child("+b+")",this.element)){b=this._getColumnType(b-1);if(b==="str"||!b)b="str-sensitive";return this._csColumnTypeConversion(a[0],b,true)}},_getColumnType:function(a){var b=this.options.columnTypes,c=b.length;if(!(a>=c&&c.length!==0))if(c===0)return"str";else{a=b[a];
if(typeof a==="string"&&a.indexOf("fnc:")===0){b=a.substr(4,a.length).split(".");a=window[b[0]];for(c=1;c<b.length;c++)a=a[b[c]]}return a}},_csColumnTypeConversion:function(a,b,c){var d="";d=c?a.innerHTML:jQuery(a).text();d=jQuery.trim(d);switch(b){case "int":aCell=parseInt(d,10);break;case "float":case "num":aCell=parseFloat(d);break;case "date":aCell=new Date(d);break;case "str-sensitive":aCell=d;break;case "str-insensitive":aCell=d.toLowserCase();break;default:aCell=d.toLowerCase();break}return aCell},
_getColumnDataHelper:function(a){var b=[],c=this,d=this._getColumnType(a-1);if(d==="str"||!d)d="str-sensitive";jQuery("tbody tr td:nth-child("+a+")",this.element).each(function(e,f){b.push(c._csColumnTypeConversion(f,d,true))});if(b.length!==0)return b},_getRowDataHelper:function(a){var b=[],c=this;jQuery("tbody tr:nth-child("+a+") td",this.element).each(function(d,e){d=c._getColumnType(d);if(d==="str"||!d)d="str-sensitive";b.push(c._csColumnTypeConversion(e,d,true))});if(b.length!==0)return b},addHTMLRowData:function(a,
b,c){var d=this.getRowCount(),e="";if(typeof b=="undefined")e=":last-child";else{if(b>d)b=d;else if(b<0){b=1;c="before"}e=":nth-child("+b+")"}d===0&&jQuery("tbody"+e,this.element).append(a);c&&c.toLowerCase()==="before"?jQuery("tbody tr"+e,this.element).before(a):jQuery("tbody tr"+e,this.element).after(a);this.options.isPageable?this._gotoPage(this.options.currentPage):this._notifyGridUpdated()},deleteAllRows:function(){this._deleteRowHelper();this.options.isPageable&&this._gotoPage(0)},deleteRow:function(a){if(typeof a!=
"undefined"){a=jQuery.isArray(a)?a.sort():[a];for(var b=a.length-1;b>=0;b--)this._deleteRowHelper(":nth-child("+a[b]+")");this.options.isPageable&&this._gotoPage(this.options.currentPage)}},_custFilterCnt:0,filterRows:function(a,b,c,d){if(!(typeof a=="undefined"||a.length===0)){this.element.trigger("ncbigridshowloadingbar");if(!jQuery.isArray(a)){orgTxt=a;a=[[a,b,c,d]]}d=f=jQuery("tbody tr:not(.ncbigrid-row-filtered)",this.element);for(var e,f,j=0;j<a.length;j++){var h=a[j],g=h[0],i=h[2],k=h[3];h=
"";if(typeof i!="undefined"&&i!==null)h=":nth-child("+i+")";k=k?"not-":"";var l="",o=null;if(typeof g==="function"){l="-fnctionTest";o=this._custFilterCnt;this._custFilterCnt=o+1;o="filter_temp_"+o;jQuery.ui.jig[o]=g;g="jQuery.ui.jig."+o}else if(g.constructor&&g.constructor.toString().indexOf("RegExp")>0)l="-regexp";else if(b)l="-insensitive";f=i!==null?f.find("td"+h+":"+k+"contains"+l+"("+g+")").parent():f.filter(":"+k+"contains"+l+"("+g+")");if(o)jQuery.ui.jig[o]=null}if(d)e=d.not(f).each(function(m,
q){jQuery(q).addClass("ncbigrid-row-filtered").attr("isfiltered","true")});this.options.isPageable&&this._gotoPage(0);this.element.trigger("ncbigridfilterapplied",[a,b,c,e,f]).trigger("ncbigridhideloadingbar");this.options.isPageable?this._gotoPage(this.options.currentPage):this._notifyGridUpdated();return{filteredRows:e,remainingRows:f}}},getCellData:function(a,b){if(!(typeof a=="undefined"||typeof b=="undefined"))return this._getCellDataHelper(a,b)},getColumnCount:function(a){a=a===false?":visible":
"";a=jQuery(this.element).find("tbody tr:not(.ui-ncbigrid-rowHidden):eq(0) td"+a).length;if(a===0)a=jQuery(this.element).find("thead tr:last th").length;return a},getColumnData:function(a){if(typeof a==="undefined")return null;else if(jQuery.isArray(a)){for(var b=[],c=0;c<a.length;c++){if(a[c]<=0||a[c]>this.getColumnCount())b.push(null);b.push(this._getColumnDataHelper(a[c]))}return b}else{if(a<=0||a>this.getColumnCount())return null;return this._getColumnDataHelper(a)}},getColumnType:function(a){return this._getColumnType(a-
1)},getRowData:function(a){if(typeof a!=="undefined")if(jQuery.isArray(a)){for(var b=[],c=0;c<a.length;c++)b.push(this._getRowDataHelper(a[c]));return b}else return this._getRowDataHelper(a)},highlightRows:function(a,b,c,d){var e=jQuery.browser.msie&&parseFloat(jQuery.browser.version)<7;if(!(typeof a=="undefined"||a.length===0)){this.element.trigger("ncbigridshowloadingbar");var f=[],j=b?"-insensitive":"";d=d?"not-":"";if(a.constructor&&a.constructor.toString().indexOf("RegExp")>0){j="-regexp";d=
""}typeof c!="undefined"?jQuery("tbody tr td"+(":nth-child("+c+")")+":"+d+"contains"+j+"("+a+")",this.element).each(function(h,g){h=jQuery(g).parent();g="ui-ncbigrid-high";if(e)g=h.hasClass("ui-ncbigrid-row-even")?"ui-ncbigrid-row-even-high-IE6":"ui-ncbigrid-row-odd-high-IE6";h.addClass(g);jQuery.inArray(h,f)===-1&&f.push(h)}):jQuery("tbody tr:"+d+"contains"+j+"("+a+")",this.element).each(function(h,g){h=jQuery(g);g="ui-ncbigrid-high";if(e)g=h.hasClass("ui-ncbigrid-row-even")?"ui-ncbigrid-row-even-high-IE6":
"ui-ncbigrid-row-odd-high-IE6";h.addClass(g);f.push(h)});this.element.trigger("ncbigridhighlightapplied",[a,b,c,f]).trigger("ncbigridhideloadingbar");return{highlightedRows:f}}},removeFilterRows:function(a,b,c,d,e){if(typeof a!="undefined"&&a.length>0){if(typeof d==="undefined")d=true;var f="",j="";if(d||e){f=":not(";j=")"}var h=d="",g=null;if(typeof a==="function"){d="-fnctionTest";h=this._custFilterCnt;this._custFilterCnt=h+1;g="filter_temp_"+h;h=jQuery.ui.jig[g]=a;a="jQuery.ui.jig."+g}else if(a.constructor&&
a.constructor.toString().indexOf("RegExp")>0)d="-regexp";else if(b)d="-insensitive";e=e?"not-":"";if(typeof c!="undefined"&&c!==null){f="tbody tr[isfiltered='true'] td:nth-child("+c+")"+f+":"+e+"contains"+d+"("+a+")"+j;jQuery(f,this.element).parents().each(function(i,k){jQuery(k).removeClass("ncbigrid-row-filtered").attr("isfiltered","false")})}else{f="tbody tr[isfiltered='true']"+f+":contains"+d+"("+a+")"+j;jQuery(f,this.element).each(function(i,k){jQuery(k).removeClass("ncbigrid-row-filtered").attr("isfiltered",
"false")})}}else jQuery("tr.ncbigrid-row-filtered",this.element).removeClass("ncbigrid-row-filtered").attr("isfiltered","false");if(g){jQuery.ui.jig[g]=null;a=h}this.options.isPageable&&this._gotoPage(0);this.element.trigger("ncbigridfilterremoved",[a,b,c]);this.options.isPageable?this._gotoPage(this.options.currentPage):this._notifyGridUpdated()},removeHighlightRows:function(a,b,c,d){var e=jQuery.browser.msie&&parseFloat(jQuery.browser.version)<7;if(typeof a!="undefined"&&a.length>0){var f=[],j=
b?"-insensitive":"";d=d?"not-":"";if(a.constructor&&a.constructor.toString().indexOf("RegExp")>0){j="-regexp";d=""}typeof c!="undefined"?jQuery("tbody tr td"+(":nth-child("+c+")")+":"+d+"contains"+j+"("+a+")",this.element).each(function(h,g){h=jQuery(g).parent().removeClass("ui-ncbigrid-high");e&&h.removeClass("ui-ncbigrid-row-odd-high-IE6").removeClass("ui-ncbigrid-row-even-high-IE6");jQuery.inArray(h,f)===-1&&f.push(h)}):jQuery("tbody tr:"+d+"contains"+j+"("+a+")",this.element).each(function(h,
g){h=jQuery(g).removeClass("ui-ncbigrid-high");e&&h.removeClass("ui-ncbigrid-row-odd-high-IE6").removeClass("ui-ncbigrid-row-even-high-IE6");f.push(h)})}else{jQuery(".ui-ncbigrid-high",this.element).removeClass("ui-ncbigrid-high");e&&jQuery(".ui-ncbigrid-row-odd-high-IE6, .ui-ncbigrid-row-even-high-IE6",this.element).removeClass("ui-ncbigrid-row-odd-high-IE6").removeClass("ui-ncbigrid-row-even-high-IE6")}this.element.trigger("ncbigridhighlightremoved",[a,b,c])},setCellData:function(a,b,c){jQuery("tbody tr:nth-child("+
a+") td:nth-child("+b+")",this.element).text(c);this.element.trigger("ncbigridcellchange",[a,b,this.getCellData(a,b)])},setRowData:function(a,b){jQuery("tbody tr:nth-child("+a+") td",this.element).each(function(c,d){jQuery(d).text(b[c])});this.element.trigger("ncbigridrowchange",[a,this.getRowData(a)])},showColumn:function(a){jQuery("tr *:nth-child("+a+")",this.element).removeClass("ui-ncbigrid-column-hidden")},hideColumn:function(a){jQuery("tr *:nth-child("+a+")",this.element).addClass("ui-ncbigrid-column-hidden")},
_loadingBar:null,_loadingElem:null,_addLoadingBar:function(){if(this.options.isLoadingMessageShown){this._loadingBar=jQuery("<div class='ui-ncbigrid-loadingbar ncbipopper-wrapper ui-corner-all'>"+this.options.loadingText+"</div>").appendTo(document.body).css("display","none");this._loadingElem=!jQuery.browser.mozilla&&this.options.isScrollable?this.element.parent():this.element;jQuery(this._loadingElem).ncbipopper({targetPosition:"middle center",sourcePosition:"middle center",sourceSelector:this._loadingBar,
hasArrow:false,openMethod:"custom",closeMethod:"custom",isSourceElementCloseClick:false,isTriggerElementCloseClick:false,isDocumentCloseClick:false,addCloseButton:false,openAnimation:"show",closeAnimation:"hide"});var a=this;this.element.bind("ncbigridshowloadingbar",function(){a._showLoadingBar()}).bind("ncbigridhideloadingbar",function(){a._hideLoadingBar()})}},_showLoadingBar:function(){if(this.options.isLoadingMessageShown){this._loadingBar||this._addLoadingBar();this.loadingCloseTimer&&window.clearTimeout(this.loadingCloseTimer);
this._loadingElem.ncbipopper("open")}},_hideLoadingBar:function(){if(this.options.isLoadingMessageShown){var a=this;this.loadingCloseTimer=window.setTimeout(function(){a._loadingElem.ncbipopper("close")},200)}}});
jQuery.fn.toEm=function(a){a=jQuery.extend({scope:"body"},a);var b=parseInt(this[0],10);a=jQuery('<div style="display: none; font-size: 1em; margin: 0; padding:0; height: auto; line-height: 1; border:0;">&nbsp;</div>').appendTo(a.scope);var c=a.height();a.remove();return(b/c).toFixed(8)+"em"};
jQuery.fn.toPx=function(a){a=jQuery.extend({scope:"body"},a);var b=parseFloat(this[0]);a=jQuery('<div style="display: none; font-size: 1em; margin: 0; padding:0; height: auto; line-height: 1; border:0;">&nbsp;</div>').appendTo(a.scope);var c=a.height();a.remove();return Math.round(b*c)+"px"};jQuery.extend(jQuery.expr[":"],{"contains-insensitive":function(a,b,c){return(a.textContent||a.innerText||"").toLowerCase().indexOf((c[3]||"").toLowerCase())>=0}});
jQuery.extend(jQuery.expr[":"],{"contains-regexp":function(a,b,c){a=jQuery.trim(a.textContent||a.innerText||"");c=c[3];b=c.match(/\/([gi]+)$/);b=b!==null?b[1]:"";c=c.replace(/\/[gi]?$/,"").replace(/^\//,"");return a.match(new RegExp(c,b))!==null}});jQuery.extend(jQuery.expr[":"],{"contains-fnctionTest":function(a,b,c){a=a.textContent||a.innerText||"";return jQuery.ui.jig._getFncFromStr(c[3])(a)}});
jQuery.extend(jQuery.expr[":"],{"not-contains":function(a,b,c){return(a.textContent||a.innerText||"").indexOf(c[3]||"")===-1}});jQuery.extend(jQuery.expr[":"],{"not-contains-insensitive":function(a,b,c){return(a.textContent||a.innerText||"").toLowerCase().indexOf((c[3]||"").toLowerCase())===-1}});
