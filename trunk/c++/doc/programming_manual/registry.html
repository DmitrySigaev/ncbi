<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="GENERATOR" content="Mozilla/4.75 [en] (X11; U; SunOS 5.7 sun4u) [Netscape]">
   <title> UNTITLED </title>
</head>
<body bgcolor="#FFFFFF">

<h1>
The CNcbiRegistry Class</h1>

<ul>
<li>
<a href="#intro">Introduction</a></li>

<li>
<a href="#syntax">Syntax of the configuration file</a></li>

<li>
<i><a href="#eflags">CNcbiRegistry::EFlags</a></i></li>

<li>
<i><a href="#methods">Additional Methods</a></i></li>
</ul>

<h3>
<a NAME="intro"></a>Introduction</h3>
The <i><a href="../docxx/CNcbiRegistry.html">CNcbiRegistry</a></i> class
is used to store, access, and modify runtime information read from a configuration
file. Previously, these files were by convention named "<i>.*r</i>c" files
on unix systems. The convention for all platforms now is to name such files
<i>*.ini</i>, where * is by default the application name.&nbsp; Unless
you explicitly override the default behavior, the <i><a href="applic.html#CNcbiApplication">CNcbiApplication</a></i>
class looks for a configuration file with the default name.&nbsp; You can
override this by call your application's <i><a href="applic.html#appmain">AppMain()
</a></i>method with the full set of arguments:
<center>
<p><tt><font color="#005050">AppMain (argc, argv, envp, diag_stream, config_file,
progname);</font></tt></center>

<p>Here, <i>config_file</i> is a string specifying the name of the file
to be used when loading the registry. If you do not need to use this facility,
you can specify <i>config_file</i> using <i>NcbiEmptyString</i>.&nbsp;
This will eliminate a warning message, positng that no configuration file
was found.
<h1>
<a NAME="syntax"></a></h1>

<h3>
Syntax of the configuration file</h3>
The configuration file is composed of <i>section</i> headers and &lt;<i>name=value</i>>
strings, which occur within the named sections.&nbsp; It is also possible
to include comments in the file,&nbsp; which are indicated by a new line
with a leading semi-colon.&nbsp; Figure 1 shows an example configuration
file.
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote><tt>; MyProgram.ini</tt><tt></tt>
<p><tt>; parameters for section1</tt>
<br><tt><font color="#3366FF">[section1]</font></tt>
<br><tt>name1 = value1 and value1.2</tt>
<br><tt>n-2.3 = "&nbsp; this value has two spaces at its very beginning
and at the end&nbsp; "</tt>
<br><tt>name3 = this is a multi\</tt>
<br><tt>line value</tt>
<br><tt>name4 = this is a single line ended by back slash\\</tt>
<br><tt>name5 = all backslashes and \</tt>
<br><tt>new lines must be \\escaped\\...</tt><tt></tt>
<p><tt><font color="#3366FF">[ section2.9-bis ]</font></tt>
<br><tt>; This is a comment...</tt>
<br><tt>name2 = value2</tt>
<br><tt></tt>&nbsp;</blockquote>
</blockquote>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Figure
1. An example configuration file</blockquote>
</blockquote>
</blockquote>
Comments are indicated by a leading semi-colon, and all comments and empty
lines are ignored by the registry file parser.&nbsp; Line continuations,
as usual, are indicated with a backslash escape. More generally,&nbsp;
backslashes are processed as:
<ul>
<li>
[backslash] + [backslash] is converted into a single [backslash]</li>

<li>
[backslash] + [space(s)] + [EndOfLine] is converted to an [EndOfLine]</li>

<li>
[backslash] + ["]&nbsp; is converted into a ["]</li>
</ul>
Character strings with embedded spaces do not need to be quoted,&nbsp;
and an unescaped double quote at the very beginning or end of a value is
ignored. All other combinations with [backslash] and ["] are invalid.
<p>The following restrictions apply to the <i>section</i> and <i>name</i>
identifiers occurring in a registry file:
<ul>
<li>
the string must contain only:&nbsp; [a-z], [A-Z], [0-9], [_.-] characters</li>

<li>
the interpretation of the string is <i>not</i> case-sensitive, i.e. <i>pATh
== path</i></li>

<li>
all leading and trailing spaces will be truncated</li>
</ul>

<h3>
<a NAME="transience"></a><i>CNcbiRegistry::EFlags</i></h3>
In addition to the constructor, which initializes the registry by loading
parameters from a file, the <i>CNcbiRegistry</i> class provides methods
for <i>saving</i> the registry (as a new configuration file), and reading
in additonal parameters from a secondary file.&nbsp; Each &lt;<i>name=value</i>>
pair stored in the registry has three attributes, specifying whether or
not that value is:
<ul>
<li>
<b><i>persistent,</i></b> meaning the value will be written to a file when
the registry is saved</li>

<li>
<b><i>overridabie,</i></b> meaning the value can be overridden by a new
value with the same name</li>

<li>
<b><i>truncatable,</i></b> meaning that leading and trailing blanks can
be truncated from the value</li>
</ul>
By default, all of the configuration's parameters are <i>persistent,</i>
<i>overridable</i>, and <i>truncatable</i>.&nbsp; The class definition
defines the <i>EFlags</i> enumeration for specifying these attributes,
and a related typedef, <i>TFlags</i>:
<blockquote>
<blockquote>
<blockquote><tt><font color="#005050">&nbsp;&nbsp;&nbsp; enum EFlags {</font></tt>
<br><tt><font color="#005050">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
eTransient&nbsp;&nbsp; = 0x1,</font></tt>
<br><tt><font color="#005050">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ePersistent&nbsp; = 0x100,</font></tt>
<br><tt><font color="#005050">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
eOverride&nbsp;&nbsp;&nbsp; = 0x2,</font></tt>
<br><tt><font color="#005050">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
eNoOverride&nbsp; = 0x200,</font></tt>
<br><tt><font color="#005050">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
eTruncate&nbsp;&nbsp;&nbsp; = 0x4,</font></tt>
<br><tt><font color="#005050">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
eNoTruncate&nbsp; = 0x400</font></tt>
<br><tt><font color="#005050">&nbsp;&nbsp;&nbsp; };</font></tt></blockquote>
</blockquote>
</blockquote>
<tt><font color="#005050">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
typedef int TFlags;</font></tt><font color="#000000"></font>
<p>Many of <i>CNcbiRegistry</i>'s methods take an optional <i>TFlags</i>
argument, which qualifies the selected values with respect to these attributes.
<font color="#000000">The class constructor takes two arguments - an input
stream, and an optional <i>TFlags</i> argument, where the latter can be
used to specify that all of the values should be stored as <i>transient</i>
rather than in the default mode, which is <i>persistent</i>:</font><font color="#009900"></font>
<center>
<p><tt><font color="#005050">CNcbiRegistry(CNcbiIstream&amp; is, TFlags
flags = 0);</font></tt></center>

<p>Once the registry has been initialized by its constructor, it is also
possible to load additional parameters from a specified file using the
<i>Read() </i>method:
<center>
<p><tt><font color="#005050">void Read(CNcbiIstream&amp; is, TFlags flags
= 0);</font></tt></center>

<p>Valid flags for the <i>Read() </i>method include<font color="#009900">
</font><i><font color="#000000">eTransient </font></i><font color="#000000">and<i>
eNoOverride. </i></font>The default is that all values are stored as <i>persistent</i>,
and that these stored values <i>can</i> be overidden when a new value associated
with the same name is loaded.&nbsp; Either or both of these defaults can
be modified by specifying <i><font color="#000000">eTransient, eNoOverride,
</font></i><font color="#000000">or<i> </i>(<i>eTransient | eNoOverride</i>)
as the <i>flags</i> argument in the above expression.</font><font color="#000000"></font>
<p>The <i>Write() </i>method takes as its sole argument, a destination
stream to which only the <i>persistent</i> configuration parameters will
be written.
<p>Values can also be set directly, using:
<center>
<p><tt><font color="#005050">&nbsp;&nbsp;&nbsp; bool Set(const string&amp;
section, const string&amp; name,</font></tt>
<br><tt><font color="#005050">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
const string&amp; value, TFlags flags = 0);</font></tt></center>

<p>Here, valid flag values include <font color="#000000"><i>ePersistent,
eNoOverride,</i> <i>eTruncate, </i>or any logical combination of these.&nbsp;
If <i>eNoOverride</i> is set and there <i>is</i> a previously defined value
for this paramter, then the value is not reset, and the method returns
<i>false.</i></font><font color="#000000"></font>
<p><font color="#000000">The <i>Get()</i> method first searches the set
of <i>transient</i> parameters for a parameter named <i>name</i>, and if
this fails,&nbsp; continues by searching the set of <i>persistent</i> parameters.
However, If the <i>ePersistent</i> flag is used, then only&nbsp; the set
of <i>persistent</i> parameters will be searched. On success, Get() returns
the stored value string, on failure, the empty string is returned.</font><font color="#000000"></font>
<center>
<p><tt><font color="#005050">const string&amp; Get(const string&amp; section,
const string&amp; name, EFlags flags = 0) const;</font></tt></center>

<h3>
<a NAME="methods"></a><font color="#000000">Additonal methods</font></h3>
Four additional methods are defined in the interface.
<p>&nbsp;<i>bool Empty(void) ;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
//&nbsp; </i>returns<i> true i</i>f the registry is empty
<br>&nbsp;void Clear(void);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
//&nbsp; discards all parameters currently stored in the registry
<br>&nbsp;void EnumerateSections(list&lt;string>* sections) ;&nbsp;&nbsp;
//&nbsp; writes a list of section names to <i>sections</i>
<br>&nbsp;void EnumerateEntries(const string&amp; section,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// writes a list of parameter names in <i>section </i>to<i> entries</i>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
list&lt;string>* entries);
<br>&nbsp;
<p><i><a href="traverse.html">previous</a></i><a href="traverse.html">&nbsp;</a>&nbsp;&nbsp;
<i><a href="../index.html">up&nbsp;</a></i><!-- a href=".html"> <i> next</i> </a-->
<hr>
<table BORDER=0 CELLSPACING=0 WIDTH="100%" >
<tr>
<td>
<address>
<a href="mailto:zimmerma@ncbi.nlm.nih.gov">Diane Zimmerman</a></address>
</td>

<td><!-- <td align=center><i>$Revision$</i></td> --></td>

<td ALIGN=RIGHT><i>$Date$</i></td>
</tr>
</table>

</body>
</html>
