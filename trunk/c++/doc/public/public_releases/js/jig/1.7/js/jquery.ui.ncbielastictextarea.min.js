(function(b){b.widget("ui.ncbielastictextarea",{styles:{copy:["paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","lineHeight","fontFamily","width","fontWeight"]},_create:function(){function h(d,e){curratedHeight=Math.floor(parseInt(d,10));a.height()!=curratedHeight&&a.css({height:curratedHeight+"px",overflow:e})}function f(d){var e=a.val().replace(/&/g,"&amp;").replace(/  /g,"&nbsp;").replace(/<|>/g,"&gt;").replace(/\n/g,"<br />"),k=c.html();if(e+"&nbsp;"!=k||d=="force"){c.html(e+
"&nbsp;");if(Math.abs(c.height()+i-a.height())>3){d=c.height()+i;if(d>=g)h(g,"auto");else d<=j?h(j,"hidden"):h(d,"hidden")}}}var a=this.element;if(a.attr("type")!="textarea")return false;this.elastic_uid=b.ui.jig._generateId("ncbielastictextarea");a.css("word-wrap","break-word");var c=b("<div />").css({position:"absolute",display:"none","word-wrap":"break-word"}).attr("id",this.elastic_uid),i=parseInt(a.css("line-height"),10)||parseInt(a.css("font-size"),"10"),j=parseInt(a.css("height"),10)||i*3,
g=parseInt(a.css("max-height"),10)||Number.MAX_VALUE;if(g<0)g=Number.MAX_VALUE;c.appendTo(a.parent());b(this.styles.copy).each(function(){c.css(this.toString(),a.css(this.toString()))});b(window).bind("resize."+this.elastic_uid,function(){c.css("width",a.width()+"px");f("force")});a.css({overflow:"hidden"});c.css("width",a.width()+"px");a.bind("keyup."+this.elastic_uid,function(){f()});a.bind("input."+this.elastic_uid+" paste."+this.elastic_uid,function(){setTimeout(f,250)});f()},destroy:function(){this.element.unbind("."+
this.elastic_uid);b("#"+this.elastic_uid).remove();this.element.css({"word-wrap":"",overflow:"",height:""});b(window).unbind("resize."+this.elastic_uid);b.Widget.prototype.destroy.apply(this,arguments)}});b.ui.ncbielastictextarea.prototype.options={};b.ui.ncbielastictextarea.prototype.version="1.2"})(jQuery);
