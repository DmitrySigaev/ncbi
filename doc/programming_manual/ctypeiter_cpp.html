<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
  <head>
    <title>ctypeiter.cpp</title>
  </head>

  <body BGCOLOR="#FFFFFF">
  <pre><font color = "red">// File name: ctypeiter.cpp
// Description: Demonstrate using a CTypeIterator
// Notes: build with xncbi and xser libraries
<font color = "green">
#include <a href="ctypeiter_hpp.html"> "ctypeiter.hpp" </a>
#include &lt;serial/serial.hpp&gt;
#include &lt;serial/objistr.hpp&gt;
#include &lt;serial/objostr.hpp&gt;
#include &lt;serial/iterator.hpp&gt;
#include &lt;serial/serialimpl.hpp&gt;

<font color = "red">//  type information for class CPerson
<font color = "blue">BEGIN_CLASS_INFO(CPerson)<font color = "black">
{
    ADD_STD_MEMBER(m_name);
    ADD_STD_MEMBER(m_addr);
    ADD_MEMBER(m_next_door, POINTER, (CLASS, (CPerson)))->SetOptional();
}
<font color = "blue">END_CLASS_INFO

<font color = "red">//  type information for class CDistrict
<font color = "blue">BEGIN_CLASS_INFO(CDistrict)<font color = "black">
{
    ADD_STD_MEMBER(m_number);
    ADD_MEMBER(m_blocks, STL_list, (CLASS, (CPerson)));
}
<font color = "blue">END_CLASS_INFO

<font color = "red">// main and other functions <font color = "blue">

USING_NCBI_SCOPE;<font color = "black">

static void FullerBrushMan (const CPerson& p) {
    cout << "knock-knock! is " << p.m_name << " home?" << endl;
}


int main(int argc, char** argv)
{
<font color = "red">    // Instantiate a few CPerson objects </font>
    CPerson neighborhood("Moe", "1 Main St", 
                         new CPerson("Larry", "2 Main St",
                                     new CPerson("Curly", "3 Main St", 0)));

    CPerson another ("Harpo", "2 River Rd", 
                     new CPerson("Chico", "4 River Rd", 
                                 new CPerson("Groucho", "6 River Rd", 0)));

 <font color = "red">   // Create a CDistrict and install some CPerson objects </font>
    CDistrict district1(1);
    district1.AddBlock(neighborhood);
    district1.AddBlock(another);

<font color = "red">    // Send the FullerBrushMan to all CPersons in district1 </font>
    for (CTypeConstIterator&lt;CPerson> house = ConstBegin(district1);
         house; ++house ) {
        FullerBrushMan(*house);
    }

<font color = "red">    // Iterate over all strings for the CPersons in district1 </font>
    list&lt;CPerson> blocks = district1.GetBlocks();

    for (list&lt;CPerson>::iterator b = blocks.begin();
	 b != blocks.end(); ++b) {

        for (CStdTypeIterator&lt;string> i = Begin(*b); i; ++i) {
            cout << *i << ' ';
	}
	cout << endl;
    }
    return 0;
}

</pre>
</body>
</html>

