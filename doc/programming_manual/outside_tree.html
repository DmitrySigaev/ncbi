<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
  <title>Working in a separate directory </title>
</head>
<body BGCOLOR=white>
<h1> Working in a separate directory </h1>

<ul>
  <li> <a href="#overview"> Overview </a> 
  <li> <a href="#makefiles"> The Project's Makefile </a>
  <li> <a href="#testing"> Testing your setup </a>
</ul>

<a name="overview">
<h3> Overview </h3>

There are two topics relevant to writing an application using the NCBI C++ Toolkit:

<ol>
  <li> Where to place the source and header files for the project
  <li> How to create a makefile which can link to the correct C++ libraries
</ol>

What you put in your makefile will depend on where you define your working directory. In
this discussion, we assume you will be working <i><b> outside </i></b> the NCBI C++ tree,
say in a directory called <i>NewProj</i>. This is where you will write both your source
and header files.  The first step then, is to create the new working directory and use the
<a href="../new_proj.html#ref_OutsideCreate"> <i> new_project.sh</i></a> script to install
a makefile there:<p>

<pre>
birch% mkdir NewProj

birch% $NCBI/c++/scripts/new_project.sh NewProj app $NCBI/c++/GCC-Debug/build
Created a model makefile "/home/zimmerma/NewProj/Makefile.NewProj_app". </font>
</pre>

The syntax of the script command is:
<center> <xmp>
new_project.sh  project_name  <app | lib>  [builddir] 
</xmp></center>
where:
<dl>
  <dt> - <i> project_name </i> is the name of the directory you will be working in
  <dt> - <i> app (lib) </i> is used to indicate whether you will be building an application or a library
  <dt> - <i> builddir </i>  (optional) specifies what version of the pre-built NCBI C++ Toolkit
		  libraries to link to
</dl>
Several build environments have been pre-configured and are available for developing on various
platforms using different compilers, in either <i> debug</i> or <i> release </i> mode. These
environments include custom-made configuration files, makefile templates, and links to the
appropriate pre-built C++ Toolkit libraries. To see a list of the available environments for
the platform you are working on, use: <i>ls -d $NCBI/c++/*/build</i>. For example, on <i>Solaris</i>, 
the following <i>build</i> directories are currently available: 
<center><p>
<table border=1 width="600" cellspacing=1>
  <caption></caption>
<tr> <th> Directory </th> <th> Compiler </th> <th> Version </th> </tr>
<tr> <td><i> /netopt/ncbi_tools/c++/Debug/build </i> </td> <td> Sun Workshop</td><td> Debug </td></tr>
<tr> <td><i> /netopt/ncbi_tools/c++/Debug64/build </i> </td> <td> Sun Workshop</td><td> Debug (64 bit) </td></tr>
<tr> <td><i> /netopt/ncbi_tools/c++/DebugMT/build </i> </td> <td> Sun Workshop</td><td> Debug (Multi-thread safe)</td></tr>
<tr> <td><i> /netopt/ncbi_tools/c++/Release/build </i></td> <td> Sun Workshop</td><td> Release </td></tr>
<tr> <td><i> /netopt/ncbi_tools/c++/ReleaseMT/build </i></td> <td> Sun Workshop</td><td> Release (Multi-thread safe)</td></tr>
<tr> <td><i> /netopt/ncbi_tools/c++/GCC-Debug/build     </i></td> <td> GCC </td><td> Debug </td></tr>
<tr> <td><i> /netopt/ncbi_tools/c++/GCC-Release/build   </i></td> <td> GCC </td><td> Release </td></tr>
</table>
</center><p>

In the example above, we specified the GNU compiler debug environment:
<i>$NCBI/c++/GCC-Debug/build</i>. For a list of currently supported compilers, see the
Reference Manual's <a href="../config.html#ref_Compilers"> <i>Installation and configuration</i></a>
page.  Running the <i>new_project.sh</i> script will generate a ready-to-use makefile in the
directory you just created.  For a more detailed description of this and other scripts to
assist you in the set-up of your working environment, see the Reference Manual page <a
href="../new_proj.html"> <i>Starting a new C++ project</i></a>.

<a name="makefiles">
<h3> The Project's Makefile </h3>

The file you just created with the above script will be called <i>Makefile.NewProj_app</i>. In
addition to other things, you will see definitions for:

<dl>
  <dt> - <i> $(builddir) </i> - a path to the build directory specified in the last argument to the above script 
  <dt> - <i> $(srcdir) </i> - the path to your current working directory (".")
  <dt> - <i> $(APP) </i> - the application name 
  <dt> - <i> $(OBJ) </i> - the names of the object modules to build and link to the application
  <dt> - <i> $(LIB)</i> - specific libraries to link to in the NCBI C++ Toolkit
  <dt> - <i> $(LIBS) </i> - all other libraries to link to (outside the C++ Toolkit)
</dl>

<i>$(builddir)/lib</i> specifies the library path (-L), which in this case points to the
GNU debug versions of the NCBI C++ Toolkit libraries. $(LIB)
lists the individual libraries in this path that you will be linking to. Minimally, this should
include <i>xncbi</i> - the library which implements the foundational classes for the C++
tools. Additional library names (e.g. <i>xhtml, xcgi, </i> etc.) can be added here. <p>

Since the shell script assumes you will be building a single executable with the same name
as your working directory, the application is defined simply as <i>NewProj</i>. Additional
targets to build can be added in the area indicated towards the end of the file. The list
of objects (OBJ) should include the names (without extensions) of all source files for the
application (APP). Again, the script makes the simplest assumption, i.e. that there is a
single source file named <i>NewProj.cpp</i>. Additional source names can be added here.

<a name="testing"> <h3>Testing your setup </h3>
For a very simple application, this makefile is ready to be run. Try it out now, by creating
the file <i>NewProj.cpp</i>:

<font color = "#008080"> 
<pre>
// File name: NewProj.cpp

#include &lt;iostream&gt;

using namespace std;

int main() {
    cout << "Hello again, world" << endl;
}
</pre>
<font color = black> 

and running: <i> make -f Makefile.NewProj_app</i>. <p>

Of course, it wasn't necessary to set up the directories and makefiles to accomplish this much,
as this example does not use any of the C++ classes or resources defined in the NCBI C++
Toolkit. But having accomplished this, you are now prepared to write an actual application,
such as described in <a href="applic.html"> <i>Writing a simple application project</i></a>
<p>

Most real applications will at a minimum, require that you <i>#include</i>
<a href="../lxr/source/include/corelib/ncbistd.hpp">
<i>ncbistd.hpp</i></a> in your header file. In addition to defining some basic NCBI C++ Toolkit
objects and templates, this header file in turn includes other header files that define the C
Toolkit data types, NCBI namespaces, debugging macros, and exception classes. A  set of <a
href="http://www.ncbi.nlm.nih.gov/IEB/CPP_DOC/new_mod.html"> template </a> files are also provided for
your use in developing new applications. <p>

</body>
<a href="../index.html"> <i> up </i> </a>
&nbsp;&nbsp;&nbsp;
<a href="sub_tree.html"> <i> next </i> </a>
</html>


	 <hr>
	 <table border=0 width="100%" cellspacing=0>
		<tr>
		  <td><address><a href="mailto:zimmerma@ncbi.nlm.nih.gov">Diane Zimmerman</a></address></td>
		  <!-- <td align=center><i>$Revision$</i></td> -->
		  <td align=right><i>$Date$</i></td>
	 </table>
