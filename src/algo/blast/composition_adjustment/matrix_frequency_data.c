/* ===========================================================================
*
*                            PUBLIC DOMAIN NOTICE
*               National Center for Biotechnology Information
*
*  This software/database is a "United States Government Work" under the
*  terms of the United States Copyright Act.  It was written as part of
*  the author's official duties as a United States Government employee and
*  thus cannot be copyrighted.  This software/database is freely available
*  to the public for use. The National Library of Medicine and the U.S.
*  Government have not placed any restriction on its use or reproduction.
*
*  Although all reasonable efforts have been taken to ensure the accuracy
*  and reliability of the software and data, the NLM and the U.S.
*  Government do not and cannot warrant the performance or results that
*  may be obtained by using this software or data. The NLM and the U.S.
*  Government disclaim all warranties, express or implied, including
*  warranties of performance, merchantability or fitness for any particular
*  purpose.
*
*  Please cite the author in any work or product based on this material.
*
* ===========================================================================*/

/** @file matrix_frequency_data.c
 * Joint probabilities for specific matrices.
 *
 * @author Yi-Kuo Yu, Alejandro Schaffer, E. Michael Gertz
 */
#ifndef SKIP_DOXYGEN_PROCESSING
static char const rcsid[] =
    "$Id$";
#endif /* SKIP_DOXYGEN_PROCESSING */

#include <stdlib.h>
#include <algo/blast/core/ncbi_std.h>
#include <algo/blast/composition_adjustment/composition_constants.h>
#include <algo/blast/composition_adjustment/matrix_frequency_data.h>


/*
 * Joint and background probabilities for the BLOSUM series of
 * matrices.
 *
 * These data are the actual joint probabilities originally used to
 * generate the BLOSUM matrices, printed at full precision (because we
 * can.)  The blocks data was obtained from
 *
 *    ftp://ftp.ncbi.nih.gov/repository/blocks/unix/blosum/blocks_5.0.dat.Z
 *
 * and used to generate the joint probabilities for the BLOSUM
 * matrices, using a small modification to the 'blosum' program
 * supplied in 
 *
 *    ftp://ftp.ncbi.nih.gov/repository/blocks/unix/blosum/blosum.tar.Z
 *
 * The 'blosum' program generates files that contain joint
 * probabilities, e.g. 'blosum62.qij', but these probabilities are by
 * default printed at low accuracy.  We modified the print statements
 * the generate blosum??.qij to print at full precision. The specific
 * modification to the Oct 18, 1992 version of the file blosum.c is
 *
 * 229c229
 * <        fprintf(fout, "%.4f ", (double) fij / totpairs);
 * ---
 * >        fprintf(fout, "%.16e ", (double) fij / totpairs);
 *
 * Internally, the 'blosum' program uses exactly the higher-precision
 * values that we print out to compute matrices.
 */


/** Joint probabilities for BLOSUM45 */
static double
BLOSUM45_JOINT_PROBS[COMPO_NUM_TRUE_AA][COMPO_NUM_TRUE_AA] =
{
  {1.8067859192199651e-02, 2.8632970280029189e-03, 2.5852716092104864e-03,
   2.6802872542729885e-03, 1.4721761726112878e-03, 2.4357016851740214e-03,
   3.7509741193044975e-03, 6.3392371060867767e-03, 1.2691974410907309e-03,
   3.6179059863255059e-03, 5.2267067349121834e-03, 3.6916191127573101e-03,
   1.6118871872377726e-03, 2.1340510849853227e-03, 2.3620871424910785e-03,
   6.2253573100243412e-03, 4.1104541288450981e-03, 5.9150588019808183e-04,
   1.6885104821419373e-03, 5.5306101689579796e-03},
  {2.8632970280029189e-03, 1.2981201352308378e-02, 1.9658257815459023e-03,
   2.0049066095474076e-03, 5.7991132007379289e-04, 2.4961427104605001e-03,
   3.0703156814048727e-03, 2.2360083825481514e-03, 1.2617224002813071e-03,
   1.5810689324881372e-03, 2.9473459585734607e-03, 6.0953893700066292e-03,
   1.0175430650195330e-03, 1.4313644854523438e-03, 1.2956809668774457e-03,
   2.5563801601305607e-03, 1.9632608045077912e-03, 4.0556397557578358e-04,
   1.4263902102458958e-03, 2.1140813134646885e-03},
  {2.5852716092104864e-03, 1.9658257815459023e-03, 7.8501470034711886e-03,
   3.1259558053206788e-03, 6.6941554412093584e-04, 1.5524817804651980e-03,
   2.1724722312522963e-03, 3.3237456813136586e-03, 1.2666696726132058e-03,
   1.4625067095661482e-03, 1.8988677499765833e-03, 2.8106528553236663e-03,
   7.1583261905988334e-04, 1.1127971670944336e-03, 1.1422087671867729e-03,
   3.0730446623880589e-03, 2.4501354524355920e-03, 2.1811180797041274e-04,
   8.5687995159461643e-04, 1.6162116532974411e-03},
  {2.6802872542729885e-03, 2.0049066095474076e-03, 3.1259558053206788e-03,
   1.3237563732845571e-02, 6.2265374552703391e-04, 1.7098653558570117e-03,
   4.7436012699642992e-03, 2.7602948240886133e-03, 1.2034182798676748e-03,
   1.3552305161392132e-03, 2.1559462215056625e-03, 2.8090778444402500e-03,
   6.1643397738889020e-04, 9.9489940177469407e-04, 1.5334105263610980e-03,
   2.8268709927001139e-03, 2.2865632447178858e-03, 2.4814784831918892e-04,
   1.0831280925706914e-03, 1.7172231262216453e-03},
  {1.4721761726112878e-03, 5.7991132007379289e-04, 6.6941554412093584e-04,
   6.2265374552703391e-04, 9.4412874076739879e-03, 4.1042025902182758e-04,
   7.4458585782220040e-04, 9.8139056130103924e-04, 2.8594866937112776e-04,
   7.8981156978924646e-04, 1.4823588205010103e-03, 7.7106114710675307e-04,
   3.5586318613686682e-04, 6.5657489327527010e-04, 4.1203914885321426e-04,
   1.1459765491404468e-03, 1.0139516933242551e-03, 1.0481557906271918e-04,
   3.8818429938079952e-04, 1.1756651305043552e-03},
  {2.4357016851740214e-03, 2.4961427104605001e-03, 1.5524817804651980e-03,
   1.7098653558570117e-03, 4.1042025902182758e-04, 5.6843729268296912e-03,
   3.1938622849651262e-03, 1.8500970336630773e-03, 1.0245276847880554e-03,
   1.2849197264462630e-03, 2.1618326111720785e-03, 2.8660992672576535e-03,
   8.4702447612542125e-04, 7.3960293189886505e-04, 1.0946565407497567e-03,
   2.3989430846357322e-03, 1.4716698819858265e-03, 3.0973861280282215e-04,
   1.0059662375582828e-03, 1.3753940441066036e-03},
  {3.7509741193044975e-03, 3.0703156814048727e-03, 2.1724722312522963e-03,
   4.7436012699642992e-03, 7.4458585782220040e-04, 3.1938622849651262e-03,
   1.3069658477215567e-02, 2.5107356320500625e-03, 1.3852382529276910e-03,
   1.7450831790645173e-03, 3.1086857110181228e-03, 4.4504838476236725e-03,
   8.9571496470550454e-04, 1.3425662787911086e-03, 2.2536863740022671e-03,
   3.2415108480856065e-03, 2.5397857261280324e-03, 4.0327648497408492e-04,
   1.2098752538504236e-03, 2.2567534430266742e-03},
  {6.3392371060867767e-03, 2.2360083825481514e-03, 3.3237456813136586e-03,
   2.7602948240886133e-03, 9.8139056130103924e-04, 1.8500970336630773e-03,
   2.5107356320500625e-03, 2.8511624448995753e-02, 1.2310524422167546e-03,
   1.9327062043969442e-03, 3.1643945035180797e-03, 3.0499894759105127e-03,
   1.0995162153881082e-03, 1.6723363525115967e-03, 2.2429535327172330e-03,
   4.8536849682850143e-03, 2.7272360099530155e-03, 5.9271120428223316e-04,
   1.3911803421160626e-03, 2.5146676607186078e-03},
  {1.2691974410907309e-03, 1.2617224002813071e-03, 1.2666696726132058e-03,
   1.2034182798676748e-03, 2.8594866937112776e-04, 1.0245276847880554e-03,
   1.3852382529276910e-03, 1.2310524422167546e-03, 5.8487547639124796e-03,
   6.9585846800609714e-04, 1.5573467613102150e-03, 1.3245694120032801e-03,
   5.7090651699323862e-04, 7.8182832078834081e-04, 6.9844962409397991e-04,
   1.2960325177514280e-03, 9.1931607877249958e-04, 1.4976351019639964e-04,
   1.2330522291934879e-03, 7.9246698200683503e-04},
  {3.6179059863255059e-03, 1.5810689324881372e-03, 1.4625067095661482e-03,
   1.3552305161392132e-03, 7.8981156978924646e-04, 1.2849197264462630e-03,
   1.7450831790645173e-03, 1.9327062043969442e-03, 6.9585846800609714e-04,
   1.2388694439401509e-02, 9.2647566985432136e-03, 1.9773203824746490e-03,
   2.2593292403687306e-03, 3.0575457844642532e-03, 1.6077385068018789e-03,
   2.3421848303183976e-03, 2.7542711781141610e-03, 4.6749463838911354e-04,
   1.8956764459114616e-03, 9.4267822167510788e-03},
  {5.2267067349121834e-03, 2.9473459585734607e-03, 1.8988677499765833e-03,
   2.1559462215056625e-03, 1.4823588205010103e-03, 2.1618326111720785e-03,
   3.1086857110181228e-03, 3.1643945035180797e-03, 1.5573467613102150e-03,
   9.2647566985432136e-03, 2.6346530417480200e-02, 3.1142098082328640e-03,
   4.0711638827261041e-03, 5.6719761997807835e-03, 1.9088185348168649e-03,
   3.1873279813785520e-03, 3.8426846085017905e-03, 8.4082046153240706e-04,
   3.0567323782711214e-03, 8.7503010016331175e-03},
  {3.6916191127573101e-03, 6.0953893700066292e-03, 2.8106528553236663e-03,
   2.8090778444402500e-03, 7.7106114710675307e-04, 2.8660992672576535e-03,
   4.4504838476236725e-03, 3.0499894759105127e-03, 1.3245694120032801e-03,
   1.9773203824746490e-03, 3.1142098082328640e-03, 1.1978396089560937e-02,
   1.1104403771137466e-03, 1.4742483750212233e-03, 1.9968025222690676e-03,
   3.2668812435946099e-03, 2.7862613227875948e-03, 4.5043772800615431e-04,
   1.4940888302424689e-03, 2.4843185667476147e-03},
  {1.6118871872377726e-03, 1.0175430650195330e-03, 7.1583261905988334e-04,
   6.1643397738889020e-04, 3.5586318613686682e-04, 8.4702447612542125e-04,
   8.9571496470550454e-04, 1.0995162153881082e-03, 5.7090651699323862e-04,
   2.2593292403687306e-03, 4.0711638827261041e-03, 1.1104403771137466e-03,
   2.5874360305861857e-03, 1.2371987255888946e-03, 6.8765677463444332e-04,
   1.0131873446874034e-03, 1.1327846844696357e-03, 2.1265849704555571e-04,
   8.6680034269080448e-04, 2.1688399348504966e-03},
  {2.1340510849853227e-03, 1.4313644854523438e-03, 1.1127971670944336e-03,
   9.9489940177469407e-04, 6.5657489327527010e-04, 7.3960293189886505e-04,
   1.3425662787911086e-03, 1.6723363525115967e-03, 7.8182832078834081e-04,
   3.0575457844642532e-03, 5.6719761997807835e-03, 1.4742483750212233e-03,
   1.2371987255888946e-03, 1.2391203870190888e-02, 8.9236221263296761e-04,
   1.7312816295078565e-03, 1.7453918151105632e-03, 8.4095245274993082e-04,
   3.4263744717066835e-03, 3.0946984716836139e-03},
  {2.3620871424910785e-03, 1.2956809668774457e-03, 1.1422087671867729e-03,
   1.5334105263610980e-03, 4.1203914885321426e-04, 1.0946565407497567e-03,
   2.2536863740022671e-03, 2.2429535327172330e-03, 6.9844962409397991e-04,
   1.6077385068018789e-03, 1.9088185348168649e-03, 1.9968025222690676e-03,
   6.8765677463444332e-04, 8.9236221263296761e-04, 1.6004098119159461e-02,
   1.9539606804874826e-03, 1.9148086102650892e-03, 2.9896951765680344e-04,
   6.8907122080648483e-04, 1.6099029423219423e-03},
  {6.2253573100243412e-03, 2.5563801601305607e-03, 3.0730446623880589e-03,
   2.8268709927001139e-03, 1.1459765491404468e-03, 2.3989430846357322e-03,
   3.2415108480856065e-03, 4.8536849682850143e-03, 1.2960325177514280e-03,
   2.3421848303183976e-03, 3.1873279813785520e-03, 3.2668812435946099e-03,
   1.0131873446874034e-03, 1.7312816295078565e-03, 1.9539606804874826e-03,
   1.0412392255159685e-02, 4.7291383160678064e-03, 3.5033107367116276e-04,
   1.4588588725561497e-03, 3.1161052123834937e-03},
  {4.1104541288450981e-03, 1.9632608045077912e-03, 2.4501354524355920e-03,
   2.2865632447178858e-03, 1.0139516933242551e-03, 1.4716698819858265e-03,
   2.5397857261280324e-03, 2.7272360099530155e-03, 9.1931607877249958e-04,
   2.7542711781141610e-03, 3.8426846085017905e-03, 2.7862613227875948e-03,
   1.1327846844696357e-03, 1.7453918151105632e-03, 1.9148086102650892e-03,
   4.7291383160678064e-03, 8.6497284024982021e-03, 3.1868671219664247e-04,
   1.3184355271303671e-03, 3.8213223234837145e-03},
  {5.9150588019808183e-04, 4.0556397557578358e-04, 2.1811180797041274e-04,
   2.4814784831918892e-04, 1.0481557906271918e-04, 3.0973861280282215e-04,
   4.0327648497408492e-04, 5.9271120428223316e-04, 1.4976351019639964e-04,
   4.6749463838911354e-04, 8.4082046153240706e-04, 4.5043772800615431e-04,
   2.1265849704555571e-04, 8.4095245274993082e-04, 2.9896951765680344e-04,
   3.5033107367116276e-04, 3.1868671219664247e-04, 5.3077625858668461e-03,
   8.1328347217338593e-04, 4.4278005713663357e-04},
  {1.6885104821419373e-03, 1.4263902102458958e-03, 8.5687995159461643e-04,
   1.0831280925706914e-03, 3.8818429938079952e-04, 1.0059662375582828e-03,
   1.2098752538504236e-03, 1.3911803421160626e-03, 1.2330522291934879e-03,
   1.8956764459114616e-03, 3.0567323782711214e-03, 1.4940888302424689e-03,
   8.6680034269080448e-04, 3.4263744717066835e-03, 6.8907122080648483e-04,
   1.4588588725561497e-03, 1.3184355271303671e-03, 8.1328347217338593e-04,
   6.5658130332894053e-03, 1.9130855013886519e-03},
  {5.5306101689579796e-03, 2.1140813134646885e-03, 1.6162116532974411e-03,
   1.7172231262216453e-03, 1.1756651305043552e-03, 1.3753940441066036e-03,
   2.2567534430266742e-03, 2.5146676607186078e-03, 7.9246698200683503e-04,
   9.4267822167510788e-03, 8.7503010016331175e-03, 2.4843185667476147e-03,
   2.1688399348504966e-03, 3.0946984716836139e-03, 1.6099029423219423e-03,
   3.1161052123834937e-03, 3.8213223234837145e-03, 4.4278005713663357e-04,
   1.9130855013886519e-03, 1.4058608660834061e-02}};

/** Background frequencies for BLOSUM45 */
static double
BLOSUM45_bg[COMPO_NUM_TRUE_AA] =
{7.8254696826829992e-02, 5.2293400508515497e-02, 4.1869234505207159e-02,
 4.9715478669430609e-02, 2.3504091554598174e-02, 3.5913319135963809e-02,
 5.8088865918176615e-02, 7.4985562582061308e-02, 2.4796120028184831e-02,
 6.1906885653760506e-02, 9.3758807045384390e-02, 6.0002347578480664e-02,
 2.5078218042817218e-02, 4.6429254925009635e-02, 4.2599362265185327e-02,
 6.1179450532953900e-02, 5.2495886521295561e-02, 1.3367812099806363e-02,
 3.3781387194819178e-02, 6.9979818411519248e-02};


/** Joint probabilities for BLOSUM50 */
static double
BLOSUM50_JOINT_PROBS[COMPO_NUM_TRUE_AA][COMPO_NUM_TRUE_AA] =
{
  {1.9177376165900414e-02, 2.7240376714546557e-03, 2.4031492992281512e-03,
   2.5950400141435646e-03, 1.5161141503466080e-03, 2.1916331677173605e-03,
   3.4448278914639618e-03, 6.2251471153775524e-03, 1.2127849526349368e-03,
   3.5067963781079273e-03, 4.8064175187919377e-03, 3.3118156445774184e-03,
   1.5929928229676674e-03, 2.0111462534334831e-03, 2.2367690269707355e-03,
   6.2077372467778114e-03, 3.9182728585714704e-03, 4.8631739510959277e-04,
   1.5289255743243066e-03, 5.4421693501580945e-03},
  {2.7240376714546557e-03, 1.5249518561669190e-02, 1.9839339217171100e-03,
   1.8569646551144466e-03, 5.0841145558634812e-04, 2.5241992415035875e-03,
   2.9346714600391238e-03, 2.0330929248566329e-03, 1.2916661377324677e-03,
   1.4850904029213015e-03, 2.8200506536265085e-03, 6.3631786906688794e-03,
   8.8044244163237157e-04, 1.1827555704613821e-03, 1.1291633722052721e-03,
   2.5480707779992882e-03, 2.0755623893205866e-03, 3.8597740102525838e-04,
   1.2968650803478032e-03, 1.9767324973351923e-03},
  {2.4031492992281512e-03, 1.9839339217171100e-03, 1.0064274648985122e-02,
   3.4938528463521034e-03, 5.8526580393535813e-04, 1.5772225567522585e-03,
   2.2654955215314441e-03, 3.1227790949497000e-03, 1.5032392778514345e-03,
   1.2604525924282989e-03, 1.7212395367610532e-03, 2.6781179272946298e-03,
   6.5072987349609041e-04, 9.2077070726659231e-04, 1.0780835837505738e-03,
   3.1777703084905646e-03, 2.5607235691682607e-03, 2.2470939491808472e-04,
   9.0102455753719311e-04, 1.4642269583191670e-03},
  {2.5950400141435646e-03, 1.8569646551144466e-03, 3.4938528463521034e-03,
   1.6142284245400377e-02, 4.9055796014848500e-04, 1.7355972391605227e-03,
   4.8092932462930728e-03, 2.8256049847966923e-03, 1.1224039610689225e-03,
   1.2187267471037043e-03, 1.8320202151810498e-03, 2.6483031701007680e-03,
   5.4518900860208049e-04, 8.3372775443144032e-04, 1.4911089792375384e-03,
   2.8168184837142236e-03, 2.2443557004503045e-03, 2.1629521399451062e-04,
   8.6838200454238037e-04, 1.6071086977600263e-03},
  {1.5161141503466080e-03, 5.0841145558634812e-04, 5.8526580393535813e-04,
   4.9055796014848500e-04, 9.0790816399874165e-03, 3.7509694198458956e-04,
   5.7443167694834051e-04, 8.6416125741413223e-04, 2.8532822032727102e-04,
   8.3949095461630769e-04, 1.3866946702884293e-03, 5.9394346268641564e-04,
   3.7056882781629923e-04, 6.0643258121975913e-04, 3.6775301298071699e-04,
   1.1014893301583900e-03, 9.6593119839638185e-04, 9.5473415415687051e-05,
   4.0265275985100583e-04, 1.3071530803028910e-03},
  {2.1916331677173605e-03, 2.5241992415035875e-03, 1.5772225567522585e-03,
   1.7355972391605227e-03, 3.7509694198458956e-04, 5.7288780946700701e-03,
   3.2946407159359019e-03, 1.6542835961738131e-03, 1.0434512306085959e-03,
   1.1246276733803604e-03, 1.8792097500823605e-03, 2.8672107479796771e-03,
   8.1749695236423632e-04, 7.0039848968711364e-04, 1.0716022846036992e-03,
   2.2199500917807818e-03, 1.4976248429072652e-03, 3.4211307677156259e-04,
   8.6801232355735846e-04, 1.4099696811263587e-03},
  {3.4448278914639618e-03, 2.9346714600391238e-03, 2.2654955215314441e-03,
   4.8092932462930728e-03, 5.7443167694834051e-04, 3.2946407159359019e-03,
   1.4137738860962050e-02, 2.2506310350989874e-03, 1.2713631289270268e-03,
   1.5027392767795753e-03, 2.5813459827982222e-03, 4.3484287857007489e-03,
   8.3289745544177065e-04, 1.2381529956170115e-03, 1.9357892959573676e-03,
   2.9614835299989701e-03, 2.4465955340418752e-03, 4.2400226067181517e-04,
   1.2320532047293646e-03, 1.9587224017250621e-03},
  {6.2251471153775524e-03, 2.0330929248566329e-03, 3.1227790949497000e-03,
   2.8256049847966923e-03, 8.6416125741413223e-04, 1.6542835961738131e-03,
   2.2506310350989874e-03, 3.1590334199549770e-02, 1.0972793065146165e-03,
   1.7523277816042203e-03, 2.6606416500206632e-03, 2.7990435215878512e-03,
   9.3546770862675606e-04, 1.4703871152100261e-03, 1.8725532583338258e-03,
   4.3892726706643180e-03, 2.4867404596474229e-03, 5.1106914401047939e-04,
   1.1558215242534139e-03, 2.1542687026690753e-03},
  {1.2127849526349368e-03, 1.2916661377324677e-03, 1.5032392778514345e-03,
   1.1224039610689225e-03, 2.8532822032727102e-04, 1.0434512306085959e-03,
   1.2713631289270268e-03, 1.0972793065146165e-03, 6.3804882118271523e-03,
   6.5152626785360663e-04, 1.2931025418026663e-03, 1.3522962310675180e-03,
   4.5805146362189403e-04, 8.9702000483341665e-04, 5.8791282749163360e-04,
   1.2089586814863836e-03, 8.5349236685497410e-04, 1.6088475111162087e-04,
   1.2994388028749182e-03, 7.4034388655116329e-04},
  {3.5067963781079273e-03, 1.4850904029213015e-03, 1.2604525924282989e-03,
   1.2187267471037043e-03, 8.3949095461630769e-04, 1.1246276733803604e-03,
   1.5027392767795753e-03, 1.7523277816042203e-03, 6.5152626785360663e-04,
   1.3999757001274281e-02, 1.0390816757632199e-02, 1.7363767070665819e-03,
   2.2467399442463766e-03, 3.0498186875911964e-03, 1.3390359572833434e-03,
   2.0791955470136677e-03, 2.9182353019045755e-03, 4.5881135439627285e-04,
   1.7726237165460320e-03, 1.0732172589653342e-02},
  {4.8064175187919377e-03, 2.8200506536265085e-03, 1.7212395367610532e-03,
   1.8320202151810498e-03, 1.3866946702884293e-03, 1.8792097500823605e-03,
   2.5813459827982222e-03, 2.6606416500206632e-03, 1.2931025418026663e-03,
   1.0390816757632199e-02, 3.0409269773873687e-02, 2.6510115013545226e-03,
   4.1722701893507309e-03, 5.8008510370760203e-03, 1.7339408813938210e-03,
   2.9030148705129709e-03, 3.8403853123581615e-03, 7.8809411669902049e-04,
   2.7481481703784771e-03, 9.1689424893657400e-03},
  {3.3118156445774184e-03, 6.3631786906688794e-03, 2.6781179272946298e-03,
   2.6483031701007680e-03, 5.9394346268641564e-04, 2.8672107479796771e-03,
   4.3484287857007489e-03, 2.7990435215878512e-03, 1.3522962310675180e-03,
   1.7363767070665819e-03, 2.6510115013545226e-03, 1.2999587798271149e-02,
   9.6710745846319019e-04, 1.2387025901401758e-03, 1.8070838729286381e-03,
   3.0739875836290694e-03, 2.5875240617244397e-03, 3.6617320485888769e-04,
   1.2944286682925433e-03, 2.1916787299081464e-03},
  {1.5929928229676674e-03, 8.8044244163237157e-04, 6.5072987349609041e-04,
   5.4518900860208049e-04, 3.7056882781629923e-04, 8.1749695236423632e-04,
   8.3289745544177065e-04, 9.3546770862675606e-04, 4.5805146362189403e-04,
   2.2467399442463766e-03, 4.1722701893507309e-03, 9.6710745846319019e-04,
   2.8637130884961001e-03, 1.2334264856852042e-03, 5.4319510273222540e-04,
   9.8962843407290630e-04, 1.1386579188117374e-03, 2.5453642381012927e-04,
   7.4966082446689317e-04, 2.1431247883570799e-03},
  {2.0111462534334831e-03, 1.1827555704613821e-03, 9.2077070726659231e-04,
   8.3372775443144032e-04, 6.0643258121975913e-04, 7.0039848968711364e-04,
   1.2381529956170115e-03, 1.4703871152100261e-03, 8.9702000483341665e-04,
   3.0498186875911964e-03, 5.8008510370760203e-03, 1.2387025901401758e-03,
   1.2334264856852042e-03, 1.5352527520022995e-02, 7.3889079577318679e-04,
   1.5819841076161790e-03, 1.4517880681388670e-03, 8.8872966327839206e-04,
   3.9057132596179516e-03, 2.9949355095799514e-03},
  {2.2367690269707355e-03, 1.1291633722052721e-03, 1.0780835837505738e-03,
   1.4911089792375384e-03, 3.6775301298071699e-04, 1.0716022846036992e-03,
   1.9357892959573676e-03, 1.8725532583338258e-03, 5.8791282749163360e-04,
   1.3390359572833434e-03, 1.7339408813938210e-03, 1.8070838729286381e-03,
   5.4319510273222540e-04, 7.3889079577318679e-04, 1.7056411057608904e-02,
   1.8468214541146135e-03, 1.6196921560667427e-03, 2.3541955953234630e-04,
   6.4111850267928403e-04, 1.5531163167895289e-03},
  {6.2077372467778114e-03, 2.5480707779992882e-03, 3.1777703084905646e-03,
   2.8168184837142236e-03, 1.1014893301583900e-03, 2.2199500917807818e-03,
   2.9614835299989701e-03, 4.3892726706643180e-03, 1.2089586814863836e-03,
   2.0791955470136677e-03, 2.9030148705129709e-03, 3.0739875836290694e-03,
   9.8962843407290630e-04, 1.5819841076161790e-03, 1.8468214541146135e-03,
   1.1119087492164673e-02, 4.7130010640939217e-03, 3.1984588103465904e-04,
   1.2969411223575139e-03, 2.9238790831836834e-03},
  {3.9182728585714704e-03, 2.0755623893205866e-03, 2.5607235691682607e-03,
   2.2443557004503045e-03, 9.6593119839638185e-04, 1.4976248429072652e-03,
   2.4465955340418752e-03, 2.4867404596474229e-03, 8.5349236685497410e-04,
   2.9182353019045755e-03, 3.8403853123581615e-03, 2.5875240617244397e-03,
   1.1386579188117374e-03, 1.4517880681388670e-03, 1.6196921560667427e-03,
   4.7130010640939217e-03, 9.9511225720898735e-03, 3.6462369214353146e-04,
   1.2243502023766173e-03, 4.0630285182107874e-03},
  {4.8631739510959277e-04, 3.8597740102525838e-04, 2.2470939491808472e-04,
   2.1629521399451062e-04, 9.5473415415687051e-05, 3.4211307677156259e-04,
   4.2400226067181517e-04, 5.1106914401047939e-04, 1.6088475111162087e-04,
   4.5881135439627285e-04, 7.8809411669902049e-04, 3.6617320485888769e-04,
   2.5453642381012927e-04, 8.8872966327839206e-04, 2.3541955953234630e-04,
   3.1984588103465904e-04, 3.6462369214353146e-04, 5.8917653327232667e-03,
   8.1035438644761436e-04, 4.8135675107584730e-04},
  {1.5289255743243066e-03, 1.2968650803478032e-03, 9.0102455753719311e-04,
   8.6838200454238037e-04, 4.0265275985100583e-04, 8.6801232355735846e-04,
   1.2320532047293646e-03, 1.1558215242534139e-03, 1.2994388028749182e-03,
   1.7726237165460320e-03, 2.7481481703784771e-03, 1.2944286682925433e-03,
   7.4966082446689317e-04, 3.9057132596179516e-03, 6.4111850267928403e-04,
   1.2969411223575139e-03, 1.2243502023766173e-03, 8.1035438644761436e-04,
   7.7325651605433090e-03, 1.7646048865917325e-03},
  {5.4421693501580945e-03, 1.9767324973351923e-03, 1.4642269583191670e-03,
   1.6071086977600263e-03, 1.3071530803028910e-03, 1.4099696811263587e-03,
   1.9587224017250621e-03, 2.1542687026690753e-03, 7.4034388655116329e-04,
   1.0732172589653342e-02, 9.1689424893657400e-03, 2.1916787299081464e-03,
   2.1431247883570799e-03, 2.9949355095799514e-03, 1.5531163167895289e-03,
   2.9238790831836834e-03, 4.0630285182107874e-03, 4.8135675107584730e-04,
   1.7646048865917325e-03, 1.6356187478795130e-02}};

/** Background frequencies for BLOSUM50 */
static double
BLOSUM50_bg[COMPO_NUM_TRUE_AA] =
{7.6539470498057649e-02, 5.3250385307217402e-02, 4.3637061980733187e-02,
 5.1393635127596211e-02, 2.2316032400410832e-02, 3.4923218698747475e-02,
 5.6445304260661695e-02, 7.3850907051359951e-02, 2.4711032253042223e-02,
 6.4065361639403171e-02, 9.5587467619348249e-02, 5.7876000358301254e-02,
 2.4385897213061735e-02, 4.8098159196680347e-02, 4.0885461298433984e-02,
 5.9478937760864596e-02, 5.2921707787277797e-02, 1.3706552419028580e-02,
 3.3493684732315711e-02, 7.2433722397458003e-02};


/** Joint probabilities for BLOSUM62 */
static double
BLOSUM62_JOINT_PROBS[COMPO_NUM_TRUE_AA][COMPO_NUM_TRUE_AA] =
{
  {2.1497573378347484e-02, 2.3470224274721213e-03, 1.9493235258876179e-03,
   2.1674844853066858e-03, 1.5903351423026848e-03, 1.9242657898716525e-03,
   2.9879059292799641e-03, 5.8158526388051033e-03, 1.1076584657559144e-03,
   3.1880644746334580e-03, 4.4186245468471547e-03, 3.3466571942021082e-03,
   1.3412107617355408e-03, 1.6360627863999076e-03, 2.1568959784943114e-03,
   6.2524987419815400e-03, 3.7180506975672363e-03, 4.0281679108936688e-04,
   1.2999956675626666e-03, 5.0679056444508912e-03},
  {2.3470224274721213e-03, 1.7757465118386322e-02, 1.9786027128591904e-03,
   1.5865480081162602e-03, 3.9365984789376245e-04, 2.4858611089731411e-03,
   2.6933867548771758e-03, 1.7221140903704937e-03, 1.2407382229440791e-03,
   1.2435878276496955e-03, 2.4193952633248727e-03, 6.2339060289407083e-03,
   8.0309461712520876e-04, 9.3181986323789834e-04, 9.5783034332718700e-04,
   2.2660898636037261e-03, 1.7802796534180537e-03, 2.6571979312581875e-04,
   9.2634607111251918e-04, 1.5810185245264004e-03},
  {1.9493235258876179e-03, 1.9786027128591904e-03, 1.4140291972553610e-02,
   3.7201973506001745e-03, 4.3845466068066216e-04, 1.5304436972610567e-03,
   2.2097156829738759e-03, 2.8591871815612977e-03, 1.4301072616183181e-03,
   9.9437221166923172e-04, 1.3690958423974782e-03, 2.4402105140841090e-03,
   5.2943633069226512e-04, 7.5004227978192801e-04, 8.6016459857770028e-04,
   3.1466019144814608e-03, 2.2360795375444384e-03, 1.6159545671597605e-04,
   7.0048422794024819e-04, 1.2014015528772706e-03},
  {2.1674844853066858e-03, 1.5865480081162602e-03, 3.7201973506001745e-03,
   2.1274574617480089e-02, 3.9909227141697264e-04, 1.6481246723433428e-03,
   4.9158017471929655e-03, 2.5221102126636373e-03, 9.5384849402143984e-04,
   1.2347404942429857e-03, 1.5202051791453383e-03, 2.4453087721980561e-03,
   4.6429229320514104e-04, 7.6023722413111566e-04, 1.2373315413524663e-03,
   2.8035127901697272e-03, 1.8961512776990257e-03, 1.6218020183662784e-04,
   5.9842263937853702e-04, 1.3158365660538270e-03},
  {1.5903351423026848e-03, 3.9365984789376245e-04, 4.3845466068066216e-04,
   3.9909227141697264e-04, 1.1931352277704348e-02, 3.0937204045913537e-04,
   3.8338775043186374e-04, 7.6951976030099293e-04, 2.2976387481074697e-04,
   1.0956590131781735e-03, 1.5682982157153873e-03, 5.0124929379033781e-04,
   3.7717165634097634e-04, 5.1389991547056834e-04, 3.6111795849154795e-04,
   1.0432626586831986e-03, 9.3041313726939057e-04, 1.4474923964368156e-04,
   3.4603772624580643e-04, 1.3606607271146112e-03},
  {1.9242657898716525e-03, 2.4858611089731411e-03, 1.5304436972610567e-03,
   1.6481246723433428e-03, 3.0937204045913537e-04, 7.3292255467189687e-03,
   3.5385780499965817e-03, 1.3683038039160171e-03, 1.0489026828741754e-03,
   8.9102936026571569e-04, 1.6174411456311808e-03, 3.0968229715707327e-03,
   7.3993258722701268e-04, 5.4255147972143906e-04, 8.4668181752066874e-04,
   1.8931125300036275e-03, 1.3796838284921874e-03, 2.2737931366728891e-04,
   6.7584155312457842e-04, 1.1660966117775285e-03},
  {2.9879059292799641e-03, 2.6933867548771758e-03, 2.2097156829738759e-03,
   4.9158017471929655e-03, 3.8338775043186374e-04, 3.5385780499965817e-03,
   1.6133927472163669e-02, 1.9380952488713059e-03, 1.3667885452189439e-03,
   1.2192061706431622e-03, 2.0030316026648431e-03, 4.1322603720305197e-03,
   6.7909745467514783e-04, 8.5179405867513139e-04, 1.4216207127018586e-03,
   2.9539180653600089e-03, 2.0493063257644955e-03, 2.6488552587183780e-04,
   8.7044186256788659e-04, 1.6987763526262680e-03},
  {5.8158526388051033e-03, 1.7221140903704937e-03, 2.8591871815612977e-03,
   2.5221102126636373e-03, 7.6951976030099293e-04, 1.3683038039160171e-03,
   1.9380952488713059e-03, 3.7804346453413303e-02, 9.5813607255887238e-04,
   1.3849118546156933e-03, 2.0864716056392773e-03, 2.5392537741810947e-03,
   7.3281559749652399e-04, 1.1976708695723554e-03, 1.3641171883713547e-03,
   3.8342830901664762e-03, 2.1858459940987062e-03, 4.0740829083805248e-04,
   8.3467413018106177e-04, 1.8218235950233687e-03},
  {1.1076584657559144e-03, 1.2407382229440791e-03, 1.4301072616183181e-03,
   9.5384849402143984e-04, 2.2976387481074697e-04, 1.0489026828741754e-03,
   1.3667885452189439e-03, 9.5813607255887238e-04, 9.2802502369336622e-03,
   5.8089627083019206e-04, 9.8696608463236094e-04, 1.1873625842258938e-03,
   3.8264639620910225e-04, 8.1041076335565583e-04, 4.7770135861914477e-04,
   1.1052034635193162e-03, 7.4371746073077327e-04, 1.5168037757411286e-04,
   1.5213771111755425e-03, 6.4882907765797669e-04},
  {3.1880644746334580e-03, 1.2435878276496955e-03, 9.9437221166923172e-04,
   1.2347404942429857e-03, 1.0956590131781735e-03, 8.9102936026571569e-04,
   1.2192061706431622e-03, 1.3849118546156933e-03, 5.8089627083019206e-04,
   1.8441526588740136e-02, 1.1382470627796603e-02, 1.5655862274689192e-03,
   2.5081290988482057e-03, 3.0458868657559346e-03, 1.0068164685944146e-03,
   1.7225081689171561e-03, 2.6953622613315018e-03, 3.6183761166072852e-04,
   1.3821121844492116e-03, 1.1972663837662637e-02},
  {4.4186245468471547e-03, 2.4193952633248727e-03, 1.3690958423974782e-03,
   1.5202051791453383e-03, 1.5682982157153873e-03, 1.6174411456311808e-03,
   2.0030316026648431e-03, 2.0864716056392773e-03, 9.8696608463236094e-04,
   1.1382470627796603e-02, 3.7141460156350926e-02, 2.4634345023228079e-03,
   4.9293545515183088e-03, 5.4151301166464015e-03, 1.4146090399381900e-03,
   2.4277107072013821e-03, 3.3238031308707055e-03, 7.3206640617832933e-04,
   2.2096734692836624e-03, 9.4786263030457313e-03},
  {3.3466571942021082e-03, 6.2339060289407083e-03, 2.4402105140841090e-03,
   2.4453087721980561e-03, 5.0124929379033781e-04, 3.0968229715707327e-03,
   4.1322603720305197e-03, 2.5392537741810947e-03, 1.1873625842258938e-03,
   1.5655862274689192e-03, 2.4634345023228079e-03, 1.6113385590544604e-02,
   9.0876633395557617e-04, 9.4875149773685364e-04, 1.5773020912564391e-03,
   3.1016069999481111e-03, 2.3467014804084987e-03, 2.7198500003555514e-04,
   9.9908866586876396e-04, 1.9360424083099779e-03},
  {1.3412107617355408e-03, 8.0309461712520876e-04, 5.2943633069226512e-04,
   4.6429229320514104e-04, 3.7717165634097634e-04, 7.3993258722701268e-04,
   6.7909745467514783e-04, 7.3281559749652399e-04, 3.8264639620910225e-04,
   2.5081290988482057e-03, 4.9293545515183088e-03, 9.0876633395557617e-04,
   4.0477309321969848e-03, 1.1901770463553603e-03, 4.0824445213456919e-04,
   8.5603787638552766e-04, 1.0095451907679563e-03, 1.9872537223131380e-04,
   5.7145288352831449e-04, 2.3123361470140736e-03},
  {1.6360627863999076e-03, 9.3181986323789834e-04, 7.5004227978192801e-04,
   7.6023722413111566e-04, 5.1389991547056834e-04, 5.4255147972143906e-04,
   8.5179405867513139e-04, 1.1976708695723554e-03, 8.1041076335565583e-04,
   3.0458868657559346e-03, 5.4151301166464015e-03, 9.4875149773685364e-04,
   1.1901770463553603e-03, 1.8277684015431908e-02, 5.2528021756783813e-04,
   1.1939618185901600e-03, 1.1624184369750680e-03, 8.4917468952377874e-04,
   4.2392005745634370e-03, 2.5763052227920180e-03},
  {2.1568959784943114e-03, 9.5783034332718700e-04, 8.6016459857770028e-04,
   1.2373315413524663e-03, 3.6111795849154795e-04, 8.4668181752066874e-04,
   1.4216207127018586e-03, 1.3641171883713547e-03, 4.7770135861914477e-04,
   1.0068164685944146e-03, 1.4146090399381900e-03, 1.5773020912564391e-03,
   4.0824445213456919e-04, 5.2528021756783813e-04, 1.9066033679132538e-02,
   1.6662567934883051e-03, 1.3511005665728870e-03, 1.4152209821874487e-04,
   4.5224391125285910e-04, 1.2451325046931832e-03},
  {6.2524987419815400e-03, 2.2660898636037261e-03, 3.1466019144814608e-03,
   2.8035127901697272e-03, 1.0432626586831986e-03, 1.8931125300036275e-03,
   2.9539180653600089e-03, 3.8342830901664762e-03, 1.1052034635193162e-03,
   1.7225081689171561e-03, 2.4277107072013821e-03, 3.1016069999481111e-03,
   8.5603787638552766e-04, 1.1939618185901600e-03, 1.6662567934883051e-03,
   1.2585947097159817e-02, 4.7004857686835334e-03, 2.8731729176487776e-04,
   1.0299846310599138e-03, 2.3587292053265561e-03},
  {3.7180506975672363e-03, 1.7802796534180537e-03, 2.2360795375444384e-03,
   1.8961512776990257e-03, 9.3041313726939057e-04, 1.3796838284921874e-03,
   2.0493063257644955e-03, 2.1858459940987062e-03, 7.4371746073077327e-04,
   2.6953622613315018e-03, 3.3238031308707055e-03, 2.3467014804084987e-03,
   1.0095451907679563e-03, 1.1624184369750680e-03, 1.3511005665728870e-03,
   4.7004857686835334e-03, 1.2514818886617953e-02, 2.8575770858467209e-04,
   9.4161039895612720e-04, 3.6402328079338207e-03},
  {4.0281679108936688e-04, 2.6571979312581875e-04, 1.6159545671597605e-04,
   1.6218020183662784e-04, 1.4474923964368156e-04, 2.2737931366728891e-04,
   2.6488552587183780e-04, 4.0740829083805248e-04, 1.5168037757411286e-04,
   3.6183761166072852e-04, 7.3206640617832933e-04, 2.7198500003555514e-04,
   1.9872537223131380e-04, 8.4917468952377874e-04, 1.4152209821874487e-04,
   2.8731729176487776e-04, 2.8575770858467209e-04, 6.4699301717154852e-03,
   8.8744160259272527e-04, 3.5578318710317554e-04},
  {1.2999956675626666e-03, 9.2634607111251918e-04, 7.0048422794024819e-04,
   5.9842263937853702e-04, 3.4603772624580643e-04, 6.7584155312457842e-04,
   8.7044186256788659e-04, 8.3467413018106177e-04, 1.5213771111755425e-03,
   1.3821121844492116e-03, 2.2096734692836624e-03, 9.9908866586876396e-04,
   5.7145288352831449e-04, 4.2392005745634370e-03, 4.5224391125285910e-04,
   1.0299846310599138e-03, 9.4161039895612720e-04, 8.8744160259272527e-04,
   1.0246100213822419e-02, 1.5489827890922993e-03},
  {5.0679056444508912e-03, 1.5810185245264004e-03, 1.2014015528772706e-03,
   1.3158365660538270e-03, 1.3606607271146112e-03, 1.1660966117775285e-03,
   1.6987763526262680e-03, 1.8218235950233687e-03, 6.4882907765797669e-04,
   1.1972663837662637e-02, 9.4786263030457313e-03, 1.9360424083099779e-03,
   2.3123361470140736e-03, 2.5763052227920180e-03, 1.2451325046931832e-03,
   2.3587292053265561e-03, 3.6402328079338207e-03, 3.5578318710317554e-04,
   1.5489827890922993e-03, 1.9631915140537640e-02}};

/** Background frequencies for BLOSUM62 */
static double
BLOSUM62_bg[COMPO_NUM_TRUE_AA] =
{7.4216205067993410e-02, 5.1614486141284638e-02, 4.4645808512757915e-02,
 5.3626000838554413e-02, 2.4687457167944848e-02, 3.4259650591416023e-02,
 5.4311925684587502e-02, 7.4146941452644999e-02, 2.6212984805266227e-02,
 6.7917367618953756e-02, 9.8907868497150955e-02, 5.8155682303079680e-02,
 2.4990197579643110e-02, 4.7418459742284751e-02, 3.8538003320306206e-02,
 5.7229029476494421e-02, 5.0891364550287033e-02, 1.3029956129972148e-02,
 3.2281512313758580e-02, 7.2919098205619245e-02};


/** Joint probabilities for BLOSUM80 */
static double
BLOSUM80_JOINT_PROBS[COMPO_NUM_TRUE_AA][COMPO_NUM_TRUE_AA] =
{
  {2.5190801261944146e-02, 2.0340063576029794e-03, 1.5934450456787860e-03,
   1.7567882204091898e-03, 1.5342531535382758e-03, 1.7000666571091031e-03,
   2.7868757423594017e-03, 5.3312141672192219e-03, 9.4989551434358397e-04,
   2.6511420856442343e-03, 3.6482390472164553e-03, 2.8776040054767438e-03,
   1.1106592033970583e-03, 1.3579821676123010e-03, 2.1407549535065536e-03,
   6.3814552201747433e-03, 3.5676984041129148e-03, 3.2555946863964375e-04,
   1.1044305938818220e-03, 4.6043558088638440e-03},
  {2.0340063576029794e-03, 2.0957619284835711e-02, 1.6758487367421928e-03,
   1.2888167784480715e-03, 3.3826512646630144e-04, 2.3643445818728338e-03,
   2.2882006533010476e-03, 1.4590947777562337e-03, 1.1860735000568496e-03,
   1.0137588625981279e-03, 1.8206526954490602e-03, 6.0560763047425702e-03,
   6.2337540140620625e-04, 6.8229547250252861e-04, 8.5854176274829876e-04,
   2.0042877649097124e-03, 1.5124193439838248e-03, 2.1495826193954981e-04,
   7.3405490506437917e-04, 1.3053875072860433e-03},
  {1.5934450456787860e-03, 1.6758487367421928e-03, 1.6571102507116985e-02,
   3.6538256029687933e-03, 3.7275314562150083e-04, 1.3857458787672526e-03,
   1.9028611939066358e-03, 2.5087252791082940e-03, 1.2287120285654496e-03,
   7.4457563298143141e-04, 1.0685540535108611e-03, 2.2109484306704398e-03,
   4.0104114114639772e-04, 5.5233725060967317e-04, 6.5378230775305264e-04,
   2.8681766931253736e-03, 1.9573168921473445e-03, 1.3788261408849363e-04,
   5.7618561566013431e-04, 9.3483242504674316e-04},
  {1.7567882204091898e-03, 1.2888167784480715e-03, 3.6538256029687933e-03,
   2.6192308612565114e-02, 3.3106691118318270e-04, 1.3768335120404338e-03,
   4.7855109048933571e-03, 2.2232114513351937e-03, 8.1024112807968755e-04,
   7.7107432004201270e-04, 1.0524113745173926e-03, 1.9891158615195038e-03,
   3.3025592590943029e-04, 5.9228818844263222e-04, 9.2722402594094192e-04,
   2.3761553355682980e-03, 1.6423964465390574e-03, 1.1250313032631603e-04,
   4.5827153005301055e-04, 9.6057858837385150e-04},
  {1.5342531535382758e-03, 3.3826512646630144e-04, 3.7275314562150083e-04,
   3.3106691118318270e-04, 1.7242275829262476e-02, 2.8646474074708189e-04,
   2.8282275916935814e-04, 6.0199758435290119e-04, 1.6234838273827443e-04,
   1.1265997431595498e-03, 1.4150540356314203e-03, 3.8133934535800398e-04,
   3.5227309589971249e-04, 5.3668272671786679e-04, 2.9686417147468063e-04,
   9.5169015207393563e-04, 8.7056289887733830e-04, 1.2638354788184329e-04,
   3.0970164723884082e-04, 1.3402441983659027e-03},
  {1.7000666571091031e-03, 2.3643445818728338e-03, 1.3857458787672526e-03,
   1.3768335120404338e-03, 2.8646474074708189e-04, 9.4347765835274943e-03,
   3.4983547675341785e-03, 1.0949548858705770e-03, 1.1246735029182945e-03,
   6.9825772263661188e-04, 1.3621164757556699e-03, 2.8087671852638188e-03,
   7.2881923779495811e-04, 4.5182331847654853e-04, 6.9151715980429068e-04,
   1.6537440549432947e-03, 1.2213788117405877e-03, 1.9879174677422644e-04,
   5.4136767114461271e-04, 1.0117238998697397e-03},
  {2.7868757423594017e-03, 2.2882006533010476e-03, 1.9028611939066358e-03,
   4.7855109048933571e-03, 2.8282275916935814e-04, 3.4983547675341785e-03,
   2.0820161672110919e-02, 1.6705768658803739e-03, 1.2497919872780897e-03,
   9.6840513155216357e-04, 1.4960914225340589e-03, 3.5721908719380593e-03,
   5.7149419172049785e-04, 6.3988473796368903e-04, 1.2122196186289647e-03,
   2.6389347134212079e-03, 1.8749387967046983e-03, 1.9036380224872525e-04,
   6.3290036404780182e-04, 1.4751061012869160e-03},
  {5.3312141672192219e-03, 1.4590947777562337e-03, 2.5087252791082940e-03,
   2.2232114513351937e-03, 6.0199758435290119e-04, 1.0949548858705770e-03,
   1.6705768658803739e-03, 4.6339669111671353e-02, 7.5449961042330647e-04,
   9.4996724611759150e-04, 1.6066592192185663e-03, 2.0310505314366269e-03,
   5.3609624387219209e-04, 8.9864424405597940e-04, 1.0176342727297918e-03,
   3.4421697217907042e-03, 1.8920241991862482e-03, 2.9373791998702517e-04,
   6.1327956332154923e-04, 1.4084342214988788e-03},
  {9.4989551434358397e-04, 1.1860735000568496e-03, 1.2287120285654496e-03,
   8.1024112807968755e-04, 1.6234838273827443e-04, 1.1246735029182945e-03,
   1.2497919872780897e-03, 7.5449961042330647e-04, 1.0381617825381334e-02,
   4.4036371570812095e-04, 7.9508382719793930e-04, 1.0307766502203480e-03,
   2.6842308809614442e-04, 6.8472295590456679e-04, 4.0762982846324675e-04,
   9.6226821486916257e-04, 6.8751986685796880e-04, 1.4371608217276840e-04,
   1.6115232208711219e-03, 5.3755732656986873e-04},
  {2.6511420856442343e-03, 1.0137588625981279e-03, 7.4457563298143141e-04,
   7.7107432004201270e-04, 1.1265997431595498e-03, 6.9825772263661188e-04,
   9.6840513155216357e-04, 9.4996724611759150e-04, 4.4036371570812095e-04,
   2.1961426293375986e-02, 1.1130703369690390e-02, 1.1532712305851239e-03,
   2.4830606782385335e-03, 2.6597759616518901e-03, 7.3360010098323712e-04,
   1.4571406164888326e-03, 2.3588073239766052e-03, 3.3397592349852914e-04,
   1.2624333898651637e-03, 1.2271122820238527e-02},
  {3.6482390472164553e-03, 1.8206526954490602e-03, 1.0685540535108611e-03,
   1.0524113745173926e-03, 1.4150540356314203e-03, 1.3621164757556699e-03,
   1.4960914225340589e-03, 1.6066592192185663e-03, 7.9508382719793930e-04,
   1.1130703369690390e-02, 4.4208543625750947e-02, 1.9460828295282577e-03,
   5.1637253946183711e-03, 5.2243696624605148e-03, 1.1528201208432873e-03,
   2.0991567569779157e-03, 2.7981964830167271e-03, 6.3277768036502599e-04,
   2.0134515231625665e-03, 8.8913964764739482e-03},
  {2.8776040054767438e-03, 6.0560763047425702e-03, 2.2109484306704398e-03,
   1.9891158615195038e-03, 3.8133934535800398e-04, 2.8087671852638188e-03,
   3.5721908719380593e-03, 2.0310505314366269e-03, 1.0307766502203480e-03,
   1.1532712305851239e-03, 1.9460828295282577e-03, 1.8992311051287718e-02,
   7.1570376147636942e-04, 7.2977429729635017e-04, 1.2494764855845110e-03,
   2.5724600423967150e-03, 2.0209702186968510e-03, 1.9168209136920497e-04,
   7.8006357431686252e-04, 1.4847749228956784e-03},
  {1.1106592033970583e-03, 6.2337540140620625e-04, 4.0104114114639772e-04,
   3.3025592590943029e-04, 3.5227309589971249e-04, 7.2881923779495811e-04,
   5.7149419172049785e-04, 5.3609624387219209e-04, 2.6842308809614442e-04,
   2.4830606782385335e-03, 5.1637253946183711e-03, 7.1570376147636942e-04,
   5.3068580972096564e-03, 1.0285774291964053e-03, 3.3805426284931307e-04,
   6.9732452132326552e-04, 9.2870717652810894e-04, 1.9855470215781828e-04,
   4.6842552580683944e-04, 2.1900560317616967e-03},
  {1.3579821676123010e-03, 6.8229547250252861e-04, 5.5233725060967317e-04,
   5.9228818844263222e-04, 5.3668272671786679e-04, 4.5182331847654853e-04,
   6.3988473796368903e-04, 8.9864424405597940e-04, 6.8472295590456679e-04,
   2.6597759616518901e-03, 5.2243696624605148e-03, 7.2977429729635017e-04,
   1.0285774291964053e-03, 2.1050081047094053e-02, 4.2695305789420819e-04,
   9.9526342159352650e-04, 1.0513746746114907e-03, 7.4360162788489814e-04,
   4.5643669065202081e-03, 2.2374943285650862e-03},
  {2.1407549535065536e-03, 8.5854176274829876e-04, 6.5378230775305264e-04,
   9.2722402594094192e-04, 2.9686417147468063e-04, 6.9151715980429068e-04,
   1.2122196186289647e-03, 1.0176342727297918e-03, 4.0762982846324675e-04,
   7.3360010098323712e-04, 1.1528201208432873e-03, 1.2494764855845110e-03,
   3.3805426284931307e-04, 4.2695305789420819e-04, 2.2132147568842062e-02,
   1.4255613382498733e-03, 1.0735194808918437e-03, 9.8582208625861730e-05,
   3.4299989987846913e-04, 1.0356422797820938e-03},
  {6.3814552201747433e-03, 2.0042877649097124e-03, 2.8681766931253736e-03,
   2.3761553355682980e-03, 9.5169015207393563e-04, 1.6537440549432947e-03,
   2.6389347134212079e-03, 3.4421697217907042e-03, 9.6226821486916257e-04,
   1.4571406164888326e-03, 2.0991567569779157e-03, 2.5724600423967150e-03,
   6.9732452132326552e-04, 9.9526342159352650e-04, 1.4255613382498733e-03,
   1.6728326838562371e-02, 4.7707748874885403e-03, 2.2457429196472549e-04,
   9.2159836957901727e-04, 2.0684030169239110e-03},
  {3.5676984041129148e-03, 1.5124193439838248e-03, 1.9573168921473445e-03,
   1.6423964465390574e-03, 8.7056289887733830e-04, 1.2213788117405877e-03,
   1.8749387967046983e-03, 1.8920241991862482e-03, 6.8751986685796880e-04,
   2.3588073239766052e-03, 2.7981964830167271e-03, 2.0209702186968510e-03,
   9.2870717652810894e-04, 1.0513746746114907e-03, 1.0735194808918437e-03,
   4.7707748874885403e-03, 1.5594999664688735e-02, 2.0707952088013908e-04,
   8.2888908190237710e-04, 3.2712773918631040e-03},
  {3.2555946863964375e-04, 2.1495826193954981e-04, 1.3788261408849363e-04,
   1.1250313032631603e-04, 1.2638354788184329e-04, 1.9879174677422644e-04,
   1.9036380224872525e-04, 2.9373791998702517e-04, 1.4371608217276840e-04,
   3.3397592349852914e-04, 6.3277768036502599e-04, 1.9168209136920497e-04,
   1.9855470215781828e-04, 7.4360162788489814e-04, 9.8582208625861730e-05,
   2.2457429196472549e-04, 2.0707952088013908e-04, 8.7238920952867408e-03,
   1.0281252180987448e-03, 3.6291275126003661e-04},
  {1.1044305938818220e-03, 7.3405490506437917e-04, 5.7618561566013431e-04,
   4.5827153005301055e-04, 3.0970164723884082e-04, 5.4136767114461271e-04,
   6.3290036404780182e-04, 6.1327956332154923e-04, 1.6115232208711219e-03,
   1.2624333898651637e-03, 2.0134515231625665e-03, 7.8006357431686252e-04,
   4.6842552580683944e-04, 4.5643669065202081e-03, 3.4299989987846913e-04,
   9.2159836957901727e-04, 8.2888908190237710e-04, 1.0281252180987448e-03,
   1.4809695895202394e-02, 1.2479627747244684e-03},
  {4.6043558088638440e-03, 1.3053875072860433e-03, 9.3483242504674316e-04,
   9.6057858837385150e-04, 1.3402441983659027e-03, 1.0117238998697397e-03,
   1.4751061012869160e-03, 1.4084342214988788e-03, 5.3755732656986873e-04,
   1.2271122820238527e-02, 8.8913964764739482e-03, 1.4847749228956784e-03,
   2.1900560317616967e-03, 2.2374943285650862e-03, 1.0356422797820938e-03,
   2.0684030169239110e-03, 3.2712773918631040e-03, 3.6291275126003661e-04,
   1.2479627747244684e-03, 2.4557979462295820e-02}};

/** Background frequencies for BLOSUM80 */
static double
BLOSUM80_bg[COMPO_NUM_TRUE_AA] =
{7.2647227078731003e-02, 5.0418078079712533e-02, 4.2998652475215837e-02,
 5.3630877849155469e-02, 2.8859643195758448e-02, 3.3634522394591609e-02,
 5.4557686298480158e-02, 7.6673641116832586e-02, 2.5417438256716121e-02,
 6.7169462169032662e-02, 9.9526086073919384e-02, 5.4794439692059750e-02,
 2.4441485110408976e-02, 4.7108293477054419e-02, 3.8215524905474578e-02,
 5.7239465972425123e-02, 5.0130851564694504e-02, 1.4489654685450317e-02,
 3.4849727270340386e-02, 7.3197242333946158e-02};


/** Joint probabilities for BLOSUM90 */
static double
BLOSUM90_JOINT_PROBS[COMPO_NUM_TRUE_AA][COMPO_NUM_TRUE_AA] =
{
  {2.8941466476520718e-02, 1.8963172918503119e-03, 1.4296539454877236e-03,
   1.6120541525071418e-03, 1.4378045557717186e-03, 1.5518753295389346e-03,
   2.6715149842246304e-03, 4.9176944070822995e-03, 8.3429471034916194e-04,
   2.2806166994472367e-03, 3.1400426239163565e-03, 2.5717145234657262e-03,
   9.7190459199705012e-04, 1.1707482997247202e-03, 1.9972723941546994e-03,
   6.1234827650497045e-03, 3.4990592936902896e-03, 3.1628263576966828e-04,
   9.5781456962094815e-04, 4.2309560726043610e-03},
  {1.8963172918503119e-03, 2.2892163644406403e-02, 1.4545259958564671e-03,
   1.1118856442462741e-03, 3.0043550945087249e-04, 2.0799816656266574e-03,
   1.9867845182036542e-03, 1.2814494483589008e-03, 1.0659803319010067e-03,
   8.7747376727426759e-04, 1.5563382766215293e-03, 5.6726070720652388e-03,
   5.5601248568691477e-04, 6.0014287440373390e-04, 7.7860213318230740e-04,
   1.7926007027022699e-03, 1.3337993839260983e-03, 1.8822355540425045e-04,
   6.3568077704304765e-04, 1.1439035919666126e-03},
  {1.4296539454877236e-03, 1.4545259958564671e-03, 1.7753653137209658e-02,
   3.4122251157479486e-03, 3.5262434817793110e-04, 1.2595133876871906e-03,
   1.7189800468094042e-03, 2.1939494568804173e-03, 1.1268322842671913e-03,
   6.2771773800865524e-04, 9.0162895039764071e-04, 1.9751605656395136e-03,
   3.4437514139917542e-04, 4.5695294787233016e-04, 5.6210182826678802e-04,
   2.6415583911000790e-03, 1.8096241176560255e-03, 1.1361193219385239e-04,
   5.3166878528705414e-04, 7.8744578895086331e-04},
  {1.6120541525071418e-03, 1.1118856442462741e-03, 3.4122251157479486e-03,
   2.8905985529761216e-02, 2.8205144393017687e-04, 1.2470706135571605e-03,
   4.8098591474193932e-03, 2.0787428065125128e-03, 7.3570523495442291e-04,
   6.1360733950558593e-04, 8.9746213145538078e-04, 1.7935339070485811e-03,
   2.8515554540729039e-04, 4.9706948686116547e-04, 8.3650620447870902e-04,
   2.1902661040309438e-03, 1.4770487412630099e-03, 9.6154148977656466e-05,
   4.1238640135342840e-04, 8.1983005205147035e-04},
  {1.4378045557717186e-03, 3.0043550945087249e-04, 3.5262434817793110e-04,
   2.8205144393017687e-04, 1.8963924833314688e-02, 2.4062393656260663e-04,
   2.4018396300677406e-04, 5.1191591124580998e-04, 1.4262451141854431e-04,
   1.0187249201952210e-03, 1.2204913461061227e-03, 3.4081454298601579e-04,
   3.0855994042178013e-04, 5.4061743869703049e-04, 2.6341296370767072e-04,
   9.0081780182465609e-04, 8.3760722742725604e-04, 1.1402385673074935e-04,
   3.0875531409262481e-04, 1.2790175783090351e-03},
  {1.5518753295389346e-03, 2.0799816656266574e-03, 1.2595133876871906e-03,
   1.2470706135571605e-03, 2.4062393656260663e-04, 1.1258473852655668e-02,
   3.3929068022966746e-03, 1.0135072388571143e-03, 1.0428112436817220e-03,
   6.2154432511249121e-04, 1.2200582014470405e-03, 2.6612615004061048e-03,
   6.9614541817054399e-04, 4.3847028249800182e-04, 6.3169039064483155e-04,
   1.5347331351459369e-03, 1.1633090191045159e-03, 1.8118969468635933e-04,
   4.8090269093961543e-04, 8.6038475380201306e-04},
  {2.6715149842246304e-03, 1.9867845182036542e-03, 1.7189800468094042e-03,
   4.8098591474193932e-03, 2.4018396300677406e-04, 3.3929068022966746e-03,
   2.4082550387620767e-02, 1.5173914448105995e-03, 1.0609424122148584e-03,
   8.6556272233095357e-04, 1.2693446983220930e-03, 3.1728712431242272e-03,
   4.8675933771578960e-04, 5.2592632830518644e-04, 1.1283633992741310e-03,
   2.4358395159902540e-03, 1.7460695145653721e-03, 1.7186658965667723e-04,
   5.3762929629223334e-04, 1.3537458445130380e-03},
  {4.9176944070822995e-03, 1.2814494483589008e-03, 2.1939494568804173e-03,
   2.0787428065125128e-03, 5.1191591124580998e-04, 1.0135072388571143e-03,
   1.5173914448105995e-03, 5.2105577140795424e-02, 6.6116372972342219e-04,
   7.9279793619671047e-04, 1.4084669216931525e-03, 1.8091800840455807e-03,
   4.5905141534639837e-04, 7.2640563736237702e-04, 9.1606958049118977e-04,
   3.2250721573096343e-03, 1.6376154647606311e-03, 2.8505580568873712e-04,
   5.3377971995623207e-04, 1.1777891482397749e-03},
  {8.3429471034916194e-04, 1.0659803319010067e-03, 1.1268322842671913e-03,
   7.3570523495442291e-04, 1.4262451141854431e-04, 1.0428112436817220e-03,
   1.0609424122148584e-03, 6.6116372972342219e-04, 1.1500733945516558e-02,
   3.8185691425617459e-04, 6.9827301155994540e-04, 9.0371184948679912e-04,
   2.4699125636645672e-04, 5.9147458541551113e-04, 3.8444740537595942e-04,
   8.5932297611334600e-04, 6.0598617290751988e-04, 1.4705149603278306e-04,
   1.4431522344877262e-03, 4.5696999458730438e-04},
  {2.2806166994472367e-03, 8.7747376727426759e-04, 6.2771773800865524e-04,
   6.1360733950558593e-04, 1.0187249201952210e-03, 6.2154432511249121e-04,
   8.6556272233095357e-04, 7.9279793619671047e-04, 3.8185691425617459e-04,
   2.4545975084797667e-02, 1.0187721075530867e-02, 1.0015355309232945e-03,
   2.3855654456497641e-03, 2.3760161494061206e-03, 6.6596344099825570e-04,
   1.2754928334842836e-03, 2.1146482135048364e-03, 2.8885067061466341e-04,
   1.1275668044226116e-03, 1.2010991497586472e-02},
  {3.1400426239163565e-03, 1.5563382766215293e-03, 9.0162895039764071e-04,
   8.9746213145538078e-04, 1.2204913461061227e-03, 1.2200582014470405e-03,
   1.2693446983220930e-03, 1.4084669216931525e-03, 6.9827301155994540e-04,
   1.0187721075530867e-02, 4.7314665506091480e-02, 1.6493087064879096e-03,
   4.9150964217477052e-03, 4.7389371254676835e-03, 1.0204208998598171e-03,
   1.9093387711173759e-03, 2.5387072113370619e-03, 5.5567682513643440e-04,
   1.7591338828767365e-03, 8.0719383241327648e-03},
  {2.5717145234657262e-03, 5.6726070720652388e-03, 1.9751605656395136e-03,
   1.7935339070485811e-03, 3.4081454298601579e-04, 2.6612615004061048e-03,
   3.1728712431242272e-03, 1.8091800840455807e-03, 9.0371184948679912e-04,
   1.0015355309232945e-03, 1.6493087064879096e-03, 2.1110006225715187e-02,
   6.5644301788968489e-04, 6.8011754565553524e-04, 1.1433484348853926e-03,
   2.2696044144588988e-03, 1.8742456882945837e-03, 1.4351856033992664e-04,
   6.5878172544710722e-04, 1.2879210940900179e-03},
  {9.7190459199705012e-04, 5.5601248568691477e-04, 3.4437514139917542e-04,
   2.8515554540729039e-04, 3.0855994042178013e-04, 6.9614541817054399e-04,
   4.8675933771578960e-04, 4.5905141534639837e-04, 2.4699125636645672e-04,
   2.3855654456497641e-03, 4.9150964217477052e-03, 6.5644301788968489e-04,
   6.7525741637165784e-03, 9.2071349348378116e-04, 2.9821836819244002e-04,
   6.2250823423415716e-04, 8.5497291624530018e-04, 1.8480270544289832e-04,
   4.1789997362558619e-04, 2.0390401916086623e-03},
  {1.1707482997247202e-03, 6.0014287440373390e-04, 4.5695294787233016e-04,
   4.9706948686116547e-04, 5.4061743869703049e-04, 4.3847028249800182e-04,
   5.2592632830518644e-04, 7.2640563736237702e-04, 5.9147458541551113e-04,
   2.3760161494061206e-03, 4.7389371254676835e-03, 6.8011754565553524e-04,
   9.2071349348378116e-04, 2.2759929778368840e-02, 3.8203945097730409e-04,
   9.0070409285055049e-04, 9.3733303528124379e-04, 7.0215975437974915e-04,
   4.5967694652672827e-03, 1.9728777259904423e-03},
  {1.9972723941546994e-03, 7.7860213318230740e-04, 5.6210182826678802e-04,
   8.3650620447870902e-04, 2.6341296370767072e-04, 6.3169039064483155e-04,
   1.1283633992741310e-03, 9.1606958049118977e-04, 3.8444740537595942e-04,
   6.6596344099825570e-04, 1.0204208998598171e-03, 1.1433484348853926e-03,
   2.9821836819244002e-04, 3.8203945097730409e-04, 2.4044365492630580e-02,
   1.3333728667143045e-03, 9.5861529112551574e-04, 1.0367126137135345e-04,
   2.9369391163915916e-04, 9.1754627765824664e-04},
  {6.1234827650497045e-03, 1.7926007027022699e-03, 2.6415583911000790e-03,
   2.1902661040309438e-03, 9.0081780182465609e-04, 1.5347331351459369e-03,
   2.4358395159902540e-03, 3.2250721573096343e-03, 8.5932297611334600e-04,
   1.2754928334842836e-03, 1.9093387711173759e-03, 2.2696044144588988e-03,
   6.2250823423415716e-04, 9.0070409285055049e-04, 1.3333728667143045e-03,
   2.0222291957641345e-02, 4.8820444720790194e-03, 2.0564914018856946e-04,
   8.5252084753556067e-04, 1.9182160488867347e-03},
  {3.4990592936902896e-03, 1.3337993839260983e-03, 1.8096241176560255e-03,
   1.4770487412630099e-03, 8.3760722742725604e-04, 1.1633090191045159e-03,
   1.7460695145653721e-03, 1.6376154647606311e-03, 6.0598617290751988e-04,
   2.1146482135048364e-03, 2.5387072113370619e-03, 1.8742456882945837e-03,
   8.5497291624530018e-04, 9.3733303528124379e-04, 9.5861529112551574e-04,
   4.8820444720790194e-03, 1.9324325014986026e-02, 1.8008131088087498e-04,
   7.7364223266285920e-04, 3.0481291734621883e-03},
  {3.1628263576966828e-04, 1.8822355540425045e-04, 1.1361193219385239e-04,
   9.6154148977656466e-05, 1.1402385673074935e-04, 1.8118969468635933e-04,
   1.7186658965667723e-04, 2.8505580568873712e-04, 1.4705149603278306e-04,
   2.8885067061466341e-04, 5.5567682513643440e-04, 1.4351856033992664e-04,
   1.8480270544289832e-04, 7.0215975437974915e-04, 1.0367126137135345e-04,
   2.0564914018856946e-04, 1.8008131088087498e-04, 1.0080756092360078e-02,
   9.7237191290610822e-04, 3.3849359263814259e-04},
  {9.5781456962094815e-04, 6.3568077704304765e-04, 5.3166878528705414e-04,
   4.1238640135342840e-04, 3.0875531409262481e-04, 4.8090269093961543e-04,
   5.3762929629223334e-04, 5.3377971995623207e-04, 1.4431522344877262e-03,
   1.1275668044226116e-03, 1.7591338828767365e-03, 6.5878172544710722e-04,
   4.1789997362558619e-04, 4.5967694652672827e-03, 2.9369391163915916e-04,
   8.5252084753556067e-04, 7.7364223266285920e-04, 9.7237191290610822e-04,
   1.7299655473877330e-02, 1.0599282277832859e-03},
  {4.2309560726043610e-03, 1.1439035919666126e-03, 7.8744578895086331e-04,
   8.1983005205147035e-04, 1.2790175783090351e-03, 8.6038475380201306e-04,
   1.3537458445130380e-03, 1.1777891482397749e-03, 4.5696999458730438e-04,
   1.2010991497586472e-02, 8.0719383241327648e-03, 1.2879210940900179e-03,
   2.0390401916086623e-03, 1.9728777259904423e-03, 9.1754627765824664e-04,
   1.9182160488867347e-03, 3.0481291734621883e-03, 3.3849359263814259e-04,
   1.0599282277832859e-03, 2.8697002670368957e-02}};

/** Background frequencies for BLOSUM90 */
static double
BLOSUM90_bg[COMPO_NUM_TRUE_AA] =
{7.2552570322773416e-02, 4.9204908670176822e-02, 4.1453803904895913e-02,
 5.4114599751069477e-02, 2.9605031943377283e-02, 3.3576453482421185e-02,
 5.5175092196696710e-02, 7.9252675455356913e-02, 2.4890326300616415e-02,
 6.6060229109246138e-02, 9.6973050911305106e-02, 5.3375686232455331e-02,
 2.4402790064347962e-02, 4.6515405498268582e-02, 3.8659721995628657e-02,
 5.8095437228457614e-02, 5.1596863495160232e-02, 1.5369491541399532e-02,
 3.5653734247116535e-02, 7.3472127649230390e-02};


/** Joint probabilities for PAM30 */
static double
PAM30_JOINT_PROBS[COMPO_NUM_TRUE_AA][COMPO_NUM_TRUE_AA] =
 {{5.9127862863721750e-02, 3.2440617583107150e-04, 1.0035948537871118e-03,
   1.2937780781087705e-03, 3.1489279641407921e-04, 7.8441912163105827e-04,
   1.9549529250776384e-03, 4.4450251531015341e-03, 2.4408725427943890e-04,
   6.3834489749891460e-04, 8.5734131065316949e-04, 6.6918206045722564e-04,
   2.4336882332168805e-04, 1.9674190702492523e-04, 2.6202109954734016e-03,
   5.3063364114300593e-03, 4.2185820078273640e-03, 8.9313247015175431e-06,
   1.8225239557427070e-04, 2.6924704657184727e-03},
  {3.2440625639271051e-04, 3.1662312740551507e-02, 2.3762842136823239e-04,
   5.6563675457002573e-05, 9.3129950876164492e-05, 9.1528080790490170e-04,
   8.6839504539746909e-05, 1.4407450273547440e-04, 8.0713228381439951e-04,
   2.3918928110028528e-04, 1.8565911094615257e-04, 3.6581387738112881e-03,
   1.4663896005519465e-04, 6.8103245279497473e-05, 5.5932428391757959e-04,
   1.0092109476925932e-03, 2.5480707850980300e-04, 2.2193552472724070e-04,
   3.6904523509655450e-05, 1.9661465321769547e-04},
  {1.0035949818459219e-03, 2.3762839267802783e-04, 2.3942409270820499e-02,
   3.3284158741927953e-03, 3.2538337794438945e-05, 4.6226927209257570e-04,
   9.2846515645887944e-04, 1.2584258426750054e-03, 1.5206559005068105e-03,
   2.6711587971252001e-04, 3.0916527975103871e-04, 2.2688805610242180e-03,
   2.7842659555092249e-05, 8.1379441035189023e-05, 2.9181029943650455e-04,
   2.7347996638868496e-03, 1.2577242264992243e-03, 2.6993425091658113e-05,
   2.6944441574580028e-04, 1.8273083830275347e-04},
  {1.2937796115259778e-03, 5.6563728450851038e-05, 3.3284193944054766e-03,
   3.1273778918948607e-02, 1.2103230229512947e-05, 7.6617399615253165e-04,
   5.4382382099205833e-03, 1.3553904178722684e-03, 4.2748391837969444e-04,
   1.3808195847558340e-04, 5.5405194612472888e-05, 8.2915098268285519e-04,
   1.5837656185859654e-05, 1.2183220889666176e-05, 1.6175213970633581e-04,
   9.3274740356798572e-04, 5.4799577728014499e-04, 2.6698359970959505e-06,
   2.7630450603653458e-05, 1.9652461563925079e-04},
  {3.1489301842875517e-04, 9.3129993409788155e-05, 3.2538356583645619e-05,
   1.2103224417840982e-05, 3.0911976128033203e-02, 1.0422897597447210e-05,
   1.3045154369605740e-05, 1.2331326460389934e-04, 8.7403575975685877e-05,
   1.4700814322947319e-04, 1.7204986642330695e-05, 2.0967487089801047e-05,
   4.6716519905272028e-06, 1.5450629356458807e-05, 1.0731930798383835e-04,
   8.8294538241145862e-04, 1.3276614614802094e-04, 1.6423540619552711e-06,
   2.5794038216114085e-04, 2.8675545440947622e-04},
  {7.8442026053622907e-04, 9.1528190951214539e-04, 4.6226988427979871e-04,
   7.6617420047916506e-04, 1.0422905381892655e-05, 2.6544608117209920e-02,
   2.8557379250805240e-03, 3.2014453056257132e-04, 1.7486259957461992e-03,
   9.9252608465405899e-05, 6.0406011721609947e-04, 1.1831024953318150e-03,
   1.5335884816741112e-04, 1.7100074791269734e-05, 7.2911029927467225e-04,
   4.4648214805162705e-04, 3.3667257155475816e-04, 4.8464750161981381e-06,
   1.9368742918264150e-05, 2.5436870827426616e-04},
  {1.9549529628814029e-03, 8.6839484653654394e-05, 9.2846505594076944e-04,
   5.4382318695576064e-03, 1.3045145424406014e-05, 2.8557338340375444e-03,
   3.3517674281234727e-02, 1.0164440607605047e-03, 3.0223134392623171e-04,
   2.7356351213294998e-04, 1.8090367242305680e-04, 9.0138014877581916e-04,
   6.7560140115700316e-05, 1.5496070696064205e-05, 3.8539027331336147e-04,
   7.7702876541165054e-04, 3.7793620670777345e-04, 1.6817745257277018e-06,
   8.3785842893895291e-05, 3.5213844751594915e-04},
  {4.4450264882197844e-03, 1.4407451023118595e-04, 1.2584260600834638e-03,
   1.3553892185403055e-03, 1.2331321470077254e-04, 3.2014416190175385e-04,
   1.0164443464066211e-03, 7.3132033374173233e-02, 1.4265564703375892e-04,
   7.8900319516912176e-05, 2.1034389241846268e-04, 6.1289539990328260e-04,
   7.4245508122981575e-05, 1.5674243592432135e-04, 5.4766624172258220e-04,
   3.4088075308296227e-03, 7.0070531496088532e-04, 5.2853879414167534e-06,
   2.4544008994090104e-05, 8.5444874892186512e-04},
  {2.4408747666216802e-04, 8.0713281873562922e-04, 1.5206570919081967e-03,
   4.2748380118705500e-04, 8.7403593983465336e-05, 1.7486250500378976e-03,
   3.0223161343842714e-04, 1.4265573415588517e-04, 2.5912749202426651e-02,
   5.4172565365417882e-05, 3.5367914479392303e-04, 3.2368241604722851e-04,
   1.3814985420558011e-05, 1.7593672709173279e-04, 4.2250627292314536e-04,
   3.0759148688999991e-04, 1.6958028160260233e-04, 2.8647099817736987e-05,
   3.2560358371766935e-04, 2.5015800928442289e-04},
  {6.3834543898650818e-04, 2.3918942459763868e-04, 2.6711607221435220e-04,
   1.3808191194806317e-04, 1.4700816428390960e-04, 9.9252548552557522e-05,
   2.7356373889812253e-04, 7.8900362746834598e-05, 5.4172561962801172e-05,
   2.5353273968724142e-02, 2.0257496745425718e-03, 3.7763776643433608e-04,
   4.3126472052569851e-04, 6.9390953826520903e-04, 9.9551436064317802e-05,
   2.4863355885143155e-04, 9.5951687923165980e-04, 3.5757659371011922e-06,
   1.3084280226689410e-04, 4.6260158615996951e-03},
  {8.5734216622389682e-04, 1.8565925011601762e-04, 3.0916554882827251e-04,
   5.5405184235674211e-05, 1.7204991681432948e-05, 6.0405984298879671e-04,
   1.8090384945491092e-04, 2.1034403914852010e-04, 3.5367917551304054e-04,
   2.0257499777296402e-03, 7.3000310742808883e-02, 4.1727416412467352e-04,
   1.5642414643133032e-03, 1.4111440516777498e-03, 3.9148168115718263e-04,
   3.4625433736015543e-04, 5.1411260792961144e-04, 1.1411949340511684e-04,
   2.4268828302089347e-04, 2.5562620951092522e-03},
  {6.6918224697453115e-04, 3.6581388849769524e-03, 2.2688809039069346e-03,
   8.2915023105839081e-04, 2.0967478150861513e-05, 1.1831011073361103e-03,
   9.0138038258199616e-04, 6.1289538664142224e-04, 3.2368221136537637e-04,
   3.7763755135328410e-04, 4.1727386401701669e-04, 6.4693890572988549e-02,
   6.6794441059427187e-04, 2.7382745563202352e-05, 4.3433181415562853e-04,
   1.4551175703028975e-03, 1.5845624716654210e-03, 1.4791630665655615e-05,
   1.0031582707837053e-04, 2.4096479208088586e-04},
  {2.4336830797378565e-04, 1.4663861312290421e-04, 2.7842597043892707e-05,
   1.5837603877571481e-05, 4.6716388042956611e-06, 1.5335830075866933e-04,
   6.7559995746664195e-05, 7.4245328603217111e-05, 1.3814943580005304e-05,
   4.3126344147009457e-04, 1.5642365909332011e-03, 6.6794281001051204e-04,
   1.0141213540776236e-02, 1.4660191537561271e-04, 4.8450904597765942e-05,
   1.6515648186201659e-04, 2.2685467249223466e-04, 2.0008335180823801e-06,
   9.3883208445999985e-06, 6.0233921928444826e-04},
  {1.9674179753644555e-04, 6.8103190467030313e-05, 8.1379385362846500e-05,
   1.2183199669779923e-05, 1.5450609864628809e-05, 1.7100040447235946e-05,
   1.5496061772720164e-05, 1.5674230161638646e-04, 1.7593646888951426e-04,
   6.9390856347840014e-04, 1.4111418581369839e-03, 2.7382722692250166e-05,
   1.4660214422917438e-04, 3.3861009362003459e-02, 7.1900578552569946e-05,
   3.1517751745356056e-04, 1.1969184927520245e-04, 8.8987451147384282e-05,
   2.1252266178783314e-03, 1.7152666956162511e-04},
  {2.6202130340908561e-03, 5.5932458019152063e-04, 2.9181048924025891e-04,
   1.6175207384277283e-04, 1.0731931581676484e-04, 7.2910980794736594e-04,
   3.8539056570825416e-04, 5.4766650332801537e-04, 4.2250621671160218e-04,
   9.9551429072581362e-05, 3.9148159507076420e-04, 4.3433203102235152e-04,
   4.8451044892253097e-05, 7.1900674507093529e-05, 4.0604191219076186e-02,
   2.0119344286096612e-03, 7.1263018070872024e-04, 4.7982384817113614e-06,
   1.4865650507525918e-05, 4.6067074370365708e-04},
  {5.3063371565052241e-03, 1.0092108387751812e-03, 2.7347996989257640e-03,
   9.3274642902351293e-04, 8.8294488386897788e-04, 4.4648156249264251e-04,
   7.7702885949034416e-04, 3.4088069855909850e-03, 3.0759124983976847e-04,
   2.4863338285489411e-04, 3.4625404043958478e-04, 1.4551173690427952e-03,
   1.6515685478145134e-04, 3.1517773710736395e-04, 2.0119331457544728e-03,
   4.3704325124611566e-02, 4.6622818964331446e-03, 1.3084533331101311e-04,
   2.0094937156893428e-04, 5.3046875602754697e-04},
  {4.2185814745877639e-03, 2.5480698302386028e-04, 1.2577239070339487e-03,
   5.4799505851501598e-04, 1.3276603575955228e-04, 3.3667204018132072e-04,
   3.7793615162735276e-04, 7.0070501592452118e-04, 1.6958010566637581e-04,
   9.5951594401952529e-04, 5.1411202989417335e-04, 1.5845618297167597e-03,
   2.2685512419638769e-04, 1.1969190075536674e-04, 7.1262953617928142e-04,
   4.6622806524669611e-03, 4.0080522152696731e-02, 7.7221709693801107e-06,
   1.9614245987267017e-04, 1.4808860227188284e-03},
  {8.9313110716676174e-06, 2.2193513092309819e-04, 2.6993380453373426e-05,
   2.6698287583864801e-06, 1.6423503976671419e-06, 4.8464605835057328e-06,
   1.6817719266965285e-06, 5.2853782880023220e-06, 2.8647030000480363e-05,
   3.5757574470218971e-06, 1.1411920536695850e-04, 1.4791603969773761e-05,
   2.0008347015511914e-06, 8.8987364868269231e-05, 4.7982274260592832e-06,
   1.3084511525926471e-04, 7.7221601608874346e-06, 9.7663617388477827e-03,
   5.4428794026537278e-05, 3.4341487746871944e-06},
  {1.8225259518093309e-04, 3.6904554763547977e-05, 2.6944467646583038e-04,
   2.7630448116826589e-05, 2.5794048280234434e-04, 1.9368736009677512e-05,
   8.3785933037710527e-05, 2.4544028503103365e-05, 3.2560364367498684e-04,
   1.3084283457888838e-04, 2.4268830663110646e-04, 1.0031590898589505e-04,
   9.3883510072762204e-06, 2.1252301281792273e-03, 1.4865655222690358e-05,
   2.0094956343711816e-04, 1.9614269948496426e-04, 5.4428936700607963e-05,
   2.5458063946254550e-02, 1.5581068017848029e-04},
  {2.6924718379743948e-03, 1.9661470459870104e-04, 1.8273090811764459e-04,
   1.9652448287522901e-04, 2.8675539838203063e-04, 2.5436846859703643e-04,
   3.5213862017886860e-04, 8.5444892775954253e-04, 2.5015790886744131e-04,
   4.6260142952143542e-03, 2.5562608469629879e-03, 2.4096484772926421e-04,
   6.0234080176754519e-04, 1.7152685243873109e-04, 4.6067062007291694e-04,
   5.3046895190411193e-04, 1.4808869646613962e-03, 3.4341557657210555e-06,
   1.5581058894257387e-04, 4.8623004597917380e-02}};


/** Background frequencies for PAM30 */
static double
PAM30_bg[COMPO_NUM_TRUE_AA] =
 {8.7126791287320884e-02, 4.0903895909610417e-02, 4.0432295956770413e-02,
  4.6871895312810476e-02, 3.3473496652650342e-02, 3.8255396174460388e-02,
  4.9530495046950500e-02, 8.8612091138790899e-02, 3.3618396638160339e-02,
  3.6885596311440373e-02, 8.5357391464260871e-02, 8.0481591951840806e-02,
  1.4752798524720149e-02, 3.9771696022830406e-02, 5.0679894932010514e-02,
  6.9577093042290705e-02, 5.8541694145830589e-02, 1.0493698950630105e-02,
  2.9916197008380305e-02, 6.4717593528240649e-02};


/** Joint probabilities for PAM70 */
static double
PAM70_JOINT_PROBS[COMPO_NUM_TRUE_AA][COMPO_NUM_TRUE_AA] =
 {{3.7194213979637188e-02, 8.0875439041628162e-04, 2.0736469390750011e-03,
   2.5255574182717466e-03, 7.0597599855019377e-04, 1.5518860331053537e-03,
   3.3281208097698071e-03, 7.8361925097053062e-03, 6.4846786136231796e-04,
   1.3965775400569750e-03, 1.8572697436319116e-03, 1.7482551307042979e-03,
   4.8307795351259125e-04, 4.6722222625635783e-04, 4.5500298325667470e-03,
   8.1815629183182841e-03, 6.7687993083932032e-03, 3.9553489619550231e-05,
   4.0198008739913299e-04, 4.5596291188838671e-03},
  {8.0875459125887960e-04, 2.2852260562000497e-02, 6.3934652653652158e-04,
   2.6565503238024069e-04, 2.0716323236539814e-04, 1.6017401609837373e-03,
   3.6247978737909017e-04, 4.4251317578674839e-04, 1.4545988362152228e-03,
   4.5486167022679277e-04, 4.7958344964645923e-04, 6.3755226966969213e-03,
   2.9453091937721063e-04, 1.6164688923471510e-04, 1.0920146534074944e-03,
   1.7360748480776255e-03, 6.7924411792817890e-04, 4.2527565397331162e-04,
   1.0517163263837040e-04, 4.6545498435095661e-04},
  {2.0736472036725706e-03, 6.3934644934464965e-04, 1.2675264036707688e-02,
   4.5473226968005516e-03, 1.3072650858229394e-04, 9.8476826157552883e-04,
   1.9319288980112796e-03, 2.3638341090397520e-03, 2.2789353943294508e-03,
   4.8031891742590351e-04, 6.3784139623980268e-04, 3.6406446637760638e-03,
   1.0839923046261430e-04, 2.1124529418782895e-04, 7.0593618583735755e-04,
   3.8434309157785534e-03, 2.1278276917432622e-03, 5.8506124017367067e-05,
   4.7128160280842448e-04, 5.2108080024919573e-04},
  {2.5255604116237503e-03, 2.6565528126934506e-04, 4.5473275061584054e-03,
   1.9552325499801158e-02, 6.2308430323130455e-05, 1.6541819396931764e-03,
   7.7926328404944083e-03, 2.6556443995349685e-03, 9.4505551957847214e-04,
   3.3373196162398263e-04, 2.5428729781597079e-04, 1.8252267172093658e-03,
   7.1571476837320696e-05, 6.2699777515621009e-05, 5.0522957134973721e-04,
   1.9557932466435428e-03, 1.2131336358778791e-03, 1.2993535244829728e-05,
   1.1201257788170061e-04, 5.2454942122686396e-04},
  {7.0597649629747271e-04, 2.0716332697946015e-04, 1.3072658407008939e-04,
   6.2308400404162504e-05, 2.7825132406096721e-02, 5.0435659858616025e-05,
   6.4183040241265688e-05, 3.4312218587591266e-04, 1.8549288536969907e-04,
   3.0428050604195967e-04, 8.6271949826973639e-05, 1.0319775933269199e-04,
   2.1845951231463184e-05, 7.3006061082583895e-05, 2.6943279346136302e-04,
   1.5492279059838264e-03, 3.6530370920314899e-04, 7.8068244609312760e-06,
   5.2405318773371238e-04, 5.9453098084831513e-04},
  {1.5518882863026272e-03, 1.6017420887949061e-03, 9.8476956571271401e-04,
   1.6541823808376536e-03, 5.0435697526993665e-05, 1.6787085074471908e-02,
   4.2787762571323820e-03, 8.0400668885757354e-04, 2.8143687940436037e-03,
   2.6711575407853416e-04, 1.1454473327119955e-03, 2.2219193740971904e-03,
   2.7431121090624501e-04, 7.9884995435096083e-05, 1.3266379692078094e-03,
   9.9419732760188556e-04, 7.3752958783346258e-04, 2.2068073516731896e-05,
   8.4534852301957012e-05, 5.7451783130914617e-04},
  {3.3281208741271096e-03, 3.6247970437186164e-04, 1.9319286888555126e-03,
   7.7926237551769187e-03, 6.4182996230279074e-05, 4.2787701274881254e-03,
   2.1230233172577155e-02, 2.1586930929646795e-03, 7.9951579869397792e-04,
   5.1816988481241319e-04, 4.9671301373542802e-04, 1.8583369945629901e-03,
   1.5522285531686052e-04, 7.5329104750829724e-05, 8.7224571048074477e-04,
   1.6494400773568857e-03, 9.8039738823928256e-04, 9.8627195086499729e-06,
   1.7654001016405600e-04, 7.9166996712079214e-04},
  {7.8361948634025867e-03, 4.4251319880921986e-04, 2.3638345174210110e-03,
   2.6556420496591168e-03, 3.4312204701923726e-04, 8.0400576300773013e-04,
   2.1586936996112463e-03, 5.7388214125128879e-02, 4.3236776435400643e-04,
   3.4974458161973841e-04, 6.1249796226038361e-04, 1.4966554127348864e-03,
   1.8860864984772765e-04, 3.5290462647837592e-04, 1.3849762195287689e-03,
   5.9445759562363016e-03, 1.9215796101274300e-03, 2.5013179874909793e-05,
   1.1604668058941842e-04, 1.7949008032212017e-03},
  {6.4846845216765588e-04, 1.4545998002403436e-03, 2.2789371798266084e-03,
   9.4505526049609202e-04, 1.8549292358684214e-04, 2.8143672719502912e-03,
   7.9951651165529876e-04, 4.3236802840803962e-04, 1.8560531281184581e-02,
   1.7329795245024201e-04, 7.4342959350709480e-04, 9.0662738551551753e-04,
   6.0703834193089745e-05, 3.6980078137131069e-04, 8.3973746322991798e-04,
   7.6422403314936290e-04, 4.5318332597887379e-04, 6.5639763909263862e-05,
   6.1489301130310497e-04, 5.0752802593494563e-04},
  {1.3965787247291086e-03, 4.5486194311295853e-04, 4.8031926357631490e-04,
   3.3373184917105415e-04, 3.0428054962086925e-04, 2.6711559283677013e-04,
   5.1817031433929882e-04, 3.4974477324673338e-04, 1.7329794156527634e-04,
   1.5987190915936728e-02, 3.7542085623002365e-03, 7.9047703500744913e-04,
   7.4501214528508515e-04, 1.2410425750079218e-03, 2.9830737151792058e-04,
   6.5095642836554904e-04, 1.6435023166340176e-03, 1.6913609007343374e-05,
   3.0951408922659339e-04, 7.1703808113526201e-03},
  {1.8572715970660166e-03, 4.7958380914168481e-04, 6.3784195137522653e-04,
   2.5428725019068746e-04, 8.6271975094832692e-05, 1.1454468127092281e-03,
   4.9671349981746592e-04, 6.1249838952195121e-04, 7.4342965807833552e-04,
   3.7542091241798722e-03, 5.9951495785846971e-02, 1.0493782343261593e-03,
   2.6814650215840857e-03, 2.7966611740865397e-03, 8.5989574098836426e-04,
   8.8237132503272053e-04, 1.2009026817844726e-03, 2.3930695397514544e-04,
   6.1025445693481276e-04, 5.0181285348802392e-03},
  {1.7482556179854968e-03, 6.3755228904400392e-03, 3.6406452139655073e-03,
   1.8252250626433326e-03, 1.0319771533702729e-04, 2.2219167673792092e-03,
   1.8583374765912097e-03, 1.4966553803501838e-03, 9.0662681220611530e-04,
   7.9047658479656612e-04, 1.0493774796030771e-03, 4.9293845076036368e-02,
   1.1255133298832300e-03, 1.3216286783222650e-04, 1.0446562953732232e-03,
   2.9144044140370015e-03, 2.9220738476920570e-03, 6.6880818037768001e-05,
   2.4262817005053197e-04, 7.2318935725630609e-04},
  {4.8307693056640386e-04, 2.9453022254816570e-04, 1.0839898708909919e-04,
   7.1571240452505207e-05, 2.1845889568956700e-05, 2.7431023176251363e-04,
   1.5522252362166317e-04, 1.8860819380693471e-04, 6.0703650343313840e-05,
   7.4500993570958776e-04, 2.6814566675041188e-03, 1.1255106328349001e-03,
   6.2216215868039163e-03, 2.9832472629374757e-04, 1.3153445291663897e-04,
   3.2741431363028059e-04, 4.2984045752512929e-04, 9.2547680468922969e-06,
   4.2944731619579882e-05, 1.0815954826533252e-03},
  {4.6722196624336877e-04, 1.6164675913423647e-04, 2.1124514967319201e-04,
   6.2699668309512132e-05, 7.3005968981369192e-05, 7.9884834992933367e-05,
   7.5329061372896589e-05, 3.5290432408488991e-04, 3.6980023865698528e-04,
   1.2410408316222718e-03, 2.7966568268405693e-03, 1.3216275744553708e-04,
   2.9832519199486722e-04, 2.7609483738988472e-02, 1.7973863393164530e-04,
   5.9661755563524910e-04, 3.2037483659612474e-04, 1.8874402507141542e-04,
   4.0197906703935112e-03, 5.3500764220074115e-04},
  {4.5500333726519711e-03, 1.0920152318473985e-03, 7.0593664500325599e-04,
   5.0522936562621599e-04, 2.6943281312648466e-04, 1.3266370752230991e-03,
   8.7224637225196376e-04, 1.3849768810946577e-03, 8.3973735150864534e-04,
   2.9830735056707742e-04, 8.5989555189817642e-04, 1.0446568169817727e-03,
   1.3153483378793056e-04, 1.7973887380085544e-04, 3.0491153217065619e-02,
   3.4531406676076783e-03, 1.5743619172343265e-03, 2.2239752852310588e-05,
   7.0790589659118386e-05, 1.0078398187708918e-03},
  {8.1815640671107619e-03, 1.7360746607146360e-03, 3.8434309650215181e-03,
   1.9557912032098206e-03, 1.5492270312344489e-03, 9.9419602371732946e-04,
   1.6494402770627079e-03, 5.9445750054015955e-03, 7.6422344418805707e-04,
   6.5095596758270877e-04, 8.8237056838025741e-04, 2.9144040109401357e-03,
   3.2741505292406683e-04, 5.9661797143050106e-04, 3.4531384658065887e-03,
   2.5194630962788844e-02, 6.9036327495644529e-03, 2.3646278999217072e-04,
   4.3310745892383997e-04, 1.3658284657506725e-03},
  {6.7687984527995898e-03, 6.7924386338946957e-04, 2.1278271512694068e-03,
   1.2131320447011020e-03, 3.6530340547122483e-04, 7.3752842378368402e-04,
   9.8039724535617292e-04, 1.9215787900648919e-03, 4.5318285581003373e-04,
   1.6435007147619267e-03, 1.2009013315660629e-03, 2.9220726638817442e-03,
   4.2984131340663987e-04, 3.2037497439121534e-04, 1.5743604933224141e-03,
   6.9036309075725119e-03, 2.5145087525408925e-02, 3.3504787857693503e-05,
   3.9901526220181702e-04, 2.7223972158291975e-03},
  {3.9553429258053418e-05, 4.2527489936084253e-04, 5.8506027267398882e-05,
   1.2993500015539712e-05, 7.8068070429731971e-06, 2.2068007798510738e-05,
   9.8627042667045989e-06, 2.5013134189977265e-05, 6.5639603935365286e-05,
   1.6913568848707673e-05, 2.3930634996322564e-04, 6.6880697331508018e-05,
   9.2547735209755892e-06, 1.8874384207182113e-04, 2.2239701609553311e-05,
   2.3646239593054483e-04, 3.3504740962039998e-05, 8.8773115204672983e-03,
   1.1825547568164276e-04, 1.8104738675545398e-05},
  {4.0198052765619123e-04, 1.0517172170666313e-04, 4.7128205883032164e-04,
   1.1201256780021866e-04, 5.2405339220477280e-04, 8.4534822149439932e-05,
   1.7654020010055970e-04, 1.1604677283010455e-04, 6.1489312453077570e-04,
   3.0951416566195940e-04, 6.1025451630413027e-04, 2.4262836815559043e-04,
   4.2944869591860184e-05, 4.0197973100029871e-03, 7.0790612112846255e-05,
   4.3310787245855718e-04, 3.9901574964835166e-04, 1.1825578566444501e-04,
   2.0713250517413805e-02, 3.5013214847729346e-04},
  {4.5596314427637933e-03, 4.6545510598759347e-04, 5.2108099933545666e-04,
   5.2454906686265053e-04, 5.9453086468643705e-04, 5.7451728997352694e-04,
   7.9167035529779668e-04, 1.7949011788972052e-03, 5.0752782220598030e-04,
   7.1703783834363042e-03, 5.0181260846782830e-03, 7.2318952426956380e-04,
   1.0815983242524012e-03, 5.3500821261145081e-04, 1.0078395482957540e-03,
   1.3658289700853483e-03, 2.7223989474559310e-03, 1.8104775532085235e-05,
   3.5013194345525083e-04, 3.4391127379248571e-02}};


/** Background frequencies for PAM70 */
static double
PAM70_bg[COMPO_NUM_TRUE_AA] =
 {8.7126791287320884e-02, 4.0903895909610417e-02, 4.0432295956770413e-02,
  4.6871895312810476e-02, 3.3473496652650342e-02, 3.8255396174460388e-02,
  4.9530495046950500e-02, 8.8612091138790899e-02, 3.3618396638160339e-02,
  3.6885596311440373e-02, 8.5357391464260871e-02, 8.0481591951840806e-02,
  1.4752798524720149e-02, 3.9771696022830406e-02, 5.0679894932010514e-02,
  6.9577093042290705e-02, 5.8541694145830589e-02, 1.0493698950630105e-02,
  2.9916197008380305e-02, 6.4717593528240649e-02};


/** Joint probabilities for PAM250 */
static double
PAM250_JOINT_PROBS[COMPO_NUM_TRUE_AA][COMPO_NUM_TRUE_AA] =
 {{1.1506400163397348e-02, 2.4975234370346938e-03, 3.6632356257684483e-03,
   4.3697529887018680e-03, 1.8276936642056354e-03, 3.0112834228006877e-03,
   4.6380076446533598e-03, 1.0339527732503804e-02, 2.1445960136039590e-03,
   2.8561276927260783e-03, 4.8067870006386869e-03, 5.3728660720934662e-03,
   9.9019202445208682e-04, 1.5464765991005901e-03, 5.7141437172462672e-03,
   7.8179791493075794e-03, 6.7187163178886273e-03, 2.4101371353564736e-04,
   1.1721091682281690e-03, 5.8923276896711702e-03},
  {2.4975240572589555e-03, 6.8223559926665856e-03, 1.6533156765452324e-03,
   1.4242714502197024e-03, 5.8944495295708494e-04, 2.0890653455874143e-03,
   1.5846268605901504e-03, 2.0115938216399487e-03, 1.9669325055291509e-03,
   9.4903529635187336e-04, 1.7492440279578930e-03, 7.1821284724483221e-03,
   5.4580032563258029e-04, 5.8362016915488137e-04, 1.9905170420007937e-03,
   2.6418803499780995e-03, 1.9640573941509198e-03, 7.0871248744948259e-04,
   4.6349501962238691e-04, 1.4862704239743234e-03},
  {3.6632360931977024e-03, 1.6533154769312107e-03, 2.5955854984510566e-03,
   3.0517570739433363e-03, 5.8568281632154781e-04, 1.8510854058951462e-03,
   2.7895286937787943e-03, 3.8931584083915696e-03, 1.9571954869209009e-03,
   9.8420566009110736e-04, 1.7794204465884568e-03, 4.0932237358558650e-03,
   3.9994385816140271e-04, 7.1880179172375874e-04, 1.8301969957746043e-03,
   3.2997078736071352e-03, 2.6196455994558056e-03, 1.6728089758110551e-04,
   7.5085679377667974e-04, 1.7484565247768355e-03},
  {4.3697581678392664e-03, 1.4242727846030287e-03, 3.0517603015550198e-03,
   5.3450741866183605e-03, 4.8131568254674531e-04, 2.6206746906300110e-03,
   5.1008829021988921e-03, 4.7650883231047875e-03, 1.8490504755097694e-03,
   1.0026056203705611e-03, 1.5930780447867654e-03, 3.8473027689656289e-03,
   3.7899525831382413e-04, 5.1061988544348147e-04, 1.9136201963833961e-03,
   3.4857855940197829e-03, 2.6547057326437146e-03, 1.0462465427285877e-04,
   5.1745915800129137e-04, 1.8552565803737606e-03},
  {1.8276949528182092e-03, 5.8944522216403236e-04, 5.8568315452307319e-04,
   4.8131545143085251e-04, 1.7511419053161906e-02, 3.7076087859994690e-04,
   4.8903954809427258e-04, 1.3623490426844370e-03, 5.0846358870165352e-04,
   7.2550858666646089e-04, 7.0799189746061336e-04, 7.7075179336004939e-04,
   1.4785610255510653e-04, 4.9388019913530691e-04, 8.9473565620589346e-04,
   2.3049501350228350e-03, 1.1784726301114091e-03, 5.9299164676445897e-05,
   1.0798142518323606e-03, 1.3840707684770947e-03},
  {3.0112877949101447e-03, 2.0890678599300048e-03, 1.8510878573036722e-03,
   2.6206753895230044e-03, 3.7076115550642192e-04, 3.7185224258066509e-03,
   3.3568240743867832e-03, 2.5676678443522830e-03, 2.5232370501328569e-03,
   8.8236852679010299e-04, 2.1731378008959393e-03, 3.6449766430915512e-03,
   4.4907863861830282e-04, 5.2205080225212230e-04, 2.0463942511170581e-03,
   2.3688709930341769e-03, 1.8654207898517394e-03, 1.3455340214135793e-04,
   4.5154480646782813e-04, 1.6079054659636366e-03},
  {4.6380077343405046e-03, 1.5846264977134096e-03, 2.7895283917769896e-03,
   5.1008769551535707e-03, 4.8903921275470451e-04, 3.3568192655030788e-03,
   5.9222989867882461e-03, 4.5816396632919884e-03, 1.9402988224346133e-03,
   1.1442977954316837e-03, 1.9598693853120769e-03, 3.9374862382598403e-03,
   4.4836822904256192e-04, 5.6555913959741098e-04, 2.2081458374322402e-03,
   3.4413520909447352e-03, 2.6498063254484024e-03, 1.0428303557205701e-04,
   5.5113282265942557e-04, 2.1170381535955355e-03},
  {1.0339530838108769e-02, 2.0115939262964084e-03, 3.8931590809823096e-03,
   4.7650841066645246e-03, 1.3623484913611286e-03, 2.5676648875673403e-03,
   4.5816409508469364e-03, 2.3482236452034386e-02, 1.8337271366413162e-03,
   1.8208974424674801e-03, 2.9852888772773966e-03, 4.8388858282217735e-03,
   6.8680260168237799e-04, 1.1712480900914293e-03, 4.0151706409309396e-03,
   7.8821606778634867e-03, 5.1811244478807243e-03, 1.8631201837520715e-04,
   7.9425665822476389e-04, 4.2129543811754233e-03},
  {2.1445979674999767e-03, 1.9669338090997999e-03, 1.9571970203417209e-03,
   1.8490499686015644e-03, 5.0846369346052719e-04, 2.5232356854921439e-03,
   1.9403005526793620e-03, 1.8337282565283341e-03, 5.0577800096242090e-03,
   7.0758183043287978e-04, 1.7792975431493089e-03, 2.6790422932915230e-03,
   3.0226202407610317e-04, 8.8185240472744711e-04, 1.6125772512190282e-03,
   1.9419586275730154e-03, 1.4578217280603204e-03, 1.9201372533606404e-04,
   9.8449099969084245e-04, 1.2982249465554594e-03},
  {2.8561301154880004e-03, 9.4903586570871379e-04, 9.8420636937650492e-04,
   1.0026052825367567e-03, 7.2550869057345544e-04, 8.8236799415713043e-04,
   1.1442987439751681e-03, 1.8208984401472817e-03, 7.0758178598916979e-04,
   3.8506552906542760e-03, 5.5072682218081231e-03, 1.9022874462736859e-03,
   8.9779779166464712e-04, 1.8514060402500864e-03, 1.1725438880466701e-03,
   1.8542546330666708e-03, 2.1953097273455179e-03, 1.1715349711518862e-04,
   8.8263138476574177e-04, 5.5816709465859723e-03},
  {4.8067917974986985e-03, 1.7492453391892897e-03, 1.7794219952796044e-03,
   1.5930777464203344e-03, 7.0799210482163245e-04, 2.1731368143489025e-03,
   1.9598713032350605e-03, 2.9852909597320051e-03, 1.7792976976917839e-03,
   5.5072690460622386e-03, 2.8633141799213720e-02, 3.5641040003613748e-03,
   2.9437972486416092e-03, 5.1517136467180554e-03, 2.4053692063133033e-03,
   3.1126311415467182e-03, 3.3831530304531498e-03, 5.7942578154853775e-04,
   2.0809158918313141e-03, 8.4617886080631984e-03},
  {5.3728675696418354e-03, 7.1821286907030515e-03, 4.0932243544409518e-03,
   3.8472992813898530e-03, 7.7075146477018769e-04, 3.6449723668670084e-03,
   3.9374872595920778e-03, 4.8388857235177269e-03, 2.6790405991885644e-03,
   1.9022863628386552e-03, 3.5641014370229457e-03, 1.8953842604475794e-02,
   1.3056101049686189e-03, 9.5430661853095956e-04, 3.1427825297909041e-03,
   5.3849041950267884e-03, 4.6910224713807751e-03, 3.8032029656172382e-04,
   8.6636218570475439e-04, 2.9693899481531083e-03},
  {9.9018992766180896e-04, 5.4579903432666122e-04, 3.9994296022382333e-04,
   3.7899400657600657e-04, 1.4785568521562850e-04, 4.4907703564869589e-04,
   4.4836727092600176e-04, 6.8680094104802542e-04, 3.0226110863466291e-04,
   8.9779512895369099e-04, 2.9437880772679660e-03, 1.3056069763574686e-03,
   9.5840138132297623e-04, 6.1182457885954348e-04, 4.6431136531683415e-04,
   7.1706190569296188e-04, 7.5402616744404179e-04, 5.8045094875208808e-05,
   2.5054176013068611e-04, 1.4420720152968052e-03},
  {1.5464757384737182e-03, 5.8361969943187164e-04, 7.1880129998556246e-04,
   5.1061899608130133e-04, 4.9387957607791163e-04, 5.2204975375785465e-04,
   5.6555881392267196e-04, 1.1712470864837503e-03, 8.8185111053349914e-04,
   1.8514034394410668e-03, 5.1517056386809704e-03, 9.5430582146329530e-04,
   6.1182553395097998e-04, 1.2698014630939078e-02, 7.0713717122210945e-04,
   1.3236972276029566e-03, 1.1372795757020461e-03, 4.4935798293998033e-04,
   5.9204129845973228e-03, 1.9724226826864097e-03},
  {5.7141481630535477e-03, 1.9905180963772006e-03, 1.8301981861995537e-03,
   1.9136194171798261e-03, 8.9473572151006504e-04, 2.0463928721084555e-03,
   2.2081475127484320e-03, 4.0151725588699581e-03, 1.6125770366767565e-03,
   1.1725438056960976e-03, 2.4053686773750928e-03, 3.1427840990173013e-03,
   4.6431270977728180e-04, 7.0713811492815071e-04, 9.8665012103517150e-03,
   4.3847645326731454e-03, 3.1909527905892095e-03, 1.4643305944453782e-04,
   4.8653540462943143e-04, 2.4870687176984014e-03},
  {7.8179802470484030e-03, 2.6418800648575595e-03, 3.2997079158837914e-03,
   3.4857819520336779e-03, 2.3049488335657111e-03, 2.3688678862723517e-03,
   3.4413525076061563e-03, 7.8821594171121761e-03, 1.9419571309719657e-03,
   1.8542533205230377e-03, 3.1126284723983081e-03, 5.3849034502303607e-03,
   7.1706352480180693e-04, 1.3236981501152383e-03, 4.3847617368474728e-03,
   6.9740349727645213e-03, 5.5479574330400769e-03, 4.1290923395706654e-04,
   1.0821249131072856e-03, 3.5981071690160825e-03},
  {6.7187154686256349e-03, 1.9640566581436121e-03, 2.6196449340589035e-03,
   2.6547022506644953e-03, 1.1784716502698392e-03, 1.8654178456408313e-03,
   2.6498059392656434e-03, 5.1811222367591824e-03, 1.4578202155987802e-03,
   2.1953075876434036e-03, 3.3831492266515823e-03, 4.6910205709220359e-03,
   7.5402766883146113e-04, 1.1372800648526420e-03, 3.1909499045719354e-03,
   5.5479559527624820e-03, 6.1907673193557118e-03, 1.8788438229960420e-04,
   9.2861879874915165e-04, 4.0449480396753824e-03},
  {2.4101334573122253e-04, 7.0871122990446526e-04, 1.6728062095328595e-04,
   1.0462437060469466e-04, 5.9299032372924853e-05, 1.3455300144438575e-04,
   1.0428287441201087e-04, 1.8631167808852490e-04, 1.9201325736996553e-04,
   1.1715321895311159e-04, 5.7942431907503737e-04, 3.8031961016101975e-04,
   5.8045129208179953e-05, 4.4935754725822295e-04, 1.4643272204718587e-04,
   4.1290854585013823e-04, 1.8788411932343113e-04, 5.7988615874804018e-03,
   3.0440080312233293e-04, 1.6081300704676036e-04},
  {1.1721104519468171e-03, 4.6349541214943114e-04, 7.5085752032135573e-04,
   5.1745911142835044e-04, 1.0798146731460171e-03, 4.5154464540748295e-04,
   5.5113341561419734e-04, 7.9425728954638994e-04, 9.8449118097705094e-04,
   8.8263160273401909e-04, 2.0809160942756471e-03, 8.6636289308647107e-04,
   2.5054256506802425e-04, 5.9204227635219937e-03, 4.8653555895126468e-04,
   1.0821259463294354e-03, 9.2861993317196255e-04, 3.0440160104744721e-04,
   9.2529752010838337e-03, 1.0955186436426537e-03},
  {5.8923306927799023e-03, 1.4862708123790926e-03, 1.7484571927992838e-03,
   1.8552553270380166e-03, 1.3840704980517247e-03, 1.6079039509253659e-03,
   2.1170391916360866e-03, 4.2129552629544369e-03, 1.2982244254295084e-03,
   5.5816690566124387e-03, 8.4617844764251094e-03, 2.9693906339036433e-03,
   1.4420758039503008e-03, 1.9724247856302427e-03, 2.4870680502408950e-03,
   3.5981084976237799e-03, 4.0449506125329058e-03, 1.6081333442022358e-04,
   1.0955180021549442e-03, 1.1301288815812780e-02}};


/** Background frequencies for PAM250 */
static double
PAM250_bg[COMPO_NUM_TRUE_AA] =
 {8.7126791287320884e-02, 4.0903895909610417e-02, 4.0432295956770413e-02,
  4.6871895312810476e-02, 3.3473496652650342e-02, 3.8255396174460388e-02,
  4.9530495046950500e-02, 8.8612091138790899e-02, 3.3618396638160339e-02,
  3.6885596311440373e-02, 8.5357391464260871e-02, 8.0481591951840806e-02,
  1.4752798524720149e-02, 3.9771696022830406e-02, 5.0679894932010514e-02,
  6.9577093042290705e-02, 5.8541694145830589e-02, 1.0493698950630105e-02,
  2.9916197008380305e-02, 6.4717593528240649e-02};


/** The structure used to store frequency data; used only in
    matrix_frequency_data.c . */
typedef struct Compo_FrequencyData {
    const char * name;   /**< name of the matrix */
    double (*joint_probs)[COMPO_NUM_TRUE_AA];  /**< joint probabilities */
    double * background; /**< background frequencies */
} Compo_FrequencyData;

/** The static frequency data for matrix MAT
 *  
 *  We use a macro here to minimize the chance that a typo will lead
 *  to the use of inconsistent matrix data */
#define MATRIX_DATA(MAT) \
    { #MAT, MAT##_JOINT_PROBS, MAT##_bg }

/** Number of matrices for which frequency data is available */
#define NUM_SUPPORTED_MATRICES 8
/** An array available frequency data */
static Compo_FrequencyData
s_FrequencyData[NUM_SUPPORTED_MATRICES] =
    {
        MATRIX_DATA(BLOSUM62),
        MATRIX_DATA(BLOSUM80),
        MATRIX_DATA(BLOSUM50),
        MATRIX_DATA(BLOSUM90),
        MATRIX_DATA(BLOSUM45),
        MATRIX_DATA(PAM30),
        MATRIX_DATA(PAM70),
        MATRIX_DATA(PAM250)
    };


/** Given a standard matrix name, locate the static frequency data
 * for the matrix */
static Compo_FrequencyData *
s_LocateFrequencyData(const char * matrix) 
{
    int i;
    for (i = 0;  i < NUM_SUPPORTED_MATRICES;  i++) {
        if (0 == strcmp(s_FrequencyData[i].name, matrix)) {
            return &s_FrequencyData[i];
        }
    }
    return NULL;
}


/* Documented in matrix_frequency_data.h. */
int Blast_FrequencyDataIsAvailable(const char *matrix_name)
{
    return NULL != s_LocateFrequencyData(matrix_name);
}


/* Documented in matrix_frequency_data.h. */
const double *
Blast_GetMatrixBackgroundFreq(const char *matrix_name)
{
    Compo_FrequencyData * data = s_LocateFrequencyData(matrix_name);
    if (NULL != data) {
        return data->background;
    } else {
        fprintf(stderr, "matrix %s is not supported "
                "for RE based adjustment\n", matrix_name);
        return NULL;
    }
}


/* Documented in matrix_frequency_data.h. */
int
Blast_GetJointProbsForMatrix(double ** probs, double row_sums[],
                             double col_sums[], const char *matrix_name)
{
    int i, j;
    Compo_FrequencyData * data = s_LocateFrequencyData(matrix_name);
    if (NULL == data) {
        fprintf(stderr, "matrix %s is not supported "
                "for RE based adjustment\n", matrix_name);
        return -1;
    }
    for (j = 0;  j < COMPO_NUM_TRUE_AA;  j++) {
        col_sums[j] = 0.0;
    }
    for (i = 0;  i < COMPO_NUM_TRUE_AA;  i++) {
        row_sums[i] = 0.0;
        for (j = 0;  j < COMPO_NUM_TRUE_AA;  j++) {
            probs[i][j] = data->joint_probs[i][j];
            row_sums[i] += probs[i][j];
            col_sums[j] += probs[i][j];
        }
    }
    return 0;
}
